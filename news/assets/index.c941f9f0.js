import"./vue.a2f518ee.js";import{_ as e}from"./index.272083a4.js";import{p as i}from"./trafficRules.626c1e24.js";import{b as t,d as a,r as o,c as s,e as r}from"./trafficStatistics.03d1ed18.js";import{u as n,a as l}from"./vue-router.907b547c.js";import{_ as d}from"./index.7061e8ea.js";import{q as c,r as u,f as m,b8 as f,o as p,a as g,b,c as v,a3 as y,O as j,a7 as h,F as w,a8 as k,a9 as L,a2 as F,b5 as _,b4 as x,m as D}from"./@vue.919ff404.js";import{E as S}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const P={class:"trafficPowerBox"},T=(e=>(_("data-v-51e2271a"),e=e(),x(),e))((()=>b("p",{class:"trafficPowerTitle"},"权限配置",-1))),C={class:"addConfigure"},I=["onClick"],q=["onClick"];var V=d({__name:"index",setup(d){n();const _=l(),{proxy:x}=D(),V=c({configureSpinning:!1,configureTableList:[],configurePagination:{pageNo:1,pageSize:10,total:0},configureFormTitle:"规则权限配置",configureVisible:!1,configureForm:{id:null,sitePower:[],siteData:[]},siteDataList:[],configureRuleList:[],sitePowerList:[],powerGroupList:[],configureSubmitLoading:!1,isEditDisabled:!1}),E=u(),O={id:[{required:!0,message:"请选择权限组"}],sitePower:[{required:!0,message:"请选择"}],siteData:[{required:!0,message:"请选择"}]},G=[{title:"权限组",dataIndex:"name",key:"id",ellipsis:!0,showSorterTooltip:!0},{title:"数据权限",dataIndex:"ruleList",key:"ruleList",ellipsis:!0,showSorterTooltip:!0},{title:"操作",dataIndex:"operation",key:"id",ellipsis:!0,showSorterTooltip:!0}],U=()=>{V.configureSpinning=!0,t({appId:44}).then((e=>{V.configureTableList=e.data,M()})).finally((()=>{V.configureSpinning=!1}))},z=()=>{E.value.resetFields(),V.configureVisible=!1},N=()=>{E.value.validate().then((()=>{V.configureSubmitLoading=!0;const e={id:V.configureForm.id,type:3,dataIds:V.configureForm.siteData};o(e).then((e=>{V.configureVisible=!1,U()})).finally((()=>{V.configureSubmitLoading=!1}))}))},R=()=>{},B=()=>{V.siteDataList=[],V.configureForm.siteData=[];const e={pageSize:999,pageNo:1,passIds:V.configureForm.sitePower};_.query.id&&(e.passIds=[_.query.id]),i(e).then((e=>{const{data:i}=e;V.siteDataList=i.list}))},M=()=>{s({appId:44}).then((e=>{const i=[];e.data.forEach((e=>{V.configureTableList.some((i=>i.id===e.id))?i.push(Object.assign({},{disabled:!0,id:e.id,name:e.name})):i.push(Object.assign({},{disabled:!1,id:e.id,name:e.name}))})),V.powerGroupList=i}))},$=(e,i)=>{switch(B(),e){case!0:V.powerGroupList=[],V.configureFormTitle="编辑规则权限",M(),(e=>{r({id:e.id}).then((e=>{const{id:i,rulePidList:t,ruleIdList:a}=e.data;V.configureForm.id=i||null,V.configureForm.sitePower=t||[],B(),V.configureForm.siteData=a||[]}))})(i),V.configureVisible=!0,V.isEditDisabled=!0;break;case!1:V.configureVisible=!0,V.isEditDisabled=!1,V.configureFormTitle="规则权限配置",V.siteDataList=[],V.configureForm.id=null,V.configureForm.sitePower=[],V.configureForm.siteData=[]}};return m((()=>{U()})),(i,t)=>{const o=f("plus-outlined"),s=f("a-button"),r=f("a-spin"),n=f("a-select-option"),l=f("a-select"),d=f("a-form-item"),c=f("a-form"),u=f("a-modal");return p(),g("div",P,[T,b("div",C,[v(s,{type:"primary",onClick:t[0]||(t[0]=e=>$(!1))},{icon:y((()=>[v(o)])),default:y((()=>[j("添加权限配置 ")])),_:1})]),h(" 表格 "),v(r,{spinning:V.configureSpinning},{default:y((()=>[v(e,{columns:G,dataSource:V.configureTableList,rowSelection:!1,totals:V.configurePagination},{bodyCell:y((({column:e,record:i})=>["ruleList"===e.dataIndex?(p(!0),g(w,{key:0},k(i.ruleList,(e=>(p(),g("div",{key:e.id},L(e.name+"：已选"+e.total+"条规则"),1)))),128)):h("v-if",!0),"operation"===e.dataIndex?(p(),g(w,{key:1},[b("a",{style:{color:"var(--primary-color)","margin-left":"10px"},onClick:e=>$(!0,i)},"编辑",8,I),b("a",{style:{color:"#f5222d","margin-left":"10px"},onClick:e=>{return t=i,void x.$confirm({title:"删除提示",icon:v(S),content:"删除后不可恢复，如需继续删除，请点击确定",okType:"danger",okText:"确定",cancelText:"取消",onOk(){const e={id:t.id,type:3};a(e).then((e=>{U()}))}});var t}},"删除",8,q)],64)):h("v-if",!0)])),_:1},8,["dataSource","totals"])])),_:1},8,["spinning"]),v(u,{visible:V.configureVisible,"onUpdate:visible":t[3]||(t[3]=e=>V.configureVisible=e),maskClosable:!1,title:V.configureFormTitle,onOk:N,style:{width:"408px"},onCancel:z},{footer:y((()=>[v(s,{key:"back",onClick:z},{default:y((()=>[j("取消")])),_:1}),v(s,{key:"submit",type:"primary",onClick:N,loading:V.configureSubmitLoading},{default:y((()=>[j("确定")])),_:1},8,["loading"])])),default:y((()=>[v(c,{layout:"vertical",name:"base",ref_key:"configureFormFormRef",ref:E,rules:O,model:V.configureForm},{default:y((()=>[v(d,{name:"id",label:"选择权限组：",style:{width:"100%"}},{default:y((()=>[v(l,{disabled:V.isEditDisabled,placeholder:"请输入",value:V.configureForm.id,"onUpdate:value":t[1]||(t[1]=e=>V.configureForm.id=e)},{default:y((()=>[(p(!0),g(w,null,k(V.powerGroupList,(e=>(p(),F(n,{disabled:e.disabled,value:e.id,key:e.id},{default:y((()=>[j(L(e.name),1)])),_:2},1032,["disabled","value"])))),128))])),_:1},8,["disabled","value"])])),_:1}),h(' <a-form-item style="width: 100%" label="场景:" name="sitePower">\r\n                    <a-select\r\n                        mode="multiple"\r\n                        style="width: 100%"\r\n                        placeholder="请选择场景"\r\n                        v-model:value="state.configureForm.sitePower"\r\n                        @change="sitePowerChange"\r\n                    >\r\n                        <a-select-option\r\n                            v-for="item in state.sitePowerList"\r\n                            :key="item.id"\r\n                            :value="item.id"\r\n                            >{{ item.name }}</a-select-option\r\n                        >\r\n                    </a-select>\r\n                </a-form-item> '),v(d,{label:"选择规则范围:",style:{width:"100%"},name:"siteData"},{default:y((()=>[v(l,{mode:"multiple",style:{width:"100%"},placeholder:"请选择规则范围",value:V.configureForm.siteData,"onUpdate:value":t[2]||(t[2]=e=>V.configureForm.siteData=e),onChange:R},{default:y((()=>[(p(!0),g(w,null,k(V.siteDataList,(e=>(p(),F(n,{key:e.ruleId,value:e.ruleId},{default:y((()=>[j(L(e.ruleName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}},[["__scopeId","data-v-51e2271a"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/traffic/trafficPower/index.vue"]]);export{V as default};
