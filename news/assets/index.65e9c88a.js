import"./vue.a2f518ee.js";import{_ as e}from"./empty.1f473950.js";import{g as a}from"./format.0daa2d8d.js";import{y as n}from"./ydutils.99497787.js";import{_ as o,L as t,as as l,at as i,au as s,av as r}from"./index.7061e8ea.js";import{m as d}from"./ant-design-vue.db4d48e3.js";import{h as c,d as u}from"./honorWall.52714fe8.js";import{y as m}from"./academicYearSemester.a705d5c5.js";import{e as p,r as g,q as h,f as v,b8 as f,o as b,a as y,b as _,a7 as C,c as k,a3 as j,F as w,a8 as x,a2 as L,O as I,a9 as S,a5 as q,b5 as U,b4 as F}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./html2canvas.c4a43e03.js";import"./ydutils.a58fbaf1.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./vue-router.907b547c.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./dayjs.49e29cb2.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const T=e=>(U("data-v-e7f17e1c"),e=e(),F(),e),z={class:"promulgate"},N={class:"promulgate_find"},O={class:"promulgate_inquire"},P={class:"head_operation"},W={class:"addBtn"},B={key:0,class:"photoWall_info"},Y={class:"info_box"},D={class:"info_img"},H=["src"],R={class:"info_mask"},E=["onClick"],G=["onClick"],M=T((()=>_("div",{class:"mask_btn"},[_("i",{class:"iconfont icon-xingzhuangjiehe11 mask_btn_icon"})],-1))),J={class:"info_body"},A={class:"info_name"},Q={class:"box_title"},V={class:"info_time"},$={class:"box_time"},K={key:0},X=T((()=>_("span",null,S("已应用到班牌"),-1))),Z={key:1,style:{color:"#bfbfbf"}},ee=T((()=>_("span",null,S("未应用到班牌"),-1))),ae={key:1,class:"photoWall_info"},ne=[T((()=>_("div",{class:"ano-empty"},[_("img",{class:"ano-empty__img",src:e,alt:"空空如也"}),_("div",{class:"ano-empty__text"},"暂无数据")],-1)))],oe={class:"photoWall_footer"},te=T((()=>_("span",{style:{color:"#ff4d4f"}}," * ",-1))),le=T((()=>_("span",null,"查看人员：",-1))),ie=T((()=>_("span",null,"选择展示设备：",-1))),se=T((()=>_("div",{class:"TemInfo"},"模板信息：",-1))),re=T((()=>_("span",null,"选择模板：",-1))),de={key:0},ce={class:"con"},ue={key:0,class:"customImg"},me=["src"],pe={key:1,class:"imgbox"},ge=T((()=>_("p",null," 仅支持上传jpeg/jpg/png格式图片，图片不能超过10M,最多可选1张 ",-1))),he={key:0,class:"count_text2"},ve={key:1,class:"count_text"},fe=T((()=>_("div",{style:{height:"30px"}},null,-1))),be={class:"footer"},ye=p({name:"promulgate"});var _e=o(Object.assign(ye,{setup(e){const o=g(),p=h({fileList:[],isedit:!1,loading:!1,checkedList2:[],visible2:!1,bgImageUrl:"/image/honor_bg1.png",inquireForm:{},yearData:[],pagination:{pageNo:1,pageSize:8,total:0},visible:!1,honorContent:{levelBusinessId:t.get("director_classId")||"",level:"5",templateType:"1",honorType:"2"},honorList:[],imageList:[]}),U=g(!1),F={1:"/image/honor_bg1.png",2:"/image/honor_bg2.png",3:"/image/honor_bg3.png",4:"/image/honor_bg4.png"},T=[{value:"2",label:"班级荣誉"}],ye=[{value:"5",label:"班级"}],_e=()=>{U.value=!1,p.visible=!0},Ce=g(null),ke=()=>{p.pagination.pageNo=1,p.pagination.pageSize=8,we()},je=()=>{Ce.value.resetFields(),we()};m({pageNo:1,pageSize:999}).then((e=>{p.yearData=e.data}));const we=async()=>{const e={classId:t.get("director_classId")||"",...p.pagination,...p.inquireForm},{data:a}=await l(e);p.honorList=a.list,p.pagination.total=a.total},xe=(e,a)=>{p.pagination.pageNo=e,p.pagination.pageSize=a,we()},Le=e=>new Promise(((a,o)=>{n.uploadFiles(e,"honorImg").then((e=>{a(e)}))})),Ie=async()=>{if(await o.value.validate(),p.loading=!0,"99"===p.honorContent.templateType){const e=await Le(p.fileList[p.fileList.length-1].originFileObj);p.honorContent.imgPaths=e}else{const e=document.getElementById("imageHonor"),n=await a(e,"honor.png"),o=await Le(n);p.honorContent.imgPaths=o}if(p.isedit)try{await i(p.honorContent),p.loading=!1,d.success("编辑成功"),Ne()}catch(e){d.error(e),p.loading=!1}else try{await s(p.honorContent),p.loading=!1,d.success("颁发成功"),Ne()}catch(e){d.error(e),p.loading=!1}ke(),o.value.resetFields()},Se=e=>{p.bgImageUrl=F[e.target.value]||"/image/honor_bg1.png"},qe=e=>{const a=["image/jpeg","image/jpg","image/png"].indexOf(e.type)>-1,n=e.size/1024/1024<10;return a?(n||d.error("上传头像图片大小不能超过 10MB!"),!1):(d.error("上传头像图片只能是 JPG 或 PNG 格式!"),!1)},Ue=e=>new Promise(((a,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>a(o.result),o.onerror=e=>n(e)})),Fe=async e=>{const a=[];for(const n of e.fileList)a.push({name:n.name,file:n.originFileObj,url:await Ue(n.originFileObj),uid:n.uid});p.imageList=a,p.fileList=e.fileList},Te=(e,a)=>""===p.winner?Promise.reject(new Error("请选择获奖学生")):Promise.resolve(),ze=()=>{p.imageList=[],p.fileList=[]},Ne=()=>{p.visible=!1,o.value.resetFields(),p.winner=null,p.honorContent.isShowBrand=!1,p.honorContent.templateType="1",p.honorContent.templateType="1",p.honorContent.honorWinnerIds=[],p.checkedList2=[]};return v((()=>{we(),(async()=>{const e={classesId:t.get("director_classId"),statusList:[1,2,4,5,12,13,99],filterNonEltern:!1,queryEltern:!0},{data:a}=await r(e);p.honorWinner=a||[]})()})),(e,a)=>{const n=f("a-select-option"),t=f("a-select"),l=f("a-form-item"),i=f("a-input"),s=f("SearchOutlined"),r=f("a-button"),m=f("redo-outlined"),g=f("a-form"),h=f("a-popover"),v=f("clock-circle-outlined"),F=f("check-circle-outlined"),Le=f("close-circle-outlined"),Ue=f("eye-outlined"),Oe=f("a-col"),Pe=f("a-row"),We=f("a-pagination"),Be=f("a-textarea"),Ye=f("a-radio"),De=f("a-radio-group"),He=f("a-checkbox"),Re=f("a-radio-button"),Ee=f("a-upload"),Ge=f("a-drawer");return b(),y(w,null,[_("div",z,[_("div",N,[_("div",O,[C(" 条件查询  "),_("div",P,[k(g,{layout:"inline",model:p.inquireForm,ref_key:"queryVoteRef",ref:Ce},{default:j((()=>[k(l,{label:"时间",name:"yearName"},{default:j((()=>[C(' <a-date-picker\r\n                                style="width: 300px"\r\n                                @change="onChangeData"\r\n                                v-model:value="state.inquireForm.yearName"\r\n                                value-format="YYYY"\r\n                                format="YYYY年"\r\n                                picker="year"\r\n                            >\r\n                                <template #suffixIcon>\r\n                                    <down-outlined />\r\n                                </template>\r\n                            </a-date-picker> '),k(t,{value:p.inquireForm.yearName,"onUpdate:value":a[0]||(a[0]=e=>p.inquireForm.yearName=e),placeholder:"请选择",style:{width:"154px"},allowClear:""},{default:j((()=>[(b(!0),y(w,null,x(p.yearData,(e=>(b(),L(n,{value:e.id,key:e.id},{default:j((()=>[I(S(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),k(l,{label:"获奖学生",name:"studentName"},{default:j((()=>[k(i,{value:p.inquireForm.studentName,"onUpdate:value":a[1]||(a[1]=e=>p.inquireForm.studentName=e),placeholder:"请输入"},null,8,["value"])])),_:1}),k(l,{label:"荣誉名称",name:"name"},{default:j((()=>[k(i,{value:p.inquireForm.name,"onUpdate:value":a[2]||(a[2]=e=>p.inquireForm.name=e),placeholder:"请输入"},null,8,["value"])])),_:1}),k(l,null,{default:j((()=>[k(r,{type:"primary",onClick:ke},{icon:j((()=>[k(s,{style:{"margin-right":"6px"}})])),default:j((()=>[I(" 查询 ")])),_:1}),k(r,{style:{"margin-left":"10px"},onClick:je},{icon:j((()=>[k(m,{style:{"margin-right":"6px"}})])),default:j((()=>[I(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"])]),_("div",W,[k(r,{type:"primary",onClick:_e},{default:j((()=>[I("颁发荣誉")])),_:1})]),p.honorList.length?(b(),y("div",B,[k(Pe,{gutter:[16,16]},{default:j((()=>[(b(!0),y(w,null,x(p.honorList,(e=>(b(),L(Oe,{xs:2,sm:4,md:6,key:e.id},{default:j((()=>[_("div",Y,[_("div",D,[_("img",{src:e.imgPaths,alt:""},null,8,H),_("div",R,[k(h,{title:null,trigger:"click",placement:"bottom"},{content:j((()=>[_("div",{onClick:a=>(async e=>{p.honorContent.id=e;const{data:a}=await c({id:e});if(U.value=!0,p.isedit=!0,p.visible=!0,p.honorContent.name=a.name,p.honorContent.isShowBrand=a.isShowBrand,p.honorContent.describe=a.describe,p.honorContent.personnel=a.personnel,p.honorContent.templateType=a.templateType.toString(),p.checkedList2=a.winnerList,p.honorContent.honorWinnerIds=a.winnerList.map((e=>e.id)),"99"===p.honorContent.templateType){const e=[];e.push({url:a.imgPaths}),p.imageList=e}})(e.id),class:"btn_edit"}," 编辑 ",8,E),_("div",{onClick:a=>(async e=>{await u({id:e}),we(),d.success("删除成功")})(e.id),class:"btn_delete"}," 删除 ",8,G)])),default:j((()=>[M])),_:2},1024)])]),_("div",J,[_("div",A,[_("span",Q,S(e.name),1)]),_("div",V,[_("div",null,[k(v),_("span",$,"获奖时间: "+S(e.createTime),1)]),e.isShowBrand?(b(),y("div",K,[k(F),X])):(b(),y("div",Z,[k(Le),ee]))]),_("div",null,[k(Ue),_("span",null,S(2==e.personnel?"家长可查看":"任课老师查看"),1)])])])])),_:2},1024)))),128)),k(Oe)])),_:1})])):(b(),y("div",ae,ne)),_("div",oe,[k(We,{current:p.pagination.pageNo,"onUpdate:current":a[3]||(a[3]=e=>p.pagination.pageNo=e),"page-size":p.pagination.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>p.pagination.pageSize=e),hideOnSinglePage:!0,showLessItems:!0,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],total:p.pagination.total,"show-total":e=>`共 ${e} 条`,onChange:xe},null,8,["current","page-size","total","show-total"])])])]),C(" 抽屉抽屉抽屉抽屉抽屉抽屉抽屉抽屉 "),p.visible?(b(),L(Ge,{key:0,class:"drawerHonor",destroyOnClose:!0,width:"510",visible:p.visible,"onUpdate:visible":a[13]||(a[13]=e=>p.visible=e),maskClosable:!1,onClose:Ne,title:"颁发荣誉"},{footer:j((()=>[_("div",be,[_("div",null,[k(r,{style:{"margin-right":"8px"},onClick:Ne},{default:j((()=>[I("取消")])),_:1}),k(r,{type:"primary",onClick:Ie,loading:p.loading},{default:j((()=>[I("确认")])),_:1},8,["loading"])])])])),default:j((()=>{var n;return[k(g,{autoComplete:"off",class:"addHonor",layout:"vertical",ref_key:"formRef",ref:o,model:p.honorContent,name:"honor"},{default:j((()=>[k(l,{label:"荣誉名称",name:"name",rules:[{required:p.honorContent.name,message:"请填写荣誉名称",required:!0}]},{default:j((()=>[k(i,{value:p.honorContent.name,"onUpdate:value":a[5]||(a[5]=e=>p.honorContent.name=e),valueModifiers:{trim:!0},"show-count":"",maxlength:10},null,8,["value"])])),_:1},8,["rules"]),k(l,{label:"荣誉类型",name:"honorType",rules:[{required:!0,message:"请选择荣誉类型",trigger:"change"}]},{default:j((()=>[k(t,{value:p.honorContent.honorType,"onUpdate:value":a[6]||(a[6]=e=>p.honorContent.honorType=e),onChange:e.changeType,options:T,disabled:!0},null,8,["value","onChange"])])),_:1}),k(l,{label:"荣誉级别",name:"level"},{default:j((()=>[k(t,{value:p.honorContent.level,"onUpdate:value":a[7]||(a[7]=e=>p.honorContent.level=e),options:ye,disabled:!0},null,8,["value"])])),_:1}),k(l,{label:"获奖学生",name:"winner",rules:[{validator:Te,required:!0,trigger:"blur"}]},{default:j((()=>[C(' <a-input\r\n                        v-model:value="state.winner"\r\n                        @click="addWinnerIds"\r\n                        allowClear\r\n                        placeholder="请选择"\r\n                        readonly="readonly"\r\n                    /> '),k(t,{mode:"multiple",fieldNames:{label:"name",value:"id"},value:p.honorContent.honorWinnerIds,"onUpdate:value":a[8]||(a[8]=e=>p.honorContent.honorWinnerIds=e),options:p.honorWinner},null,8,["value","options"])])),_:1},8,["rules"]),k(l,{label:"荣誉描述",name:"describe"},{default:j((()=>[k(Be,{value:p.honorContent.describe,"onUpdate:value":a[9]||(a[9]=e=>p.honorContent.describe=e),placeholder:"请输入","show-count":"",maxlength:30,"auto-size":{minRows:4}},null,8,["value"])])),_:1}),k(l,{name:"personnel",rules:[{required:!0,message:"请选择查看人员",trigger:"change"}]},{default:j((()=>[te,le,C(' <a-checkbox-group\r\n                        v-model:value="state.honorContent.personnel"\r\n                        name="radioGroup"\r\n                        :disabled="disabled"\r\n                    >\r\n                        <a-checkbox :value="1">任课老师</a-checkbox>\r\n                        <a-checkbox :value="2">家长</a-checkbox>\r\n                    </a-checkbox-group> '),k(De,{value:p.honorContent.personnel,"onUpdate:value":a[10]||(a[10]=e=>p.honorContent.personnel=e),name:"radioGroup",disabled:U.value},{default:j((()=>[C(' <a-radio :value="0">全部（教职工和家长）</a-radio> '),k(Ye,{value:1},{default:j((()=>[I("任课老师")])),_:1}),k(Ye,{value:2},{default:j((()=>[I("家长")])),_:1})])),_:1},8,["value","disabled"])])),_:1}),k(l,{name:"device"},{default:j((()=>[ie,k(He,{disabled:U.value,checked:p.honorContent.isShowBrand,"onUpdate:checked":a[11]||(a[11]=e=>p.honorContent.isShowBrand=e)},{default:j((()=>[I("班牌")])),_:1},8,["disabled","checked"])])),_:1})])),_:1},8,["model"]),se,_("div",null,[re,k(De,{onChange:Se,value:p.honorContent.templateType,"onUpdate:value":a[12]||(a[12]=e=>p.honorContent.templateType=e),"button-style":"solid"},{default:j((()=>[k(Re,{value:"1"},{default:j((()=>[I("模板一")])),_:1}),k(Re,{value:"2"},{default:j((()=>[I("模板二")])),_:1}),k(Re,{value:"3"},{default:j((()=>[I("模板三")])),_:1}),k(Re,{value:"4"},{default:j((()=>[I("模板四")])),_:1}),k(Re,{value:"99"},{default:j((()=>[I("自定义")])),_:1})])),_:1},8,["value"])]),_("div",null,[C(" 这里是自定义上传图片的地方 "),"99"===p.honorContent.templateType?(b(),y("div",de,[_("div",ce,[p.imageList.length?(b(),y("div",ue,[_("img",{src:null==(n=p.imageList[p.imageList.length-1])?void 0:n.url,alt:"img"},null,8,me),_("div",{class:"del",onClick:ze},"×")])):(b(),y("div",pe,[k(Ee,{action:"/","max-count":1,"file-list":p.fileList,showUploadList:!0,accept:"image/png,image/jpg,image/jpeg","before-upload":qe,onChange:Fe},{default:j((()=>[k(r,{class:"btn"},{default:j((()=>[I("选择图片")])),_:1})])),_:1},8,["file-list"]),ge]))])])):(b(),y("div",{key:1,style:q({background:"url("+p.bgImageUrl+")",backgroundSize:"100% 100%"}),id:"imageHonor",class:"add_count_down"},[_("div",null,[C(" 特殊定位图片templateType===3 "),"3"===p.honorContent.templateType?(b(),y("div",he,S(p.honorContent.name),1)):(b(),y("div",ve,S(p.honorContent.name),1))])],4))]),fe]})),_:1},8,["visible"])):C("v-if",!0)]),C(' <y-select\r\n        mode="personnel"\r\n        :tabs="[{ tab: \'学生组\', key: 2, checked: true }]"\r\n        v-model:visible="state.visible2"\r\n        v-model:checked="state.checkedList2"\r\n        @handleOk="handleOk2"\r\n    >\r\n    </y-select> ')],2112)}}}),[["__scopeId","data-v-e7f17e1c"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/classManager/page/classHonor/promulgate/index.vue"]]);export{_e as default};
