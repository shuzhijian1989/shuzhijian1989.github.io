import"./vue.a2f518ee.js";import{m as e}from"./ant-design-vue.db4d48e3.js";import{C as a}from"./cropperjs.fe6d04b8.js";import{_ as t}from"./index.7061e8ea.js";import{q as o,w as i,b8 as r,o as s,a as l,c as p,a3 as c,a9 as n,a7 as d,a2 as g,b as m,W as u,a4 as f,O as v,R as h,b5 as y,b4 as w,n as b}from"./@vue.919ff404.js";const B={key:0,class:"upload-avatar"},x=["src"],C={key:2,style:{width:"100%",height:"100%",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center","font-size":"12px","border-radius":"50%",color:"#0000008a"}},I={class:"ant-upload-text"},S={class:"cropper-warp"},j=["src"],R={class:"cropper-warp-right"},_=(e=>(y("data-v-50b3f351"),e=e(),w(),e))((()=>m("div",{class:"cropper-warp-right-title"},"预览",-1))),k={class:"cropper-warp-right-item"},N={class:"cropper-warp-right-value"},D=["src"],A={class:"dialog-footer"};var L=t({__name:"index",props:{value:{type:String,default:""},title:{type:String,default:"重新上传头像"},accept:{type:String,default:"image/*"},disableds:{type:Boolean,default:!1},aspectRatio:{type:Number,default:1},cropBoxResizable:{type:Boolean,default:!1},minCropBoxWidth:{type:Number,default:200},minCropBoxHeight:{type:Number,default:200},className:{type:String,default:"logo_uploader"},isNum:{type:Number,default:2}},emits:["change","update:value"],setup(t,{emit:y}){const w=t,L=o({fileList:[],loading:!1,isShowDialog:!1,cropperImgBase64:"",cropperImg:""});i((()=>w.value),(e=>{e&&(L.loading=!1),y("update:value",e)}));const U=()=>{L.isShowDialog=!1},z=async a=>{if(!["image/jpeg","image/webp","image/jpg","image/png"].includes(a.file.type))return L.acceptLload=!0,void e.error("只能上传jpg，png格式!");if(Number(a.file.size/1024/1024)>w.isNum)e.error("图像必须小于"+w.isNum+"MB！");else{L.cropperImg="",L.cropperImgBase64="";try{const e=await(o=a.file,new Promise(((e,a)=>{const t=new FileReader;t.readAsDataURL(o),t.onload=()=>e(t.result),t.onerror=e=>a(e)})));L.cropperImg=e,t=e,L.cropperImg=t,L.isShowDialog=!0,b((()=>{M()}))}catch(i){}var t,o}},W=(e,a)=>!1;const H=()=>{L.isShowDialog=!1,L.loading=!0,function(e){const a=e.split(","),t=a[0].match(/:(.*?);/)[1],o=window.atob(a[1]);let i=o.length;const r=new Uint8Array(i);for(;i--;)r[i]=o.charCodeAt(i);new Blob([r],{type:t})}(L.cropperImgBase64);const e=function(e,a){const t=e.split(","),o=t[0].match(/:(.*?);/)[1],i=atob(t[1]);let r=i.length;const s=new Uint8Array(r);for(;r--;)s[r]=i.charCodeAt(r);return new File([s],a,{type:o})}(h(L.cropperImgBase64),"image.png");y("change",{file:e,base64:h(L.cropperImgBase64)})},M=()=>{const e=document.querySelector(".cropper-warp-left-img"),t=new a(e,{viewMode:1,dragMode:"move",initialAspectRatio:1,preview:".before",autoCropArea:0,zoomOnWheel:!0,aspectRatio:w.aspectRatio,cropBoxResizable:w.cropBoxResizable,minCropBoxWidth:w.minCropBoxWidth,minCropBoxHeight:w.minCropBoxHeight,crop:()=>{L.cropperImgBase64=t.getCroppedCanvas({imageSmoothingQuality:"low"}).toDataURL("image/jpeg")}})};return(e,a)=>{const o=r("loading-outlined"),i=r("plus-outlined"),h=r("a-upload"),y=r("a-button"),b=r("a-modal");return s(),l("div",null,[p(h,{disabled:t.disableds,"file-list":L.fileList,"onUpdate:fileList":a[0]||(a[0]=e=>L.fileList=e),name:"file","list-type":"picture-card",class:f(t.className),"show-upload-list":!1,action:"/",accept:t.accept,"before-upload":W,onChange:z},{default:c((()=>[t.value?(s(),l("div",B,n(t.title),1)):d("v-if",!0),t.value?(s(),l("img",{key:1,src:t.value,style:{height:"auto",width:"100%",display:"block"},alt:"logo"},null,8,x)):(s(),l("div",C,[L.loading?(s(),g(o,{key:0})):(s(),g(i,{key:1})),m("div",I,n(L.loading?"正在":"点击")+"上传图片 ",1)])),u(e.$slots,"parents",{},void 0,!0)])),_:3},8,["disabled","file-list","class","accept"]),d("  "),p(b,{title:"上传图片",visible:L.isShowDialog,"onUpdate:visible":a[1]||(a[1]=e=>L.isShowDialog=e),width:"900px"},{footer:c((()=>[m("span",A,[p(y,{onClick:U},{default:c((()=>[v("取 消")])),_:1}),p(y,{type:"primary",onClick:H},{default:c((()=>[v("确 定")])),_:1})])])),default:c((()=>[m("div",S,[(s(),l("div",{class:"cropper-warp-left",key:L.cropperImg},[m("img",{src:L.cropperImg,class:"cropper-warp-left-img"},null,8,j)])),m("div",R,[m("div",{class:f(["cropper-warp-right-box",{acitve:1==w.aspectRatio}])},[_,m("div",k,[m("div",N,[(s(),l("img",{src:L.cropperImgBase64,key:L.cropperImgBase64,class:"cropper-warp-right-value-img"},null,8,D))])])],2)])])])),_:1},8,["visible"])])}}},[["__scopeId","data-v-50b3f351"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/components/CropPicture/index.vue"]]);export{L as C};
