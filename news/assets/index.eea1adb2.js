import"./vue.a2f518ee.js";import{u as e,a as t}from"./vue-router.907b547c.js";import{_ as a,u as s,n as l,p as i}from"./index.7061e8ea.js";import{e as o,r as d,f as r,y as n,b8 as p,o as c,a as u,a7 as m,a2 as y,a3 as f,c as h,aK as v,O as g,a9 as I,W as k,b,q as T,w as _,I as S,H as L,F as j,m as x,t as D,a8 as N,u as R,L as w,P as C,R as A,M as V}from"./@vue.919ff404.js";import{A as F}from"./authorNum.3e5a5dc5.js";import{m as P,M as U}from"./ant-design-vue.db4d48e3.js";import{_ as $}from"./index.272083a4.js";import"./index.510cb628.js";import{f as O,E as q}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./dayjs.49e29cb2.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const H=o({props:{treeData:{type:Array,default:()=>[]},expandAll:{type:Boolean,default:()=>!1},fieldNames:{type:Object,default:()=>({children:"children",title:"name",key:"id"})}},components:{},emitSelect:String,setup(a,{emit:s}){const l=e(),i=t(),o=d([]),p=d([]);function c(e,t){for(let a=0;a<e.length;a++){if(e[a].id===t)return e[a];if(e[a].children){const s=c(e[a].children,t);if(s)return s}}return null}r((()=>{const{deptId:e}=i.query;if(e){p.value=[e];const t=c(a.treeData,e);s("getTreeTypeId",t)}else a.treeData&&a.treeData.length>0&&a.treeData.some((e=>e.children&&e.children.length?(p.value=[e.children[0].id],s("getTreeTypeId",e.children[0]),!0):(p.value=[a.treeData[0].id],s("getTreeTypeId",a.treeData[0]),!0)))}));const u=n((()=>e=>(e[a.fieldNames.title],3==e.type&&e.yearName&&(e[a.fieldNames.title],e.yearName),e[a.fieldNames.title].length>12)));return{expandedKeys:o,selectedKeys:p,aliasEndName:u,select:(e,t)=>{if(e.length){s("emitSelect",e[0],t.node);const{ancestors:a,type:o,isDefault:d,isSetBtn:r,codeValue:n}=t.node;l.push({path:i.path,query:{...i.query,deptId:e[0],codeValue:n,type:o,isSetBtn:r,isDefault:d,ancestors:a}})}}}}}),K=b("i",{class:"iconfont icon-a-Fill21 icon-yellow",style:{"font-size":"12px"}},null,-1);var z=a(H,[["render",function(e,t,a,s,l,i){const o=p("a-tooltip"),d=p("a-tree");return c(),u("div",null,[m(" 和全选有冲突 "),m(' v-model:expandedKeys="expandedKeys" '),e.treeData.length?(c(),y(d,{key:0,selectedKeys:e.selectedKeys,"onUpdate:selectedKeys":t[0]||(t[0]=t=>e.selectedKeys=t),"tree-data":e.treeData,fieldNames:e.fieldNames,defaultExpandAll:e.expandAll,blockNode:"",selectable:!0,onSelect:e.select},{title:f((({dataRef:t})=>[m(' <team-outlined class="icon-yellow" /> '),K,h(o,null,v({default:f((()=>[g(" "+I(t[e.fieldNames.title]),1)])),_:2},[e.aliasEndName(t)?{name:"title",fn:f((()=>[g(I(t[e.fieldNames.title]),1)])),key:"0"}:void 0]),1024),k(e.$slots,"handleItem",{handleItem:t})])),_:3},8,["selectedKeys","tree-data","fieldNames","defaultExpandAll","onSelect"])):m("v-if",!0),k(e.$slots,"handleFooter")])}],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/components/DempTree/jurisdiction.vue"]]);const M={key:0,class:"buttonData"},E={class:"author-maxh"};var B=a(o({__name:"index",setup(e,{expose:a}){s();const i=t(),{proxy:o}=x(),n=d(!1),h=d(!1),v=d([]),k=d(""),D=d({});a({roleId:k});const N=T({menuIds:[],isAuthority:!1,indeterminate:!0,checkAll:!1,checkedList:{},olCheckedList:[]}),R=(e,t,a,s)=>{var l;for(const i in e){if(t[e[i].id]=a?[e[i].id]:[],s&&e[i].id===s)return;(null==(l=e[i].children)?void 0:l.length)&&R(e[i].children,t,a)}},w=e=>{N.checkAll=e,n.value=e},C=async(e,t)=>{const{deptId:a,type:s}=i.query;let d={roleId:a};"1"===s&&(d.roleId=""),e&&!t&&(d={}),(t||e)&&(h.value=!0),o.$defHttp.get(l.menuList,d).then((a=>{const{data:s}=a;if(D.value={},s.length&&R(s,D.value),t&&(e=!t),N.isAuthority=!0,!e){const e=JSON.parse(JSON.stringify(D.value));N.olCheckedList=[];for(const t in e)null!==e[t]&&N.olCheckedList.push(t);N.isAuthority=!1}v.value=s}))},A=e=>{e.target.checked?R(v.value,D.value,!0):R(v.value,D.value)},V=()=>{C(!0)},P=()=>{var e;const t=[];for(const s in D.value)(null==(e=D.value[s])?void 0:e.length)&&t.push(D.value[s][0]);const{deptId:a}=i.query;t.length?o.$defHttp.post(l.updateRoleMenu,{roleId:a,menuIds:t}).then((e=>{const{code:t,message:a}=e;o.$message.success(a),C(),N.checkAll=!1,N.isAuthority=!1})):o.$message.warning("功能权限不能为空！")};return _((()=>i.query),(e=>{C()})),r((()=>{C()})),(e,t)=>{const a=p("a-checkbox"),s=p("a-button"),l=p("a-empty"),i=S("auth");return c(),u(j,null,[m(' :olData="jurisdictionList" '),e.$route.query.type&&"1"!=e.$route.query.type?(c(),u("div",M,[b("p",null,[N.isAuthority?(c(),y(a,{key:0,checked:N.checkAll,"onUpdate:checked":t[0]||(t[0]=e=>N.checkAll=e),onChange:A},{default:f((()=>[g(I(N.checkAll?"取消选择全部":"选择全部"),1)])),_:1},8,["checked"])):m("v-if",!0)]),N.isAuthority?L((c(),y(s,{key:0,type:"primary",onClick:P},{default:f((()=>[g("保存")])),_:1})),[[i,"setup"]]):L((c(),y(s,{key:1,type:"primary",onClick:V},{default:f((()=>[g("设置")])),_:1})),[[i,"setup"]])])):m("v-if",!0),b("div",E,[v.value.length?(c(),y(F,{key:0,ref:"authornumRef",jurisdictionList:v.value,olData:v.value,checkedLists:D.value,authority:N.isAuthority,types:!0,olCheckedList:N.olCheckedList,isAllChecked:n.value,onHeanderAllChecked:w,onPermissionSetting:C},null,8,["jurisdictionList","olData","checkedLists","authority","olCheckedList","isAllChecked"])):(c(),y(l,{key:1,image:"image/empty.png","image-style":{height:"180px"},style:{"margin-top":"20%"}}))])],64)}}}),[["__scopeId","data-v-1135a0a8"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/role/components/FunctionalAuthority/index.vue"]]);const J={class:"buttonData"},G={class:"dataPermissionsTable"},W={class:"tableTitle"},Q={class:"tableContent"},X={key:0,class:"departmentPermissions"},Y={class:"principalAuthority"},Z={key:1,class:"principalAuthority"},ee={class:"principalAuthority"};var te=a({__name:"DataPermissions",props:{treeId:String,treeType:String,treeIsDefault:String,treeTypeId:String,codeValue:String},setup(e){const a=e,{proxy:o}=x(),d=s(),k=n((()=>2===d.state.base.commentJsonKeys.schoolType?"学生、教职工":"学生、家长、教职工")),V=t(),F=T({isShowSegment:!1,segment:{campus_head:"校区",college_head:"学院",professional_head:"专业",grade_head:"年级",assistant_head:"班级",academics:"学段",headmaster:"班级",teacher:"任课老师"},selectSourceObj:{organizationTree:[],studentStatusTree:[]},dataPermissionsList:[{departmentName:"部门范围",type:1,principalList:[{tit:"拥有部门组织下所有教职工的数据权限"}]},{departmentName:"学籍范围",type:2,principalList:[{tit:"拥有学籍组织下所有学生的数据权限"}]}],spinning:!1,selectedPoolSelectedSet:[],selectedPoolSelectedSet1:[],type:"",departIds:[],studentIds:[],visible:!1,visible1:!1,checkedList:[],checkedList1:[],tabs:[],codeTip:{admin:"默认所有",principal:"默认所有",dept_head:"所管辖部门及下级部门的管理权限"}}),{dataPermissionsList:U,selectSourceObj:$,spinning:O,visible:q,tabs:H,visible1:K}=D(F),z=e=>{"1"===F.type?(F.departIds=e.map((e=>e.id)),F.studentIds=F.dataPermissionsList[1].departmentList.map((e=>e.id))):(F.studentIds=e.map((e=>e.id)),F.departIds=F.dataPermissionsList[0].departmentList.map((e=>e.id)));const t={roleId:a.treeId,dataIds:[...F.studentIds,...F.departIds]};return new Promise(((e,a)=>{o.$defHttp.post(l.dataUpdate,t).then((e=>{M(),P.success(e.message)}))}))},M=()=>{F.spinning=!0;const e=A(a),t={roleId:e.treeId||V.query.deptId};if(t.roleId&&"1"!==e.treeType)return new Promise(((e,a)=>{o.$defHttp.get(l.dataGetData,t).then((e=>{const{data:t}=e;F.dataPermissionsList[0].departmentList=t.deptList,F.dataPermissionsList[1].departmentList=t.rollList,F.checkedList=t.deptList,F.checkedList1=t.rollList})).finally((()=>{F.spinning=!1}))}))};return _((()=>[a.treeId,a.treeType,a.treeIsDefault,a.treeTypeId]),(e=>{F.isShowSegment=[5,6,7,8].includes(a.treeTypeId),1!=a.treeType&&M()})),r((()=>{M()})),(t,a)=>{const s=p("a-button"),l=p("a-tooltip"),o=p("a-spin"),d=S("auth");return c(),u("div",null,[h(o,{spinning:R(O)},{default:f((()=>[(c(!0),u(j,null,N(R(U),(t=>L((c(),u("div",{key:t.id},[b("div",J,["false"===R(V).query.isSetBtn?L((c(),y(s,{key:0,type:"primary",onClick:e=>(e=>{1==e.type?(F.type="1",F.visible=!0):2==e.type&&(F.type="2",F.visible1=!0)})(t)},{default:f((()=>[g("设置")])),_:2},1032,["onClick"])),[[d,"setup"]]):m("v-if",!0)]),b("div",G,[b("div",W,I(t.departmentName),1),b("div",Q,[(c(!0),u(j,null,N(t.departmentList,((e,t)=>(c(),u("span",{class:"departmentPermissions",key:t},[h(l,null,v({default:f((()=>[g(" "+I(e.name),1)])),_:2},[e.name.length>7?{name:"title",fn:f((()=>[g(I(e.name),1)])),key:"0"}:void 0]),1024)])))),128)),1==e.treeTypeId?(c(),u("span",X,"全部范围")):m("v-if",!0),(c(!0),u(j,null,N(t.principalList,((t,a)=>L((c(),u("span",{class:"principalAuthority",key:a},I(t.tit),1)),[[w,3==e.treeTypeId]]))),128)),L(b("span",Y," 所管辖部门及下级部门的管理权限 ",512),[[w,4==e.treeTypeId]]),[5,6,7,8].includes(e.treeTypeId-0)&&e.codeValue&&F.segment[e.codeValue]?(c(),u("span",Z,I(`所负责${F.segment[e.codeValue]}范围内的所有${k.value}的数据权限，包含下级结构及班级。`),1)):m("v-if",!0),L(b("span",ee,"所负责班级范围内的所有学生的数据权限",512),[[w,9==e.treeTypeId]])])])])),[[w,!(4==e.treeTypeId&&2==t.type||5==e.treeTypeId&&1==t.type||6==e.treeTypeId&&1==t.type||7==e.treeTypeId&&1==t.type||8==e.treeTypeId&&1==t.type||9==e.treeTypeId&&1==t.type)]]))),128))])),_:1},8,["spinning"]),m(" 选择部门范围 "),h(R(i),{mode:"depa",tabs:[{tab:"教职工",key:1,checked:!0}],visible:R(q),"onUpdate:visible":a[0]||(a[0]=e=>C(q)?q.value=e:null),checked:F.checkedList,"onUpdate:checked":a[1]||(a[1]=e=>F.checkedList=e),onHandleOk:z},null,8,["visible","checked"]),m(" 选择学籍范围 "),h(R(i),{mode:"depa",tabs:[{tab:"学生",key:2,checked:!0}],visible:R(K),"onUpdate:visible":a[2]||(a[2]=e=>C(K)?K.value=e:null),checked:F.checkedList1,"onUpdate:checked":a[3]||(a[3]=e=>F.checkedList1=e),onHandleOk:z},null,8,["visible","checked"])])}}},[["__scopeId","data-v-0c41095f"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/role/components/DataPermissions.vue"]]);const ae={class:"role_members"},se={class:"operation"},le={key:0,class:"editable-row-operations"},ie=["onClick"];var oe=a({__name:"RoleMembers",props:{treeId:String,treeType:String,treeTypeId:String,treeIsDefault:String,yuanId:String},setup(e){const a=e,{proxy:o}=x(),d=s(),{emp_status_yes_id:n}=d.state.selectSource.dictionary,k=T({selectSourceObj:{organizationTree:[],studentStatusTree:[]},searchName:"",dataSource:[],pagination:{total:0,pageNo:1,pageSize:10},spinning:!1,visible:!1,checkedList:[]}),{selectSourceObj:j,searchName:N,dataSource:w,total:A,spinning:V,visible:F,checkedList:q}=D(k),H=t(),K=[{title:"姓名",dataIndex:"name"},{title:"工号",dataIndex:"jobNumber"},{title:"手机号码",dataIndex:"phone"},{title:"部门",dataIndex:"deptVOList",key:"id"},{title:"操作",dataIndex:"operation"}],z=e=>{k.pagination.pageNo=e.current,k.pagination.pageSize=e.pageSize,J()},M=e=>{const t=e.map((e=>e.userId)),s={roleId:a.treeId,userIds:t};o.$defHttp.post(l.roleCreateUserRole,s).then((e=>{J(),P.success(e.message)}))},E=e=>{k.searchName=e,k.pagination={total:0,pageNo:1,pageSize:10},J()},B=async()=>{k.visible=!0,k.checkedList=[]},J=()=>{k.dataSource=[],k.spinning=!0;const e=a.treeId||H.query.deptId;if(!e||"1"===a.treeType)return void(k.spinning=!1);const t={...k.pagination,name:k.searchName,roleId:e,statusList:n};return new Promise(((e,a)=>{o.$defHttp.post(l.facultyList,t).then((e=>{const{data:t}=e;k.dataSource=t.list,k.pagination.total=t.total,k.dataSource.length&&k.dataSource.forEach((e=>{var t;if(void 0!==e.deptVOList){const a=null==(t=e.deptVOList)?void 0:t.map((e=>e.name));e.deptVOList=a.join("、")}}))})).finally((()=>{k.spinning=!1}))}))};return _((()=>[a.treeId,a.treeType,a.treeTypeId,a.treeIsDefault,a.yuanId,a.roleId]),(e=>{1!=a.treeType&&(k.pagination={total:0,pageNo:1,pageSize:10},J())})),r((()=>J())),(e,t)=>{const s=p("a-input-search"),d=p("plus-outlined"),r=p("a-button"),n=p("a-tooltip"),T=p("a-empty"),_=p("a-spin"),j=S("auth");return c(),u("div",ae,[b("div",se,[h(s,{placeholder:"请输入姓名搜索",style:{width:"336px"},allowClear:"",onSearch:E}),"false"===R(H).query.isSetBtn?L((c(),y(r,{key:0,type:"primary",onClick:B},{icon:f((()=>[h(d)])),default:f((()=>[g(" 添加成员 ")])),_:1})),[[j,"addMember"]]):m("v-if",!0)]),m(" 角色成员 表格 "),h(_,{spinning:R(V)},{default:f((()=>[h($,{locale:{emptyText:"fasdfasdf"},columns:K,dataSource:R(w),rowSelection:!1,totals:k.pagination,onOnSelectedRowKeys:z},{bodyCell:f((({column:e,text:t,record:s})=>["operation"===e.dataIndex?(c(),u("div",le,[0!=a.treeIsDefault||2==a.treeTypeId?L((c(),u("a",{key:0,onClick:e=>{return t=s,void U.confirm({title:"删除角色成员",icon:h(O),content:"是否删除该角色成员？",okText:"确认",cancelText:"取消",onCancel(){P.info("已取消！")},onOk(){const e={roleId:a.treeId,userId:t.userId};o.$defHttp.post(l.roleDeleteUserRole,e).then((e=>{J(),P.success(e.message)}))}});var t},style:{color:"red"}},[g("删除")],8,ie)),[[j,"removeMember"]]):m("v-if",!0)])):(c(),y(n,{key:1,placement:"topLeft"},v({default:f((()=>[g(" "+I(t),1)])),_:2},[(null==t?void 0:t.length)>15?{name:"title",fn:f((()=>[g(I(t),1)])),key:"0"}:void 0]),1024))])),emptyText:f((()=>[h(T,{image:"/image/empty1.png","image-style":{height:"180px"},description:"暂无角色成员"})])),_:1},8,["dataSource","totals"])])),_:1},8,["spinning"]),m(" 选择角色成员 "),h(R(i),{mode:"personnel",tabs:[{tab:"老师",key:1,checked:!0}],visible:R(F),"onUpdate:visible":t[0]||(t[0]=e=>C(F)?F.value=e:null),checked:R(q),"onUpdate:checked":t[1]||(t[1]=e=>C(q)?q.value=e:null),onHandleOk:M},null,8,["visible","checked"])])}}},[["__scopeId","data-v-04b05ca8"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/role/components/RoleMembers.vue"]]);const de={class:"role"},re={type:"flex",style:{display:"flex"}},ne={class:"left"},pe={class:"role_right"},ce={class:"tips"};var ue=a(o({__name:"index",setup(e){const{proxy:a}=x(),s=d(),i=d(0),o=d(),n=t(),v=T({roleTree:[],groupingList:[],editRoleVisible:!1,editRoleForm:{roleName:"",grouping:""},modalTitle:"",rowsId:"",rowsType:"",rowsPid:"",treeId:"",treeType:"",treeTypeId:"",codeValue:"",treeIsDefault:"",spinning:!1,tabKey:"3",yuanId:"",selectedKeys:[]}),{roleTree:k,editRoleVisible:_,editRoleForm:j,modalTitle:N,groupingList:w,treeId:A,treeType:F,treeTypeId:$,codeValue:O,treeIsDefault:H,spinning:K,tabKey:M,yuanId:E}=D(v),J={children:"children",title:"name",key:"id"},G=()=>{void 0!==s.value&&s.value.resetFields(),v.editRoleForm.roleName="",v.editRoleForm.grouping="",v.editRoleVisible=!0,v.modalTitle="新增角色"},W=()=>{s.value.resetFields()},Q=()=>{s.value.validateFields().then((()=>{if("编辑角色类别"===v.modalTitle){const e={id:v.rowsId,name:v.editRoleForm.roleName,type:v.rowsType,pid:v.rowsPid};a.$defHttp.post(l.roleTypeUpdate,e).then((e=>{Z(),P.success(e.message)}))}else if("新增角色类别"===v.modalTitle){const e={name:v.editRoleForm.roleName};a.$defHttp.post(l.roleTypeCreate,e).then((e=>{Z(),P.success(e.message)}))}else if("编辑角色"===v.modalTitle){const e={id:v.rowsId,name:v.editRoleForm.roleName,type:v.rowsType,pid:v.rowsPid};a.$defHttp.post(l.roleTypeUpdate,e).then((e=>{Z(),P.success(e.message)}))}else if("新增角色"===v.modalTitle){const e={name:v.editRoleForm.roleName,roleTypeId:v.editRoleForm.grouping};a.$defHttp.post(l.roleCreateRole,e).then((e=>{Z(),P.success(e.message)}))}v.editRoleVisible=!1,s.value.resetFields()}))},X=e=>{v.tabKey=e},Y=(e,t)=>{o.value.roleId=e,v.treeId=e,v.treeType=t.level,v.treeTypeId=t.type,v.codeValue=t.codeValue,v.treeIsDefault=t.isDefault},Z=()=>{v.spinning=!0,a.$defHttp.get(l.roleTypeList).then((e=>{var t;const{data:a}=e;v.roleTree=a.map((({isDefault:e,level:t,...a})=>({isDefault:e,level:t,disabled:0===e&&1===t,...a}))),v.yuanId=a[0]?null==(t=a[0].children[0])?void 0:t.id:"",v.groupingList=a.filter((e=>1===e.isDefault)).map((e=>({label:e.name,value:e.id})))})).finally((()=>{v.spinning=!1}))},ee=e=>{v.treeTypeId=n.query.type||e.roleTypeId,v.codeValue=n.query.codeValue||"",v.treeId=e.id,v.treeType=e.level};return r((()=>{Z()})),(e,t)=>{const d=p("ellipsis-outlined"),r=p("a-button"),n=p("a-menu-item"),T=p("Authorized"),x=p("a-menu"),D=p("a-dropdown"),ae=p("user-add-outlined"),se=p("a-col"),le=p("usergroup-add-outlined"),ie=p("a-row"),ue=p("a-spin"),me=p("a-affix"),ye=p("a-tab-pane"),fe=p("a-tabs"),he=p("a-input"),ve=p("a-form-item"),ge=p("a-select"),Ie=p("a-form"),ke=p("a-modal"),be=S("auth");return c(),u("div",de,[b("div",re,[h(me,{"offset-top":i.value},{default:f((()=>[b("div",ne,[h(ue,{spinning:R(K)},{default:f((()=>[m('  v-if="roleTree.length>0" 有数据时才加载子组件 解决异步问题 '),m(' :expandAll="true" '),m(' :selectedKeys="state.selectedKeys" '),R(k).length?(c(),y(z,{key:0,class:"maxh",treeData:R(k),fieldNames:J,onEmitSelect:Y,onGetTreeTypeId:ee,expandAll:!0},{handleItem:f((({handleItem:e})=>[e.isDefault?(c(),y(D,{key:0,trigger:["click"]},{overlay:f((()=>[h(x,null,{default:f((()=>[(c(),y(T,{key:e.id+e.name+e.roleTypeName,auth:e.roleTypeId?"editRole":"editRoleType"},{default:f((()=>[h(n,{onClick:t=>{return a=e,v.rowsId=a.id,v.rowsType=a.level,v.rowsPid=a.roleTypeId,v.editRoleVisible=!0,void(a.roleTypeId?(v.modalTitle="编辑角色",v.editRoleForm.roleName=a.name,v.editRoleForm.grouping=a.roleTypeId):(v.modalTitle="编辑角色类别",v.editRoleForm.roleName=a.name));var a}},{default:f((()=>[h(r,{type:"text"},{default:f((()=>[g(I(e.roleTypeId?"编辑角色":"编辑角色类别"),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["auth"])),(c(),y(T,{key:e.id+e.name+e.roleTypeName,auth:e.roleTypeId?"removeRole":"removeRoleType"},{default:f((()=>[h(n,{onClick:t=>(e=>{let t="删除角色类别",s="角色类别删除后不可恢复，是否继续？";e.roleTypeId&&(t="删除角色",s="角色删除后不可恢复，是否继续？"),U.confirm({title:t,content:s,okText:"确认",cancelText:"取消",icon:h(q),onCancel(){P.info("已取消！")},onOk(){const t={id:e.id,type:e.level};a.$defHttp.post(l.roleTypeDelete,t).then((e=>{Z(),P.success(e.message)}))}})})(e)},{default:f((()=>[h(r,{type:"link",danger:""},{default:f((()=>[g(I(e.roleTypeId?"删除角色":"删除角色类别"),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["auth"]))])),_:2},1024)])),default:f((()=>[L((c(),u("a",{class:"ant-dropdown-link handle_icon",onClick:t[0]||(t[0]=V((()=>{}),["prevent","stop"]))},[h(d)])),[[be,["editRole","editRoleType","removeRole","removeRoleType"]]])])),_:2},1024)):m("v-if",!0)])),handleFooter:f((()=>[h(ie,{class:"btn"},{default:f((()=>[h(se,{span:11},{default:f((()=>[L((c(),y(r,{type:"primary",onClick:G},{icon:f((()=>[h(ae)])),default:f((()=>[g(" 新增角色 ")])),_:1})),[[be,"addRole"]])])),_:1}),h(se,{span:12},{default:f((()=>[L((c(),y(r,{type:"primary",onClick:t[1]||(t[1]=e=>(void 0!==s.value&&s.value.resetFields(),v.editRoleForm.roleName="",v.editRoleVisible=!0,void(v.modalTitle="新增角色类别")))},{icon:f((()=>[h(le)])),default:f((()=>[g(" 新增角色类别 ")])),_:1})),[[be,"addRoleType"]])])),_:1})])),_:1})])),_:1},8,["treeData"])):m("v-if",!0)])),_:1},8,["spinning"])])])),_:1},8,["offset-top"]),b("div",pe,[h(fe,{"default-active-key":R(M),onChange:X},{default:f((()=>[h(ye,{key:"3",tab:"角色成员"},{default:f((()=>[R(A)?(c(),y(oe,{key:0,treeTypeId:String(R($)),treeId:R(A),treeType:String(R(F)),treeIsDefault:String(R(H)),yuanId:R(E),ref_key:"roleMembersRef",ref:o},null,8,["treeTypeId","treeId","treeType","treeIsDefault","yuanId"])):m("v-if",!0),b("div",ce,[h(R(q)),g(I("校长")+"为默认角色，如需修改请前往“组织管理-学籍管理”修改校长 ")])])),_:1}),h(ye,{key:"1",tab:"功能权限"},{default:f((()=>[h(B,{ref:"functionalauthorityRef"},null,512)])),_:1}),h(ye,{key:"2",tab:"数据权限","force-render":""},{default:f((()=>[R(A)?(c(),y(te,{key:0,treeId:R(A),treeType:String(R(F)),treeIsDefault:String(R(H)),treeTypeId:String(R($)),codeValue:R(O),yuanId:R(E)},null,8,["treeId","treeType","treeIsDefault","treeTypeId","codeValue","yuanId"])):m("v-if",!0)])),_:1})])),_:1},8,["default-active-key"])])]),m(" 编辑角色弹框 "),h(ke,{visible:R(_),"onUpdate:visible":t[4]||(t[4]=e=>C(_)?_.value=e:null),title:R(N),width:"400px",style:{top:"150px"},maskClosable:!1,onCancel:W,onOk:Q},{default:f((()=>[h(Ie,{model:R(j),layout:"vertical",ref_key:"editRoleRef",ref:s},{default:f((()=>[h(ve,{label:"新增角色类别"==R(N)?"角色类别名称":"新增角色"==R(N)?"角色名称":"编辑角色类别"==R(N)?"角色类别名称":"编辑角色"==R(N)?"角色名称":"",name:"roleName",rules:[{required:!0,message:"请输入角色名称！"}]},{default:f((()=>[h(he,{value:R(j).roleName,"onUpdate:value":t[2]||(t[2]=e=>R(j).roleName=e),valueModifiers:{trim:!0},placeholder:"请输入角色名称（不超过20字）","allow-clear":"",maxlength:20},null,8,["value"])])),_:1},8,["label"]),"编辑角色"==R(N)||"新增角色"==R(N)?(c(),y(ve,{key:0,label:"分组到：",name:"grouping",rules:[{required:!0,message:"请选择分组！"}]},{default:f((()=>[h(ge,{value:R(j).grouping,"onUpdate:value":t[3]||(t[3]=e=>R(j).grouping=e),options:R(w),disabled:"编辑角色"==R(N)},null,8,["value","options","disabled"])])),_:1})):m("v-if",!0)])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-3306b8c4"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/role/index.vue"]]);export{ue as default};
