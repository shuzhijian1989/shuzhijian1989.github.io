import"./vue.a2f518ee.js";import{_ as e}from"./empty.1f473950.js";import{s,a as t,b as a,g as i}from"./studentduty.29252bde.js";import{_ as n,u as o,L as r,aw as d,ax as l}from"./index.7061e8ea.js";import{m as c,M as u}from"./ant-design-vue.db4d48e3.js";import{e as m,r as p,q as f,f as j,b8 as v,o as k,a as w,b,c as g,a3 as h,a7 as L,F as y,a8 as I,a9 as _,O as x,a2 as S,h as C,b5 as N,b4 as W}from"./@vue.919ff404.js";import{E as D}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./vue-router.907b547c.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./dayjs.49e29cb2.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const O=e=>(N("data-v-47f009c0"),e=e(),W(),e),B={class:"toBeOnDuty"},T={class:"weekList"},q={class:"title"},F={class:"title_name"},U={class:"nowarp"},M=["onClick"],z={class:"list_item list_add"},E=O((()=>b("span",{class:"nowarp"},"选择人员及项目",-1))),P=["onClick"],R={key:0,class:"no_data"},$=[O((()=>b("img",{src:e,alt:""},null,-1))),O((()=>b("p",null,"还没有设置值日生",-1)))],A={class:"img"},G=["src"],H={style:{display:"flex","justify-content":"center"}},J=m({name:"name"});var K=n(Object.assign(J,{setup(e){const n=o(),m=p(),N=f({weekList:[{name:"星期一",week:1,studentWorkList:[]},{name:"星期二",week:2,studentWorkList:[]},{name:"星期三",week:3,studentWorkList:[]},{name:"星期四",week:4,studentWorkList:[]},{name:"星期五",week:5,studentWorkList:[]},{name:"星期六",week:6,studentWorkList:[]},{name:"星期天",week:7,studentWorkList:[]}],week:"",projectInfo:{students:[],projectId:""},spinLoad:!1,classesId:r.get("director_classId")||"",classList:[],sendStudents:[],studentList:[],projectList:[],drawerShow:!1,hasData:!1,submitBtnLoading:!1}),W={projectId:[{required:!0,message:"请选择项目",trigger:"blur"}],students:[{required:!0,message:"请选择学生"}]},{roll_status_yes_id:O}=n.state.selectSource.dictionary||{},J=()=>{for(let e=0;e<N.weekList.length;e++)N.weekList[e].studentWorkList=[];N.spinLoad=!0,i({classesId:N.classesId}).then((e=>{for(let s=0;s<e.data.length;s++){const t=e.data[s];for(let e=0;e<N.weekList.length;e++){const s=N.weekList[e];if(t.week==s.week)for(let e=0;e<t.students.length;e++){const{studentName:a,id:i}=t.students[e];s.studentWorkList.push({projectName:t.projectName,studentName:a,id:i})}}}e.data.length?N.hasData=!0:N.hasData=!1})).finally((()=>{N.spinLoad=!1}))},K=()=>{const e={statusList:O,classesId:N.classesId};l(e).then((e=>{N.studentList=e.data}))},Q=e=>{N.sendStudents=N.studentList.filter((s=>e.indexOf(s.id)>-1))},V=()=>{N.drawerShow=!1,m.value.resetFields()},X=()=>{const{classesId:e,week:s}=N,a={classesId:e,week:s,projectId:N.projectInfo.projectId,students:N.sendStudents.map((e=>({studentId:e.id,studentName:e.name})))};m.value.validate().then((()=>{N.submitBtnLoading=!0,t(a).then((e=>{c.success("操作成功"),N.drawerShow=!1,m.value.resetFields(),J()})).finally((e=>{N.submitBtnLoading=!1}))})).catch((e=>{}))};return j((()=>{d({code:"toBeOnDuty"}).then((e=>{N.classList=e.data,N.classesId=r.get("director_classId")||"",N.classesId&&(J(),K())})),s().then((e=>{N.projectList=e.data}))})),(e,s)=>{const t=v("delete-outlined"),i=v("a-spin"),n=v("a-radio"),o=v("a-radio-group"),r=v("a-form-item"),d=v("a-select"),l=v("a-form"),p=v("a-button"),f=v("a-drawer");return k(),w(y,null,[b("div",B,[g(i,{spinning:N.spinLoad},{default:h((()=>[L(' <div class="select">\r\n                <a-form>\r\n                    <a-form-item label="选择班级">\r\n                        <a-select\r\n                            style="width: 160px"\r\n                            @change="changeClass"\r\n                            v-model:value="state.classesId"\r\n                        >\r\n                            <a-select-option\r\n                                v-for="item in state.classList"\r\n                                :key="item.classesId"\r\n                                >{{ item.classesName }}\r\n                            </a-select-option>\r\n                        </a-select>\r\n                    </a-form-item>\r\n                </a-form>\r\n            </div> '),b("div",T,[(k(!0),w(y,null,I(N.weekList,(e=>(k(),w("div",{class:"weekTitle",key:e.name},[b("div",q,[b("div",F,_(e.name),1),(k(!0),w(y,null,I(e.studentWorkList,((e,s)=>(k(),w("div",{key:s,class:"list_item"},[b("span",U,_(e.projectName)+" "+_(e.studentName),1),b("span",{class:"del",onClick:s=>{return t=e,void u.confirm({title:"删除提示",icon:g(D),content:C("div",{},[C("p",`确定删除值日生【${t.studentName}】？`)]),okText:"确认",cancelText:"取消",onOk(){a({id:t.id}).then((e=>{c.success("操作成功")})).finally((()=>{J()}))}});var t},style:{width:"40px"}},[g(t)],8,M)])))),128)),b("div",z,[E,b("span",{class:"add",onClick:s=>(e=>{N.classesId?(N.week=e.week,N.drawerShow=!0):c.error("当前没有班级，不可添加值日生")})(e)},"+",8,P)])])])))),128))]),N.hasData?L("v-if",!0):(k(),w("div",R,$))])),_:1},8,["spinning"])]),g(f,{visible:N.drawerShow,"onUpdate:visible":s[2]||(s[2]=e=>N.drawerShow=e),maskClosable:!1,width:"500",title:"添加值日生"},{footer:h((()=>[b("div",H,[g(p,{onClick:V},{default:h((()=>[x("取消")])),_:1}),g(p,{loading:N.submitBtnLoading,style:{"margin-left":"12px"},type:"primary",onClick:X},{default:h((()=>[x("确认")])),_:1},8,["loading"])])])),default:h((()=>[g(l,{layout:"vertical",ref_key:"rulesRef",ref:m,rules:W,model:N.projectInfo},{default:h((()=>[g(r,{label:"选择项目",name:"projectId"},{default:h((()=>[g(o,{value:N.projectInfo.projectId,"onUpdate:value":s[0]||(s[0]=e=>N.projectInfo.projectId=e)},{default:h((()=>[(k(!0),w(y,null,I(N.projectList,(e=>(k(),S(n,{key:e.id,value:e.id},{default:h((()=>[b("div",A,[b("img",{src:e.icon,alt:""},null,8,G)]),b("p",null,_(e.projectName),1),L(" <p>你好你好你哈</p> ")])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),g(r,{label:"值日学生",name:"students"},{default:h((()=>[g(d,{showSearch:"",maxTagCount:3,maxTagTextLength:3,value:N.projectInfo.students,"onUpdate:value":s[1]||(s[1]=e=>N.projectInfo.students=e),mode:"multiple",style:{width:"100%"},placeholder:"请选择值日学生",options:N.studentList,onChange:Q,optionFilterProp:"name",fieldNames:{label:"name",value:"id"}},null,8,["value","options"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])],64)}}}),[["__scopeId","data-v-47f009c0"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/classManager/page/studentOnDuty/DutySet/index.vue"]]);export{K as default};
