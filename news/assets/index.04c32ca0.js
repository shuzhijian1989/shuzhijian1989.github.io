import"./vue.a2f518ee.js";import{s as e,d as a,c as t,u as s,a as i,b as o}from"./subjectInformation.1a2fd676.js";import{m as l}from"./ant-design-vue.db4d48e3.js";import{_ as n,n as r,p as c}from"./index.7061e8ea.js";import{_ as d}from"./index.272083a4.js";import{I as m}from"./newindex.34397320.js";import{r as p,q as u,z as b,f as g,b8 as f,I as j,o as v,a as h,a7 as y,b as x,c as k,H as _,a2 as L,a3 as F,O as w,F as S,a9 as T,a8 as N,u as C,b5 as I,b4 as U,m as E}from"./@vue.919ff404.js";import{E as z}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./vue-router.907b547c.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const B={class:"restBox"},O=(e=>(I("data-v-5ca5793b"),e=e(),U(),e))((()=>x("div",{class:"restTitle"},"科目信息列表",-1))),P={class:"restHeader"},D={style:{display:"flex"}},V={key:0},$={key:1},q=["onClick"],H={class:"editButton"};var K=n({__name:"index",setup(n){const{proxy:I}=E(),U={name:[{required:!0,message:"请先输入科目名称"}]},K=p(),R=[{title:"科目名称",dataIndex:"name",width:130},{title:"科目等级",dataIndex:"levelName",width:100},{title:"关联任课老师",dataIndex:"teacherNames"},{title:"操作",width:100,dataIndex:"operation"}],A=u({accept:".doc,.docx,.xlsx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",managerVisible:!1,checkedList:[],restDisabled:!0,searchLoading:!1,deleteLoging:!1,submitLoading:!1,spinning:!1,onSearchName:"",pagination:{pageNo:1,pageSize:10,total:0},visible:!1,subjectTitle:"新增科目",subjectForm:{name:"",grade:"",teacherNames:"",employeeIds:[]},dataSource:[],levelList:[],allSubject:"",isCourseTeacherFn:!1,importExportParams:{btnType:"",isUploading:!1,spinning:!1,visible:!1,title:"导入",accept:"",importId:"",importType:0,downloadText:"",uploadUrl:"",progressUrl:r.progressUrl,errorUrl:r.importErrorLog,importParam:{},downloadUrl:"",importBtn:[{value:"0",text:"下载文件"}],exportBtn:[{value:"",text:"上传文件"}],importExportType:"importList"}});b("actionParams",(()=>A.importExportParams));const M="http://192.168.3.158:9528";function G(){Object.assign(A.importExportParams,{btnType:"subjectColumn",importType:5,title:"导入",downloadText:"科目信息导入模版",visible:!0,downloadUrl:`${M}${r.generalExportUrl}`,uploadUrl:`${M}/cloud/common/import`,importBtn:[{value:"0",text:"下载文件"}],importParam:{},importExportType:"importList"})}const J=()=>{A.subjectForm.employeeIds=[],A.subjectForm.teacherNames=""},Q=e=>{A.subjectForm.employeeIds=[];const a=[];e.forEach((e=>{a.push(e.name),A.subjectForm.employeeIds.push(e.id)})),A.subjectForm.teacherNames=a.toString(",")},W=()=>{A.spinning=!0;const a={...A.pagination,name:A.onSearchName};e(a).then((e=>{A.dataSource=e.data.list,A.pagination.total=e.data.total})).finally((()=>{A.spinning=!1,A.searchLoading=!1}))},X=()=>{I.$confirm({title:"删除提示",icon:k(z),content:"删除后不可恢复，如需继续删除，请点击确定",okType:"danger",okText:"确定",cancelText:"取消",onOk(){A.deleteLoging=!0;const e={ids:A.allSubject};a(e).then((e=>{l.success(e.message),A.pagination.pageNo=1,A.pagination.pageSize=10,W()})).finally((()=>{A.deleteLoging=!1}))}})};const Y=(e,a)=>{var t;i(["subject_level"]).then((e=>{A.levelList=e.data[0].list})),!1===e?(A.subjectForm={},A.visible=!0,A.subjectTitle="添加科目信息表"):(A.visible=!0,A.subjectTitle="编辑科目信息表",t=a.id,o({id:t}).then((e=>{const{teacherList:a,level:t,name:s,id:i}=e.data;A.subjectForm.employeeIds=[],A.checkedList=a||[],A.subjectForm.level=t||null,A.subjectForm.name=s||"",A.subjectForm.id=i||"";const o=[];null==a||a.forEach(((e,a)=>{o.push(e.name),A.subjectForm.employeeIds.push(e.id)})),A.subjectForm.teacherNames=null==o?void 0:o.join(",")})))};function Z(){A.visible=!1,A.checkedList=[]}const ee=()=>{K.value.validate().then((()=>{"添加科目信息表"===A.subjectTitle?ae():"编辑科目信息表"===A.subjectTitle&&te()})).catch((e=>{}))},ae=()=>{A.submitLoading=!0,t(A.subjectForm).then((e=>{A.visible=!1,l.success(e.message),Z(),W()})).finally((()=>{A.submitLoading=!1}))},te=()=>{A.submitLoading=!0,s(A.subjectForm).then((e=>{A.visible=!1,l.success(e.message),Z(),W()})).finally((()=>{A.submitLoading=!1}))},se=e=>{A.pagination.pageNo=e.current,A.pagination.pageSize=e.pageSize,W()},ie=(e,a)=>{e.length>0?(A.restDisabled=!1,A.allSubject=e):A.restDisabled=!0},oe=e=>{A.searchLoading=!0,A.onSearchName=e,A.pagination.pageNo=1,A.pagination.pageSize=10,W()};return g((()=>{W()})),(e,a)=>{const t=f("a-input-search"),s=f("plus-outlined"),i=f("a-button"),o=f("a-spin"),l=f("a-layout-content"),n=f("a-input"),r=f("a-form-item"),p=f("a-select-option"),u=f("a-select"),b=f("a-form"),g=f("a-drawer"),I=j("auth");return v(),h("div",B,[O,y(" 头部 "),x("div",P,[k(t,{placeholder:"请输入科目名称关键字搜索",style:{width:"336px"},loading:A.searchLoading,onSearch:oe,allowClear:!0},null,8,["loading"]),x("div",D,[_((v(),L(i,{type:"primary",onClick:a[0]||(a[0]=e=>Y(!1))},{icon:F((()=>[k(s)])),default:F((()=>[w(" 添加科目 ")])),_:1})),[[I,"add"]]),y(' <a-button style="margin-left: 12px" @click="courseTeacherFn">关联任课老师</a-button> '),k(i,{style:{"margin-left":"12px"},onClick:G},{default:F((()=>[w("导入")])),_:1}),k(o,{spinning:A.deleteLoging},{default:F((()=>[_((v(),L(i,{danger:"",style:{"margin-left":"12px"},onClick:X,disabled:A.restDisabled},{default:F((()=>[w(" 批量删除 ")])),_:1},8,["disabled"])),[[I,"batchRemove"]])])),_:1},8,["spinning"])])]),k(l,null,{default:F((()=>[y(" 表格主体 "),k(o,{spinning:A.spinning},{default:F((()=>[k(d,{columns:R,dataSource:A.dataSource,rowSelection:!0,totals:A.pagination,onOnSelectedRowKeys:se,onOnSelectedArry:ie},{bodyCell:F((({column:e,record:a,text:t})=>["levelName"===e.dataIndex?(v(),h(S,{key:0},[a.levelName?(v(),h("span",V,T(a.levelName),1)):(v(),h("span",$," - "))],64)):y("v-if",!0),"operation"===e.dataIndex?_((v(),h("a",{key:1,style:{color:"var(--primary-color)"},onClick:e=>Y(!0,a)},[w("编辑")],8,q)),[[I,"edit"]]):y("v-if",!0)])),_:1},8,["dataSource","totals"])])),_:1},8,["spinning"])])),_:1}),y(" 表单弹框 "),k(g,{width:"480px",onClose:Z,class:"drawerButton",title:A.subjectTitle,maskClosable:!1,visible:A.visible},{default:F((()=>[k(b,{ref_key:"subjectFromRef",ref:K,layout:"vertical",name:"base",rules:U,model:A.subjectForm},{default:F((()=>[k(r,{label:"科目名称：",name:"name"},{default:F((()=>[k(n,{maxlength:20,value:A.subjectForm.name,"onUpdate:value":a[1]||(a[1]=e=>A.subjectForm.name=e),autocomplete:"off",placeholder:"请输入科目名称"},null,8,["value"])])),_:1}),k(r,{label:"科目等级："},{default:F((()=>[k(u,{value:A.subjectForm.level,"onUpdate:value":a[2]||(a[2]=e=>A.subjectForm.level=e),placeholder:"请选择科目等级"},{default:F((()=>[(v(!0),h(S,null,N(A.levelList,(e=>(v(),L(p,{key:e.value,value:e.value},{default:F((()=>[w(T(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),k(r,{label:"任课老师：",name:"teacherNames"},{default:F((()=>[k(n,{value:A.subjectForm.teacherNames,"onUpdate:value":a[3]||(a[3]=e=>A.subjectForm.teacherNames=e),allowClear:"",onClick:a[4]||(a[4]=e=>A.managerVisible=!0),onChange:J,placeholder:"请选择"},null,8,["value"])])),_:1}),k(r,{style:{position:"absolute",left:"0",bottom:"-24px",width:"100%",background:"#fff"}},{default:F((()=>[x("div",H,[k(i,{style:{"margin-right":"12px"},onClick:Z},{default:F((()=>[w("取消")])),_:1}),k(o,{spinning:A.submitLoading},{default:F((()=>[k(i,{type:"primary",onClick:ee,loading:A.submitLoading},{default:F((()=>[w("确定")])),_:1},8,["loading"])])),_:1},8,["spinning"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","visible"]),k(C(c),{mode:"personnel",tabs:[{tab:" 任课老师",key:1,checked:!0}],visible:A.managerVisible,"onUpdate:visible":a[5]||(a[5]=e=>A.managerVisible=e),checked:A.checkedList,"onUpdate:checked":a[6]||(a[6]=e=>A.checkedList=e),onHandleOk:Q,checkedKey:"id",selectedKeys:[]},null,8,["visible","checked"]),y(" 导入 "),k(m,{onEmitCallback:W})])}}},[["__scopeId","data-v-5ca5793b"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/basicManagement/subjectInformation/index.vue"]]);export{K as default};
