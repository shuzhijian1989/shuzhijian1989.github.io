import"./vue.a2f518ee.js";import{_ as e}from"./index.272083a4.js";import{u as a}from"./vue-router.907b547c.js";import{_ as t,n as s}from"./index.7061e8ea.js";import{s as i,c as o,d as l,n as r,e as n,f as c,g as d,h as u}from"./enumList.0f420b32.js";import{g as p}from"./FilterDropdown.5a779a00.js";import{r as m,q as v,f,b8 as y,o as h,a as g,c as b,a3 as k,b as j,a7 as x,O as F,a9 as _,F as w,u as T,a5 as S,a8 as I,a2 as L,a4 as N,b5 as D,b4 as z}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const C=e=>(D("data-v-ffc55258"),e=e(),z(),e),K=C((()=>j("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),A={class:"table_query_class"},Y={key:2},R=["onClick"],M={class:"modadlHeader"},U={class:"dack",style:{width:"671px"}},B={key:0},J={key:0,class:"dack ml260"},O={class:"dack"},q=C((()=>j("span",{class:"dack"},"请假理由：",-1))),H={class:"blk"},P=C((()=>j("h2",null,"流程",-1))),E=["src"],G={key:0,class:"noImg"},Q={key:1,class:"iconfont icon-richengwancheng iconClass",style:{color:"#00b781 !important"}},V={key:2,class:"iconfont icon-Shape11 iconClass",style:{color:"#fd4f45 !important"}},W={class:"description"},X={key:0},Z={key:0},$={class:"refuseReason"},ee={key:0,class:"iconfont icon-Shape3 iconClass",style:{color:"#00b781 !important"}},ae={class:"description"},te={key:0};var se=t({__name:"ApprovalRecord",setup(t){const D=a(),z=m(),C=m("审批记录"),se=m([{title:"发起人",dataIndex:"name",key:"id",showSorterTooltip:!0},{title:"审批类型",dataIndex:"type",key:"id",showSorterTooltip:!0},{title:"发起人类型",dataIndex:"identity",key:"identity",showSorterTooltip:!0,filters:[{text:"全部",value:""},{text:"学生",value:0},{text:"教职工",value:1},{text:"家长",value:2}],filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",p(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"},{title:"所在部门",dataIndex:"dept",key:"id",showSorterTooltip:!0},{title:"发起时间",dataIndex:"createTime",key:"id",showSorterTooltip:!0},{title:"状态",dataIndex:"status",key:"status",showSorterTooltip:!0,filters:[{text:"全部",value:""},{text:"已拒绝",value:0},{text:"审批中",value:1},{text:"已通过",value:2},{text:"已撤销",value:3}],filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",p(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"},{title:"操作",dataIndex:"operation",key:"id",width:80}]),ie=m({}),oe=m([]),le=v({current:0,visible:!1,spinLoad:!1,procNameList:[],pagination:{pageNo:1,pageSize:10,total:0},searchForm:{status:"",name:"",identity:"",type:null,departureTime:[]},exportLoading:!1,fileName:""});function re(){const{departureTime:e,name:a,identity:t,status:i}=le.searchForm,o={startTime:e[0]||"",endTime:e[1]||"",name:a,pageNo:1,pageSize:10,identity:t,status:i};n(s.exportProcUserApp,o,"审批记录表")}const ne=()=>{le.spinLoad=!0;const e={startTime:le.searchForm.departureTime&&le.searchForm.departureTime.length?le.searchForm.departureTime[0]:"",endTime:le.searchForm.departureTime&&le.searchForm.departureTime.length?le.searchForm.departureTime[1]:"",status:le.searchForm.status,identity:le.searchForm.identity,name:le.searchForm.name,pageNo:le.pagination.pageNo,pageSize:le.pagination.pageSize};c(e).then((e=>{const{list:a,total:t}=e.data;oe.value=a,le.pagination.total=t})).finally((()=>{le.spinLoad=!1}))},ce=()=>{z.value.resetFields(),le.pagination.pageNo=1,le.pagination.pageSize=10,ne()},de=()=>{D.back(-1)},ue=e=>{const{pageSize:a,current:t,status:s,identity:i}=e;le.searchForm.status=s?s[0]:"",le.searchForm.identity=i?i[0]:"",le.pagination.pageNo=t,le.pagination.pageSize=a,ne()},pe=()=>{le.pagination.pageNo=1,le.pagination.pageSize=10,ne()};return f((()=>{ne(),d().then((e=>{le.procNameList=e.data.map((e=>({label:e,value:e})))})).catch((e=>{}))})),(a,t)=>{const s=y("a-layout-header"),n=y("a-input"),c=y("a-form-item"),d=y("a-select"),p=y("a-range-picker"),m=y("SearchOutlined"),v=y("a-button"),f=y("reload-outlined"),D=y("a-form"),ne=y("a-tag"),me=y("a-layout-content"),ve=y("a-step"),fe=y("a-steps"),ye=y("a-modal");return h(),g("div",null,[b(me,{class:"reset-layout-content"},{default:k((()=>[b(s,{class:"reset-layout-header"},{default:k((()=>[j("span",{onClick:de},[x(' <arrow-left-outlined class="left-outlined" /> '),K,F(" "+_(C.value),1)])])),_:1}),b(e,{class:"worker-table",rowSelection:!1,columns:se.value,dataSource:oe.value,totals:le.pagination,slots:["operation"],spinLoad:le.spinLoad,onOnSelectedRowKeys:ue},{handleItem:k((()=>[j("div",A,[b(D,{model:le.searchForm,layout:"inline",ref_key:"formRef",ref:z},{default:k((()=>[b(c,{label:"关键词：",name:"name"},{default:k((()=>[b(n,{value:le.searchForm.name,"onUpdate:value":t[0]||(t[0]=e=>le.searchForm.name=e),placeholder:"请输入教职工姓名搜索",style:{width:"300px"}},null,8,["value"])])),_:1}),b(c,{label:"审批类型：",name:"type",style:{width:"300px"}},{default:k((()=>[b(d,{"allow-clear":"",value:le.searchForm.type,"onUpdate:value":t[1]||(t[1]=e=>le.searchForm.type=e),placeholder:"请选择审批类型组",options:le.procNameList},null,8,["value","options"])])),_:1}),b(c,{label:"发起时间：",name:"departureTime"},{default:k((()=>[b(p,{value:le.searchForm.departureTime,"onUpdate:value":t[2]||(t[2]=e=>le.searchForm.departureTime=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",separator:"至"},null,8,["value"])])),_:1}),b(c,null,{default:k((()=>[b(v,{type:"primary",onClick:pe},{icon:k((()=>[b(m)])),default:k((()=>[F(" 查询 ")])),_:1})])),_:1}),b(c,null,{default:k((()=>[b(v,{onClick:ce},{icon:k((()=>[b(f)])),default:k((()=>[F(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"]),b(v,{loading:le.exportLoading,onClick:re},{default:k((()=>[F(" 导出 ")])),_:1},8,["loading"])])])),bodyCell:k((({column:e,record:a})=>["identity"===e.dataIndex?(h(),g(w,{key:0},[F(_(T(i)[a.identity]),1)],64)):x("v-if",!0),"type"===e.dataIndex?(h(),g(w,{key:1},[F(" 请假 ")],64)):x("v-if",!0),"status"===e.dataIndex?(h(),g("span",Y,[b(ne,{class:"tagsReset",color:0===a.status?"#F5222D":1===a.status?"#FAAD14":2===a.status?"#00B781":3===a.status?"#BFBFBF":"#595959"},null,8,["color"]),F(" "+_(T(o)[a.status]),1)])):x("v-if",!0),"operation"===e.dataIndex?(h(),g("a",{key:3,style:{color:"var(--primary-color)","margin-right":"10px"},onClick:e=>{u({id:a.id}).then((e=>{if(ie.value=e.data,2===ie.value.status)le.current=ie.value.hiApprNodeList.length+ie.value.ccList.length;else{const e=ie.value.hiApprNodeList.filter((e=>e.apprTime));le.current=1===e.length?e.length:e.length-1}le.visible=!0}))}},"查看",8,R)):x("v-if",!0)])),_:1},8,["columns","dataSource","totals","spinLoad"])])),_:1}),b(ye,{visible:le.visible,"onUpdate:visible":t[3]||(t[3]=e=>le.visible=e),title:"审批详情",class:"addRuleModal",width:"788px",bodyStyle:{height:"605px",overflow:"scroll"},footer:null},{default:k((()=>[j("div",M,[j("div",{class:"status",style:S({background:T(l)[ie.value.status]})},_(T(o)[ie.value.status]),5),j("p",null,[j("span",U,[F("发起人："),j("i",null,_(ie.value.name),1),2!==ie.value.identity?(h(),g("span",B,"("+_(ie.value.dept)+")",1)):x("v-if",!0)]),2===ie.value.identity?(h(),g("span",J,[F("请假学生："),j("i",null,_(ie.value.apprJson.student),1),F("("+_(ie.value.dept)+")",1)])):x("v-if",!0)]),j("p",null,[j("span",O,[F("请假时间："),j("i",null,_(ie.value.apprJson.startTime+"-"+ie.value.apprJson.endTime),1)])]),j("p",null,[q,j("span",H,_(ie.value.apprJson.reason),1)])]),P,b(fe,{direction:"vertical",current:le.current,class:"procedureSteps_dh"},{default:k((()=>[(h(!0),g(w,null,I(ie.value.hiApprNodeList,((e,a)=>(h(),L(ve,{title:0===a?"发起申请":"审批人",key:e},{icon:k((()=>[j("div",{class:N(["procedureIcon",2===ie.value.status||1!==e.status&&e.status&&7!==e.status?"borderIcon":0===e.status?"reasonBorder":""])},[j("img",{src:e.avatar,alt:""},null,8,E),""!==e.avatar&&e.avatar||!e.userName?x("v-if",!0):(h(),g("div",G,_(e.userName.slice(-2)),1)),2===ie.value.status.status||1!==e.status&&e.status&&7!==e.status?(h(),g("i",Q)):x("v-if",!0),0===e.status?(h(),g("i",V)):x("v-if",!0)],2)])),description:k((()=>[j("div",W,[j("span",null,_(e.userName),1),[0,2,3,4].indexOf(e.status)>-1?(h(),g("span",X,"("+_(T(r)[e.status])+")",1)):x("v-if",!0),j("time",null,_(e.apprTime),1)]),0===e.status&&e.comment?(h(),g("div",Z,_("拒绝理由:"+e.comment),1)):x("v-if",!0),j("div",$,_(e.title),1)])),_:2},1032,["title"])))),128)),0!==ie.value.status&&0!=ie.value.ccList.length?(h(),L(ve,{key:0,title:"抄送人"},{icon:k((()=>[j("div",{class:N(["procedureIcon",2===ie.value.status?"borderIcon":""])},[j("i",{class:N([2===ie.value.status.status?"iconFont":"","iconfont icon-a-bianzu9 iconFontNo"])},null,2),2===ie.value.status.status?(h(),g("i",ee)):x("v-if",!0)],2)])),description:k((()=>[j("div",ae,[(h(!0),g(w,null,I(ie.value.ccList,(e=>(h(),g("div",{key:e},[j("span",null,_(e.name),1),a.idx!==ie.value.ccList.length-1?(h(),g("span",te,"   ")):x("v-if",!0)])))),128))])])),_:1})):x("v-if",!0)])),_:1},8,["current"])])),_:1},8,["visible"])])}}},[["__scopeId","data-v-ffc55258"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/views/approve/ApprovalRecord.vue"]]);export{se as default};
