import"./vue.a2f518ee.js";import{M as e,m as t}from"./ant-design-vue.db4d48e3.js";import{_ as a,u as s,p as i,n as o,s as n,T as l}from"./index.7061e8ea.js";import{q as d,y as c,b8 as r,o as p,a as u,F as m,a8 as h,b as v,a9 as f,c as y,a3 as g,a7 as k,a2 as b,W as j,O as _,r as I,t as S,G as w,w as F,f as C,u as L,a5 as x,P as O,aK as D,a1 as R,b5 as N,b4 as P,m as T,I as U,H as A,L as H}from"./@vue.919ff404.js";import{a as $,u as E}from"./vue-router.907b547c.js";import{_ as q}from"./index.272083a4.js";import{A as M}from"./authorNum.3e5a5dc5.js";import{E as G}from"./@ant-design.2e172c39.js";import{u as z}from"./vuex.f308ecec.js";import"./@babel.6d5f88cb.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const B={class:"apply_group__warp"},J={class:"apply_group__title"},K=["onClick"],W={class:"apply_item__info"},V={class:"apply_logo"},Q=["innerHTML"],X={class:"apply_name"},Y={class:"apply_item__hanle"},Z=["onClick"],ee={class:"apply_item__info"},te={class:"apply_logo"},ae={class:"apply_name"},se={class:"apply_item__hanle"};var ie=a({__name:"ApplyGroup",props:{data:{type:Array,default:()=>[]}},emits:["handleClick"],setup(e,{emit:t}){const a=d({openApp:!1});function s(e){t("handleClick",e)}const i=()=>{a.openApp=!a.openApp},o=c((()=>e=>{if(e.extend){const t=JSON.parse(e.extend);return`<i class="table_icon iconfont ${t.icon}" style="background-color: ${t.background}"></i>`}return""}));return(t,n)=>{const l=r("a-image"),d=r("a-col"),c=r("a-row"),I=r("up-outlined"),S=r("down-outlined");return p(),u("div",B,[(p(!0),u(m,null,h(e.data,((e,n)=>(p(),u("div",{class:"apply_group",key:`group_${n}`},[v("div",J,f(e.categoryName),1),y(c,{class:"apply_group__list",gutter:16},{default:g((()=>[k(" eslint-disable vue/no-use-v-if-with-v-for,vue/no-confusing-v-for-v-if "),(p(!0),u(m,null,h(e.apps,((e,i)=>(p(),b(d,{span:4,class:"apply_item__warp",key:`apply_${i}`,xs:24,sm:24,md:12,lg:8,xl:6,xxl:4},{default:g((()=>[k(" 应用 "),1!==e.status?(p(),u("div",{key:0,class:"apply_item",onClick:t=>s(e)},[v("div",W,[v("div",V,[e.logo?(p(),b(l,{key:0,width:48,height:48,src:e.logo,preview:!1},null,8,["src"])):(p(),u("span",{key:1,class:"icon_content",innerHTML:o.value(e)},null,8,Q))]),v("span",X,f(e.name),1)]),v("div",Y,[j(t.$slots,"apply",{apply:e})])],8,K)):k("v-if",!0),k(" 停用应用 "),1===e.status&&!0===a.openApp?(p(),u("div",{key:1,class:"apply_item",onClick:t=>s(e)},[v("div",ee,[v("div",te,[y(l,{width:48,height:48,src:e.logo,preview:!1},null,8,["src"])]),v("span",ae,f(e.name),1)]),v("div",se,[j(t.$slots,"apply",{apply:e})])],8,Z)):k("v-if",!0)])),_:2},1024)))),128))])),_:2},1024),"停用应用"===e.categoryName?(p(),u("div",{key:0,onClick:i,class:"openClass"},[!0===a.openApp?(p(),b(I,{key:0})):k("v-if",!0),!1===a.openApp?(p(),b(S,{key:1})):k("v-if",!0),_(" "+f(!0===a.openApp?"收起":"展开"),1)])):k("v-if",!0)])))),128))])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/components/ApplyGroup.vue"]]);const oe=e=>(N("data-v-112c7dee"),e=e(),P(),e),ne={class:"setup_container"},le={class:"reset-layout-header"},de=oe((()=>v("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),ce=oe((()=>v("span",null,"返回",-1))),re={class:"reset-layout-content"},pe={class:"application-header"},ue={class:"setup-application-sketch"},me={class:"setup-application-cover"},he=["src"],ve=["innerHTML"],fe={class:"setup-application-name"},ye={class:"apply_desc"},ge={class:"open"},ke={class:"application-visible-range"},be={class:"vRange"},je=oe((()=>v("span",null,"应用可见范围：",-1))),_e=oe((()=>v("i",{class:"iconfont icon-xingzhuang"},null,-1))),Ie=oe((()=>v("i",{class:"iconfont icon-xingzhuangjiehe113"},null,-1))),Se={key:1,class:"pvisible"},we={key:0},Fe={key:1},Ce={key:2},Le={key:3,class:"partSeeDiv"},xe={class:"authority-management"},Oe=oe((()=>v("h1",null,"应用权限管理",-1))),De={class:"addMember"},Re=["onClick"],Ne=["onClick"],Pe=["onClick"],Te={key:0},Ue=oe((()=>v("div",{class:"department"},"部门范围：",-1))),Ae={key:0},He=oe((()=>v("div",{class:"studentStatus"},"学籍范围：",-1)));var $e=a({__name:"setup",props:{appId:String},emits:["back"],setup(a,{emit:n}){const l=a,h=$(),{proxy:j}=T(),N=s(),P=I(),U=I({pageNo:1,pageSize:9999999,total:0}),A=d({extend:"",isOperate:!1,showDataScope:1,showScope:3,isOwn:!0,olCheckedList:[],checkedList:{},jurisdictionList:[],treeDataStudent:[],jeus:[],radioStyle:{display:"block",height:"30px",lineHeight:"30px"},installStatus:!1,title:"",status:"",value:"",visible:!1,url:"",text:"",addTitle:"",setupFlag:!0,visibleRangePersonnel:"",checked:[],personnelName:"",personnelId:[],jurisdictionForm:{functionPlainOptions:{},functionPlainOption:[],jurisdictionName:"",memberName:"",teacherIds:[],roleIds:[],function:"",department:"",departmentIds:[],student:"",studentIds:[],defaultRange1:"1",defaultRange2:"1"},plainOptions1:[{label:"全部",value:"1"},{label:"所管辖部门及下级部门",value:"4"},{label:"自定义",value:"2"}],plainOptions2:[{label:"全部",value:"1"},{label:"所负责学籍组织范围含下级组织",value:"4"},{label:"自定义",value:"2"}],type:"",dataSource:[],jurisdictionId:"",selectedPoolSelectedSet:[],selectedPoolSelectedSet1:[],selectedPoolSelectedSet2:[],selectedPoolSelectedSet3:[],selectMultiple:"personnel",visible1:!1,visible2:!1,visible3:!1,visible4:!1,checkedList1:[],checkedList2:[],checkedList3:[],checkedList4:[]}),{radioStyle:H,installStatus:E,setupFlag:z,extend:B,personnelName:J,jurisdictionForm:K,plainOptions1:W,plainOptions2:V,dataSource:Q,visible1:X,visible2:Y,visible3:Z,visible4:ee,checkedList1:te,checkedList2:ae,checkedList3:se,checkedList4:ie}=S(A),oe=[{title:"权限组名称",dataIndex:"name",ellipsis:!0,showSorterTooltip:!0,width:"140px"},{title:"权限成员",ellipsis:!0,showSorterTooltip:!0,dataIndex:"member"},{title:"权限范围",width:"230px",ellipsis:!0,showSorterTooltip:!0,dataIndex:"dataRange"},{title:"操作",width:"140px",dataIndex:"operation"}],$e=[{title:"角色名称",width:"150px",ellipsis:!0,showSorterTooltip:!0,dataIndex:"name"},{title:"权限成员",ellipsis:!0,showSorterTooltip:!0,dataIndex:"member"},{title:"操作",width:"120px",dataIndex:"operationOwn"}],Ee=c((()=>e=>{if(e.extend){const t=JSON.parse(e.extend);return`<i class="table_icon iconfont ${t.icon}" style="background-color: ${t.background}; background-image: none"></i>`}return""})),qe=e=>{const t=[];A.personnelId=[],e.length&&(e.forEach((e=>{t.push(e.name),e.userId?A.personnelId.push(e.userId):A.personnelId.push(e.id)})),A.personnelName=t.join("、"))},Me=e=>{if(2===A.type){if(!e.length)return;const t=[];A.jurisdictionForm.roleIds=[],A.jurisdictionForm.teacherIds=[],e.forEach((e=>{t.push(e.name),e.level?A.jurisdictionForm.roleIds.push(e.id):A.jurisdictionForm.teacherIds.push(e.userId||e.id)})),A.jurisdictionForm.memberName=t.join("、")}},Ge=e=>{const t=[];A.jurisdictionForm.departmentIds=[],e.length&&(e.forEach((e=>{t.push(e.showName||e.name),A.jurisdictionForm.departmentIds.push(e.id)})),A.jurisdictionForm.department=t.join("、"))},ze=e=>{const t=[];A.jurisdictionForm.studentIds=[],e.length&&(e.forEach((e=>{t.push(e.showName||e.name),A.jurisdictionForm.studentIds.push(e.id)})),A.jurisdictionForm.student=t.join("、"))},Be=()=>{A.type=1,A.visible1=!0},Je=e=>{1===e?(A.selectMultiple="personnel",A.selectTreeData=A.treeDataStudent):(A.selectMultiple="depa",A.selectTreeData=A.jeus)},Ke=()=>{A.type=2,A.visible2=!0,A.selectTreeData=A.treeDataStudent},We=async()=>{A.type=3,A.visible3=!0},Ve=async()=>{A.type=4,A.visible4=!0},Qe=d({jurisdictionName:[{required:!0,message:"请输入权限组名称"}],memberName:[{required:!0,message:"请选择权限组成员"}],defaultRange1:[{required:!0,message:"请选择"}],department:[{required:!0,message:"请选择"}],student:[{required:!0,message:"请选择"}],defaultRange2:[{required:!0,message:"请选择"}]}),Xe=()=>{n("back")},Ye=()=>{void 0!==P.value&&P.value.resetFields(),A.jurisdictionId="",A.addTitle="新增权限组",A.visible=!0,A.selectedPoolSelectedSet=[],A.selectedPoolSelectedSet1=[],A.selectedPoolSelectedSet2=[],A.selectedPoolSelectedSet3=[],A.checkedList1=[],A.checkedList2=[],A.checkedList3=[],A.checkedList4=[],A.jurisdictionForm.defaultRange1="1",A.jurisdictionForm.department="",A.jurisdictionForm.departmentIds=[],A.jurisdictionForm.defaultRange2="1",A.jurisdictionForm.studentIds=[],A.jurisdictionForm.student=""},Ze=()=>{P.value.validate().then((e=>{A.jurisdictionId?pt():ct()}))},et=e=>{const t={appId:l.appId};j.$defHttp.post(o.appCenterUpdateById,t).then((e=>{}))},tt=()=>{A.setupFlag=!1,A.installStatus=!0,A.personnelId=[],nt()},at=()=>{A.setupFlag=!0,A.installStatus=!1,lt()},st=e=>{},it=e=>{A.jurisdictionForm.defaultRange1=e.target.value},ot=e=>{A.jurisdictionForm.defaultRange2=e.target.value},nt=()=>{const e={appId:l.appId};j.$defHttp.get(o.appCenterGei,e).then((e=>{const{logo:t,desc:a,name:s,status:i,extend:o,dataScope:n,peoples:l,showDataScope:d,showScope:c}=e.data;A.url=t,A.text=a,A.extend=o,A.title=s,A.status=!i,A.visibleRangePersonnel=n,A.value=n,A.showDataScope=d,A.showScope=c;const r=[];l&&(l.forEach((e=>{r.push(e.name),A.personnelId.push(e.id)})),A.personnelName=r.join("、"),A.checkedList1=l)}))},lt=()=>{const e={appId:l.appId,dataScope:A.value,UserId:A.personnelId};A.personnelName||(e.UserId=[]),j.$defHttp.post(o.updateDataScope,e).then((e=>{nt(),t.success(e.message)})).catch((e=>{t.error(e.data.message||e.message||e)}))},dt=()=>{const e={appId:l.appId};j.$defHttp.post(o.appGroupList,e).then((e=>{const{data:t}=e,a=t.map((e=>({id:e.id,name:e.name,dataRange:e.dataRange,member:e.member})));A.dataSource=a})).catch((()=>{}))},ct=()=>{let e=null,a=null;A.showDataScope&&1!==A.showDataScope||(e=A.jurisdictionForm.defaultRange1),A.showDataScope&&2!==A.showDataScope||(a=A.jurisdictionForm.defaultRange2);const s={appId:l.appId,name:A.jurisdictionForm.jurisdictionName,deptData:e,rollData:a,dataIds:[...A.jurisdictionForm.departmentIds,...A.jurisdictionForm.studentIds],userIds:A.jurisdictionForm.teacherIds,roleIds:A.jurisdictionForm.roleIds,menuIds:[]},i=Object.values(A.jurisdictionForm.functionPlainOptions);if(i.length){const e=[];for(const t of i)t[0]&&e.push(t[0]);s.menuIds=e}j.$defHttp.post(o.createAppGroup,s).then((e=>{A.jurisdictionForm.functionPlainOptions={},dt(),t.success(e.message)})).catch((e=>{t.error(e.data.message||e.message||e)})),A.visible=!1},rt=e=>{const t={id:e.id};j.$defHttp.get(o.seeAppGroup,t).then((e=>{const{name:t,deptData:a,rollData:s,deptList:i,userList:o,roleList:n,menuIds:l,rollList:d}=e.data;if(A.jurisdictionForm.jurisdictionName=t,A.jurisdictionForm.defaultRange1=a+"",A.jurisdictionForm.defaultRange2=s+"",i.length){const e=[];i.forEach((t=>{e.push(t.name),A.jurisdictionForm.departmentIds.push(t.id)})),A.jurisdictionForm.department=e.join("、")}A.selectedPoolSelectedSet=i,A.checkedList3=i,l.length&&l.forEach((e=>{A.jurisdictionForm.functionPlainOptions[e]||(A.jurisdictionForm.functionPlainOptions[e]=[e])}));const c=[],r=[];if(o.length&&o.forEach((e=>{r.push(e.name),A.jurisdictionForm.teacherIds.push(e.id),c.push({name:e.name,id:e.id})})),n.length&&n.forEach((e=>{r.push(e.name),A.jurisdictionForm.roleIds.push(e.id),c.push({...e,level:"true",id:e.id})})),A.checkedList2=c,A.jurisdictionForm.memberName=r.join("、"),A.selectedPoolSelectedSet2=[...n,...o],d.length){const e=[];d.forEach((t=>{e.push(t.name),A.jurisdictionForm.studentIds.push(t.id)})),A.jurisdictionForm.student=e.join("、")}A.selectedPoolSelectedSet1=d,A.checkedList4=d})).catch((()=>{}))},pt=()=>{let e=null,a=null;A.showDataScope&&1!==A.showDataScope||(e=A.jurisdictionForm.defaultRange1),A.showDataScope&&2!==A.showDataScope||(a=A.jurisdictionForm.defaultRange2);const s={id:A.jurisdictionId,name:A.jurisdictionForm.jurisdictionName,deptData:e,rollData:a,dataIds:[...A.jurisdictionForm.departmentIds,...A.jurisdictionForm.studentIds],userIds:A.jurisdictionForm.teacherIds,roleIds:A.jurisdictionForm.roleIds,menuIds:[]},i=Object.values(A.jurisdictionForm.functionPlainOptions);if(i.length){const e=[];for(const t of i)t[0]&&e.push(t[0]);s.menuIds=e}j.$defHttp.post(o.updateAppGroup,s).then((e=>{dt(),t.success(e.message)})),A.visible=!1},ut=e=>{e.forEach((e=>{e.childrens=e.children,e.btnList.length&&e.children.push(...e.btnList),e.childrens.length&&ut(e.children)}))};return w((()=>{const{isOwn:e}=h.query;A.isOwn=1===Number.parseInt(e),(()=>{const{codes:e}=h.query,t=N.state.base.allJurisdiction.find((t=>t.code===e));if(t&&(A.isOperate=t.isOperate),A.jurisdictionList=[],t&&t.list.length){const e=JSON.parse(JSON.stringify(t.list));e&&e.length&&e.length&&ut(e),A.jurisdictionList=e||[]}})(),A.visible||(A.jurisdictionForm.functionPlainOptions={},A.jurisdictionForm.functionPlainOption=[])})),F((()=>A.showDataScope),(e=>{})),C((()=>{nt(),dt(),j.$defHttp.get(o.roleTypeList).then((e=>{const{data:t}=e;A.jeus=t})),N.dispatch("selectSource/setOrganizationTree").then((e=>{A.treeDataStudent=e}))})),(a,s)=>{const n=r("a-button"),l=r("a-switch"),d=r("a-radio"),c=r("a-input"),h=r("a-radio-group"),I=r("plus-outlined"),S=r("a-divider"),w=r("a-tooltip"),F=r("a-form-item"),C=r("a-form"),N=r("a-modal");return p(),u("div",ne,[k(" 返回头部 "),v("div",le,[y(n,{type:"text",class:"tabs_back",onClick:Xe},{default:g((()=>[k(' <arrow-left-outlined class="left-outlined" /> '),de,ce])),_:1})]),k(" 内容主体 "),v("div",re,[k(" 应用介绍 "),v("div",pe,[v("div",ue,[v("div",me,[A.url?(p(),u("img",{key:0,class:"cover-img",src:A.url,alt:""},null,8,he)):(p(),u("span",{key:1,class:"icon_content",innerHTML:Ee.value(A)},null,8,ve))]),v("div",fe,[v("p",null,f(A.title),1),v("span",ye,f(A.text),1)])]),v("div",ge,[v("p",null,f(1==A.status?"已启用":"已禁用"),1),y(l,{checked:A.status,"onUpdate:checked":s[0]||(s[0]=e=>A.status=e),onChange:et},null,8,["checked"])])]),k(" 应用可见范围 "),v("div",ke,[v("div",be,[je,L(z)?(p(),u("span",{key:0,onClick:tt,class:"setup"},[k(" <setting-outlined /> "),_e,_(" 设置 ")])):k("v-if",!0),L(z)?k("v-if",!0):(p(),u("span",{key:1,onClick:at,class:"setup"},[k(" <calendar-outlined /> "),Ie,_(" 保存 ")]))]),L(E)?(p(),b(h,{key:0,value:A.value,"onUpdate:value":s[2]||(s[2]=e=>A.value=e),onChange:st},{default:g((()=>[y(d,{style:x(L(H)),value:1},{default:g((()=>[_(f(0==A.showScope?"全部教师、学生（家长）可见":"全部教师可见"),1)])),_:1},8,["style"]),y(d,{style:x(L(H)),value:2},{default:g((()=>[_(f(0==A.showScope?"部分教师、学生（家长）可见":"部分教师可见")+" ",1),2===A.value?(p(),b(c,{key:0,placeholder:"请选择",class:"ml",onClick:Be,value:L(J),"onUpdate:value":s[1]||(s[1]=e=>O(J)?J.value=e:null),allowClear:"",readonly:"readonly"},null,8,["value"])):k("v-if",!0)])),_:1},8,["style"]),y(d,{style:x(L(H)),value:3},{default:g((()=>[_("仅管理员可见")])),_:1},8,["style"])])),_:1},8,["value"])):k("v-if",!0),L(E)?k("v-if",!0):(p(),u("div",Se,[1==A.visibleRangePersonnel?(p(),u("span",we,f(0==A.showScope?"全部教师、学生（家长）可见":"全部教师可见"),1)):2==A.visibleRangePersonnel?(p(),u("span",Fe,f(0==A.showScope?"部分教师、学生（家长）可见":"部分教师可见"),1)):(p(),u("span",Ce," 仅管理员可见 ")),2==A.visibleRangePersonnel?(p(),u("div",Le,f(L(J)),1)):k("v-if",!0)]))]),k(" 表格 "),v("div",xe,[Oe,v("div",De,[A.isOwn?(p(),b(n,{key:0,type:"primary",onClick:Ye},{icon:g((()=>[y(I)])),default:g((()=>[_(" 新增权限组 ")])),_:1})):k("v-if",!0)]),y(q,{columns:A.isOwn?oe:$e,dataSource:L(Q),totals:U.value,rowSelection:!1},{bodyCell:g((({column:a,text:s,record:i})=>["operation"===a.dataIndex?(p(),u(m,{key:0},[v("a",{style:{color:"var(--primary-color)"},onClick:e=>{return t=i,A.jurisdictionId=t.id,void 0!==P.value&&P.value.resetFields(),A.addTitle="编辑权限组",A.visible=!0,A.jurisdictionForm.departmentIds=[],A.jurisdictionForm.teacherIds=[],A.jurisdictionForm.roleIds=[],A.jurisdictionForm.studentIds=[],void rt(t);var t}},"编辑",8,Re),y(S,{type:"vertical"}),v("a",{onClick:a=>{return s=i,void e.confirm({title:"删除提示",icon:y(G),content:"确定删除吗？",okText:"确认",cancelText:"取消",onCancel(){t.info("已取消！")},onOk(){const e={id:s.id};j.$defHttp.post(o.deleteAppGroup,e).then((e=>{dt(),t.success(e.message)}))}});var s},style:{color:"red"}},"删除",8,Ne)],64)):k("v-if",!0),"operationOwn"===a.dataIndex?(p(),u("a",{key:1,style:{color:"var(--primary-color)"},onClick:e=>{}},"添加成员",8,Pe)):(p(),b(w,{key:2,placement:"topLeft"},D({default:g((()=>[_(" "+f(s),1)])),_:2},[(null==s?void 0:s.length)>15?{name:"title",fn:g((()=>[_(f(s),1)])),key:"0"}:void 0]),1024))])),_:1},8,["columns","dataSource","totals"])])]),k(" 新增权限弹框 "),y(N,{class:"jurisdiction-form",visible:A.visible,"onUpdate:visible":s[10]||(s[10]=e=>A.visible=e),title:A.addTitle,maskClosable:!1,onOk:Ze},{default:g((()=>[y(C,R({layout:"vertical",model:L(K)},a.formItemLayout,{ref_key:"jurisdictionRef",ref:P,rules:Qe}),{default:g((()=>[y(F,{label:"权限组名称：",name:"jurisdictionName"},{default:g((()=>[y(c,{value:L(K).jurisdictionName,"onUpdate:value":s[3]||(s[3]=e=>L(K).jurisdictionName=e),placeholder:"请输入权限组名称",maxlength:"20",allowClear:""},null,8,["value"])])),_:1}),y(F,{label:"权限成员：",name:"memberName"},{default:g((()=>[y(c,{value:L(K).memberName,"onUpdate:value":s[4]||(s[4]=e=>L(K).memberName=e),readonly:"",placeholder:"请选择",onClick:Ke},null,8,["value"])])),_:1}),A.isOperate?(p(),b(F,{key:0,label:"功能权限："},{default:g((()=>[y(M,{ref:"authornumRef",class:"author-num",jurisdictionList:A.jurisdictionList,olData:A.jurisdictionList,checkedLists:A.jurisdictionForm.functionPlainOptions,authority:!0,olCheckedList:A.olCheckedList,value:A.jurisdictionForm.functionPlainOptions,"onUpdate:value":s[5]||(s[5]=e=>A.jurisdictionForm.functionPlainOptions=e)},null,8,["jurisdictionList","olData","checkedLists","olCheckedList","value"]),k(' @permissionSetting="getMenuList" ')])),_:1})):k("v-if",!0),1==A.showDataScope||0==A.showDataScope?(p(),b(F,{key:1,label:"权限范围：",style:{"margin-bottom":"0"}},{default:g((()=>[0==A.showDataScope||1==A.showDataScope?(p(),u("div",Te,[Ue,y(h,{value:L(K).defaultRange1,"onUpdate:value":s[6]||(s[6]=e=>L(K).defaultRange1=e),options:L(W),onChange:it},null,8,["value","options"])])):k("v-if",!0)])),_:1})):k("v-if",!0),"2"==L(K).defaultRange1&&3!=A.showDataScope?(p(),b(F,{key:2,name:"department"},{default:g((()=>[y(c,{style:{"margin-top":"15px"},value:L(K).department,"onUpdate:value":s[7]||(s[7]=e=>L(K).department=e),placeholder:"请选择部门范围",onClick:We,readonly:"readonly"},null,8,["value"])])),_:1})):k("v-if",!0),3!=A.showDataScope?(p(),b(F,{key:3,style:{"margin-bottom":"0"}},{default:g((()=>[0==A.showDataScope||2==A.showDataScope?(p(),u("div",Ae,[He,y(h,{value:L(K).defaultRange2,"onUpdate:value":s[8]||(s[8]=e=>L(K).defaultRange2=e),options:L(V),onChange:ot},null,8,["value","options"])])):k("v-if",!0)])),_:1})):k("v-if",!0),"2"==L(K).defaultRange2&&3!=A.showDataScope?(p(),b(F,{key:4,name:"student"},{default:g((()=>[y(c,{style:{"margin-top":"15px"},value:L(K).student,"onUpdate:value":s[9]||(s[9]=e=>L(K).student=e),placeholder:"请选择学籍范围",onClick:Ve,readonly:"readonly"},null,8,["value"])])),_:1})):k("v-if",!0)])),_:1},16,["model","rules"])])),_:1},8,["visible","title"]),k(" 选择应用可见范围 "),y(L(i),{mode:"personnel",tabs:0==A.showScope?[{tab:"教职工",key:1,checked:!0},{tab:"学生组",key:2,checked:!1}]:[{tab:"教职工",key:1,checked:!0}],visible:L(X),"onUpdate:visible":s[11]||(s[11]=e=>O(X)?X.value=e:null),checked:L(te),"onUpdate:checked":s[12]||(s[12]=e=>O(te)?te.value=e:null),onHandleOk:qe},null,8,["tabs","visible","checked"]),y(L(i),{mode:A.selectMultiple,tabs:[{tab:"教职工",key:1,checked:!0},{tab:"角色",key:2,checked:!1}],visible:L(Y),"onUpdate:visible":s[13]||(s[13]=e=>O(Y)?Y.value=e:null),checked:L(ae),"onUpdate:checked":s[14]||(s[14]=e=>O(ae)?ae.value=e:null),treeData:A.selectTreeData,onHandleOk:Me,onEmitChangeTabs:Je},null,8,["mode","visible","checked","treeData"]),k(" 选择部门范围 "),y(L(i),{mode:"depa",tabs:[{tab:"教职工部门",key:1,checked:!0}],visible:L(Z),"onUpdate:visible":s[15]||(s[15]=e=>O(Z)?Z.value=e:null),checked:L(se),"onUpdate:checked":s[16]||(s[16]=e=>O(se)?se.value=e:null),onHandleOk:Ge},null,8,["visible","checked"]),k(" 选择学籍范围 "),y(L(i),{mode:"depa",tabs:[{tab:"学籍部门",key:2,checked:!0}],visible:L(ee),"onUpdate:visible":s[17]||(s[17]=e=>O(ee)?ee.value=e:null),checked:L(ie),"onUpdate:checked":s[18]||(s[18]=e=>O(ie)?ie.value=e:null),onHandleOk:ze},null,8,["visible","checked"])])}}},[["__scopeId","data-v-112c7dee"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/list/setup.vue"]]);const Ee=e=>(N("data-v-6a677cde"),e=e(),P(),e),qe={class:"apply_container"},Me=Ee((()=>v("span",{class:"apply_handle_item"},"进 入",-1))),Ge=Ee((()=>v("span",{class:"apply_handle_item"},"配 置",-1))),ze=Ee((()=>v("span",{class:"apply_handle_item"},"停 用",-1)));var Be=a({__name:"index",setup(e){const a=E(),s=$(),i=z(),[m,h]=[0,1],v=c((()=>i.state.user.currentSchool)),f=c((()=>{var e;return null==(e=i.state.base.userInfo)?void 0:e.identityUserId})),j=d({spinning:!1,isSetup:!1,applyGroupList:[],appId:null});function I(){var e;n({url:o.appCenterList,method:"get",params:e}).then((({data:e})=>{j.applyGroupList=e||[]})).catch((e=>{t.error(e.data.message||e.message)})).finally((()=>{j.spinning=!1}))}function S(e){if("worktable"===e.code){const e=l.get("Access-Token");return window.open(`${{}.VITE_BASE_API_WORKTABLE}?token=Bearer ${e}`),!1}const{id:i,isOwn:o,types:d,status:c,routePath:r,routeParam:p,subAppType:u,isSystemApp:m}=e;if(c===h)return!1;if(o)if(!u&&d.map(Number).includes(1))try{const e={id:p||i,source:s.name,isOwn:o?1:0,isSystemApp:m};a.push({name:m?"schoolAttendanceSystem":r,query:e})}catch(g){a.push({path:"/noauth401"})}else 2===u?a.push({name:"patrol",query:{codeId:p,source:s.name,isOwn:o?1:0}}):t.error("该应用暂未开放平台版");else{const e={appId:i,userId:f.value,schoolId:v.value.id};(y=e,n({url:"/open/app/login/web",method:"post",data:y})).then((e=>{const t=e.data.url;window.open(t)})).finally((()=>{}))}var y}function w({id:e}){var a;j.spinning=!0,(a={appId:e},n({url:o.appCenterUpdateById,method:"post",data:a})).then((e=>{t.success(e.message),I()})).catch((e=>{t.error(e.data.message||e.message)})).finally((()=>{j.spinning=!1}))}function F(){x(!1),I()}function x(e,t,s,i){j.isSetup=e,t&&(j.appId=t),a.push({path:a.currentRoute.value.path,query:{code:t,codes:s,mode:e?1:0,isOwn:i?1:0}})}return C((()=>{const{code:e,mode:t}=a.currentRoute.value.query;j.isSetup=!!Number.parseInt(t),j.appId=e,I()})),(e,t)=>{const a=r("a-button"),s=r("ellipsis-outlined"),i=r("a-menu-item"),o=r("Authorized"),n=r("a-menu"),l=r("a-dropdown"),d=r("a-empty"),c=r("a-spin"),v=U("auth");return p(),u("div",qe,[y(c,{spinning:j.spinning},{default:g((()=>[A(y(ie,{data:j.applyGroupList,onHandleClick:S},{apply:g((({apply:e})=>[k(" status=1 已停用 "),e.status==L(h)?A((p(),b(a,{key:0,type:"link",shape:"round",class:"enable",size:"small",onClick:t=>w(e)},{default:g((()=>[_("启用")])),_:2},1032,["onClick"])),[[v,"setup"]]):k("v-if",!0),k(" 3.0 通过权限来控制显示  v-auth=\"'setup'\" "),y(l,{trigger:["hover"]},{overlay:g((()=>[y(n,null,{default:g((()=>[y(i,{key:"0",onClick:t=>S(e)},{default:g((()=>[Me])),_:2},1032,["onClick"]),(p(),b(o,{auth:"setup",key:e.id},{default:g((()=>[y(i,{key:"1",onClick:t=>function(e){const{id:t,code:a,isOwn:s}=e;x(!0,t,a,s)}(e)},{default:g((()=>[Ge])),_:2},1032,["onClick"])])),_:2},1024)),(p(),b(o,{auth:"setup",key:e.id},{default:g((()=>[y(i,{key:"2",onClick:t=>w(e)},{default:g((()=>[ze])),_:2},1032,["onClick"])])),_:2},1024))])),_:2},1024)])),default:g((()=>[e.status==L(m)?A((p(),b(s,{key:0,class:"apply_hanle__icon"},null,512)),[[v,"setup"]]):k("v-if",!0)])),_:2},1024)])),_:1},8,["data"]),[[H,!j.isSetup]]),A(y(d,{image:"/image/empty.png"},null,512),[[H,!j.applyGroupList.length&&!j.isSetup]]),k(" 配置 "),y(o,{auth:"setup"},{default:g((()=>[j.isSetup?(p(),b($e,{key:0,class:"apply_setup",appId:j.appId,onBack:F},null,8,["appId"])):k("v-if",!0)])),_:1})])),_:1},8,["spinning"])])}}},[["__scopeId","data-v-6a677cde"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/list/index.vue"]]);export{Be as default};
