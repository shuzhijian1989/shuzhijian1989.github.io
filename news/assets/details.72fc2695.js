import"./vue.a2f518ee.js";import{u as e,a as t}from"./vue-router.907b547c.js";import{f as a,h as s,i as l,j as i}from"./punchTheClock.f98483ac.js";import{_ as o,ci as n,cj as r}from"./index.7061e8ea.js";import{_ as c}from"./index.272083a4.js";import{i as d}from"./echarts.98c571ef.js";import{e as p,q as u,r as m,f as h,w as g,o as y,a as v,y as f,b8 as S,a2 as b,a3 as D,c as x,b as j,u as w,a7 as k,O as C,F as _,a8 as I,a9 as L,H as E,aK as P,L as O,n as T,b5 as N,b4 as F}from"./@vue.919ff404.js";import{c as z}from"./punchClockStor.44359efe.js";import{u as A}from"./vuex.f308ecec.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./zrender.0d3f29fc.js";import"./FilterDropdown.5a779a00.js";const R=["id"];var V=o(p({__name:"wholeSchoolEchart",props:{parmasEchart:{type:Object,default:()=>({status:"class",title:"全校年级总打卡数据",name:"全校年级统计"})}},emits:["emitDepartmentEchart"],setup(e,{expose:t,emit:a}){const s=e,l=u({color33:"#333333",colorFFF:"#ffffff",color:"#283b56",colord9:"#d9d9d9",color6FF:"#CCF1E6FF",color4FF:"#FAAD14FF",color0d9:"#000000D9"}),i=m({echartShadow:!1,xAxisSignDateList:[],seriesDetailSum:[],seriesChildren:[{name:"三年级2班",type:"line",label:{show:!0,position:"top",color:""},itemStyle:{color:""},cursor:"pointer",data:[]},{name:"七年级1",type:"line",label:{show:!0,position:"top",color:""},itemStyle:{color:""},cursor:"pointer",data:[]}]});let o;return h((()=>{window.addEventListener("resize",(()=>{o&&o.resize()}))})),t({parentValueObj:i}),g((()=>i.value.echartShadow),(e=>{e&&(()=>{const e=document.getElementById(`wholeSchoolGrade${s.parmasEchart.status}`);let t;o=d(e,null,{width:"auto",height:410}),t={title:{text:s.parmasEchart.title,left:30,height:400,textStyle:{fontSize:16}},tooltip:{backgroundColor:l.color0d9,borderColor:"rgba(0, 0, 0, 0.75)",borderWidth:1,textStyle:{color:l.colorFFF}},legend:{type:"scroll",show:!0,left:80,top:25},toolbox:{show:!1,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},dataZoom:[{show:!1,height:10,start:0,end:100}],xAxis:[{type:"category",axisLine:{show:!1,lineStyle:{color:l.colord9}},data:i.value.xAxisSignDateList},{type:"category",name:"日期",position:"bottom",axisLine:{show:!1,lineStyle:{color:l.colord9}},nameTextStyle:{verticalAlign:"top"},data:i.value.xAxisSignDateList}],yAxis:[{type:"value",name:"",position:"left",alignTicks:!0,max:1e3,min:0,axisLine:{show:!0,lineStyle:{color:l.colord9}}},{type:"value",name:"人数",position:"left",max:1e3,min:0,axisLine:{lineStyle:{color:l.colord9}},nameTextStyle:{align:"right"}}],series:[{name:s.parmasEchart.name,type:"bar",datasetIndex:3,xAxisIndex:1,yAxisIndex:1,barMaxWidth:30,labelLine:{show:!1},label:{show:!0,position:["15%","8%"],color:l.color33},itemStyle:{color:l.color6FF},cursor:"pointer",data:i.value.seriesDetailSum},...i.value.seriesChildren]},o.on("click",(e=>{a("emitDepartmentEchart",s.parmasEchart.status,e)})),t&&o.setOption(t)})()})),(t,a)=>(y(),v("div",{id:`wholeSchoolGrade${e.parmasEchart.status}`,class:"echart-shadow"},null,8,R))}}),[["__scopeId","data-v-233a7092"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/views/punchTheClock/wholeSchoolEchart.vue"]]);const $=e=>(N("data-v-52ce04d0"),e=e(),F(),e),q=$((()=>j("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),U={key:0},K={class:"cycle-day"},M={key:1},G={key:2},J={key:3},W={class:"select-options"},B=$((()=>j("span",{class:"echart-lable"},"年级",-1))),H={key:0},Z={class:"preview-item"},Q={class:"select-options"},X=$((()=>j("span",{class:"echart-lable"},"部门",-1))),Y={key:0},ee={class:"preview-item"};var te=o(p({__name:"details",setup(o){A();const d=e(),p=t(),g=m(z.detailList),N=m(null),F=m(),R=m(),$=u({signDepDate:"",signRollDate:"",statisticsDeptId:"",statisticsRollId:[],isStudent:!1,isDept:null,spinning:!1,isEchartClass:!0,isEchartDept:!0,fieldNames:{label:"label",value:"value",children:"children"},studentSelect:[],studentOption:[],departmentOption:[],departmenTSelect:"-1",classPagination:{pageNo:1,pageSize:10,total:0},classParentValue:{xAxisSignDateList:[],seriesDetailSum:[],seriesChildren:[]},deptPagination:{pageNo:1,pageSize:10,total:0},deptParentValue:{xAxisSignDateList:[],seriesDetailSum:[],seriesChildren:[]},columnsClass:z.detailColumnsClass,columnsDept:z.detailColumnsDept,spinLoad:!1}),te=m([]),ae=m([]);m(!1);const se=(e,t)=>{const{classPage:a,deptPage:s,attendanceSignTaskReportDetail:l,classDetailSum:i,classDetail:o,deptDetailSum:n,deptDetail:r,signDateList:c,statisticsDeptId:d,statisticsRollId:p}=e;N.value=l,"class"===t?(te.value=a.list,$.classPagination.pageNo=a.pageNo,$.classPagination.pageSize=a.pageSize,$.classPagination.total=a.total,$.statisticsRollId=p,F.value.parentValueObj.seriesChildren=o.map((e=>{const t=z.detailColor();return{name:e.rollName,type:"line",label:{show:!0,position:"top",color:t},itemStyle:{color:t},cursor:"pointer",data:e.personCountList}})),F.value.parentValueObj.xAxisSignDateList=c,F.value.parentValueObj.seriesDetailSum=i,F.value.parentValueObj.echartShadow=!0):(ae.value=s.list,$.deptPagination.pageNo=s.pageNo,$.deptPagination.pageSize=s.pageSize,$.deptPagination.total=s.total,$.statisticsDeptId=d,R.value.parentValueObj.seriesChildren=r.map((e=>{const t=z.detailColor();return{name:e.deptName,type:"line",label:{show:!0,position:"top",color:t},itemStyle:{color:t},cursor:"pointer",data:e.personCountList}})),R.value.parentValueObj.xAxisSignDateList=c,R.value.parentValueObj.seriesDetailSum=n,R.value.parentValueObj.echartShadow=!0)},le=(e,t)=>{const{total:a,pageSize:s,current:l}=e;$[`${t}Pagination`].pageNo=l,$[`${t}Pagination`].pageSize=s,$[`${t}Pagination`].total=a,ie(t)},ie=(e,t)=>{var s,l;const{signTaskId:i}=p.query;let o="";const n={identity:e,signTaskId:i,...$[`${e}Pagination`]};"class"===e?(t&&(o=t.name,$.signRollDate=t.name),n.signDate=o||$.signRollDate,1==(null==(s=$.studentSelect)?void 0:s.length)&&(n.statisticsRollId=$.statisticsRollId[0]),(null==(l=$.studentSelect)?void 0:l.length)>1&&(n.statisticsRollId=$.statisticsRollId[1])):(t&&(o=t.name,$.signDepDate=t.name),n.signDate=o||$.signDepDate,n.statisticsDeptId=$.statisticsDeptId),a(n).then((({data:t})=>{const{list:a,pageNo:s,pageSize:l,total:i}=t;"class"===e?te.value=a:ae.value=a,$[`${e}Pagination`].pageNo=s,$[`${e}Pagination`].pageSize=l,$[`${e}Pagination`].total=i}))},oe=(e,t)=>{var a,s;let o=l;const{signTaskId:n}=p.query,r={signTaskId:n,...$[`${e}Pagination`]};if("deptPagination"==`${e}Pagination`)$.departmenTSelect,r.deptId=$.departmenTSelect,o=i;else{let e="";1==(null==(a=$.studentSelect)?void 0:a.length)&&(e=$.studentSelect[0]),(null==(s=$.studentSelect)?void 0:s.length)>1&&(e=$.studentSelect[1]),r.rollId=e}$.spinning=!0,o(r).then((({data:t})=>{$.isEchartClass=!0,$.isEchartDept=!0,T((()=>{se(t,e)}))})).finally((()=>$.spinning=!1))},ne=(e,t,a,s)=>{e.forEach((e=>{var l;if(t.includes(e.type)){const t=JSON.parse(JSON.stringify(e)),l=a.findIndex((t=>t.id==e.pid));t.children=[],s==e.type&&($.isStudent=!0),-1!==l?a[l].children.push(t):a.push(t)}(null==(l=e.children)?void 0:l.length)&&ne(e.children,t,a,s)}))},re=async()=>{await n("punchTheClock").then((({data:e})=>{const t=[];e.length&&ne(e,[2,3],t,3),$.studentSelect=["-1"],$.studentOption=[{showName:"全部年级",id:"-1"},...t]})),await r("punchTheClock").then((({data:e})=>{e.length&&($.departmentOption=[...e,...e[0].children],$.isDept=1==new Array(e[0].ancestors).length&&e[0].children.length)})),$.isDept&&$.isStudent?T((()=>(async()=>{const{signTaskId:e}=p.query;$.spinning=!0,await s({signTaskId:e}).then((e=>{$.isEchartDept=!0,$.isEchartClass=!0,T((()=>{se(e.data,"class"),se(e.data,"dept")}))})).finally((()=>$.spinning=!1))})())):($.isDept&&oe("dept"),$.isStudent&&oe("class"))},ce=f((()=>e=>e.map((e=>e.name)).toString()||"--"));return h((()=>{re()})),(e,t)=>{const a=S("a-layout-header"),s=S("a-typography-title"),l=S("a-typography-text"),i=S("a-layout-sider"),o=S("a-cascader"),n=S("a-image"),r=S("a-image-preview-group"),p=S("a-tooltip"),u=S("a-col"),m=S("a-select-option"),h=S("a-select"),f=S("a-row"),T=S("a-spin"),z=S("a-layout-content"),A=S("a-layout");return y(),b(A,{class:"details-clock-layout yd-layout"},{default:D((()=>[x(a,{class:"yd-layout-header"},{default:D((()=>[j("span",{onClick:t[0]||(t[0]=e=>w(d).back(-1))},[k(' <arrow-left-outlined class="left-outlined" /> '),q,C("任务详情 ")])])),_:1}),x(A,{class:"yd-layout-content",style:{padding:"0"}},{default:D((()=>[x(i,{width:"306px",style:{padding:"22px 16px"}},{default:D((()=>[N.value?(y(),v(_,{key:0},[x(s,{level:5},{default:D((()=>[(y(!0),v(_,null,I(N.value.subjectList,((e,t)=>(y(),v("span",{class:"subject-details",key:t},L(e),1)))),128)),C(" "+L(N.value.taskName),1)])),_:1}),x(l,{style:{margin:"16px 0",display:"block"}},{default:D((()=>[C(L(N.value.taskDescription),1)])),_:1}),(y(!0),v(_,null,I(g.value,((e,t)=>(y(),v("div",{class:"detail-item",key:t},[j("span",null,L(e.label)+"：",1),"cycleTotalDay"==e.value?(y(),v("b",U,[C(" 第 "),j("span",K,L(N.value.cycleNowDay),1),C(" /"+L(N.value.cycleTotalDay)+"天 ",1)])):"publishScopeObjList"==e.value?(y(),v("b",M,L(ce.value(N.value[e.value])),1)):"requirementList"==e.value?(y(),v("b",G,L(N.value[e.value].toString()||"无"),1)):(y(),v("b",J,L(N.value[e.value]||"无"),1))])))),128))],64)):k("v-if",!0)])),_:1}),x(z,{class:"yd-layout-content"},{default:D((()=>[x(T,{spinning:$.spinning},{default:D((()=>[x(f,{gutter:16},{default:D((()=>[E(x(u,{span:$.isStudent&&$.isDept?12:24},{default:D((()=>[j("div",W,[B,x(o,{placeholder:"请选择",value:$.studentSelect,"onUpdate:value":t[1]||(t[1]=e=>$.studentSelect=e),options:$.studentOption,fieldNames:{label:"showName",value:"id"},onChange:t[2]||(t[2]=e=>{$.isEchartClass=!1,oe("class")})},null,8,["value","options"])]),$.isEchartClass?(y(),b(V,{key:0,parmasEchart:{status:"class",title:"全校年级总打卡数据",name:"全校年级统计"},ref_key:"classParentRef",ref:F,onEmitDepartmentEchart:ie},null,512)):k("v-if",!0),x(c,{columns:$.columnsClass,dataSource:te.value,spinLoad:$.spinLoad,totals:$.classPagination,rowSelection:!1,onOnSelectedRowKeys:t[3]||(t[3]=e=>le(e,"class"))},{headerCell:D((({column:e,text:t,record:a})=>["deptName"===e.dataIndex?(y(),v("i",H)):k("v-if",!0)])),bodyCell:D((({column:e,text:t,record:a})=>["pictureList"===e.dataIndex?(y(),v(_,{key:0},[t.length?(y(),v(_,{key:0},[j("div",Z,[x(r,null,{default:D((()=>[(y(!0),v(_,null,I(t,(e=>(y(),b(n,{key:e,src:e},null,8,["src"])))),128))])),_:2},1024)]),x(n,{preview:!1,width:126,height:70,src:t[0]},null,8,["src"])],64)):(y(),v(_,{key:1},[C("--")],64))],64)):(y(),b(p,{key:1,placement:"topLeft"},P({default:D((()=>[j("span",null,L(t),1)])),_:2},[(null==t?void 0:t.length)>8?{name:"title",fn:D((()=>[C(L(t),1)])),key:"0"}:void 0]),1024))])),_:1},8,["columns","dataSource","spinLoad","totals"])])),_:1},8,["span"]),[[O,$.isStudent]]),E(x(u,{span:$.isStudent&&$.isDept?12:24},{default:D((()=>[j("div",Q,[X,x(h,{style:{width:"200px"},value:$.departmenTSelect,"onUpdate:value":t[4]||(t[4]=e=>$.departmenTSelect=e),placeholder:"请选择",onChange:t[5]||(t[5]=e=>{$.isEchartDept=!1,oe("dept")})},{default:D((()=>[x(m,{value:"-1"},{default:D((()=>[C("全部部门")])),_:1}),(y(!0),v(_,null,I($.departmentOption,(e=>(y(),b(m,{key:e.id,value:e.id},{default:D((()=>[C(L(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])]),$.isEchartDept?(y(),b(V,{key:0,ref_key:"deptParentRef",ref:R,parmasEchart:{status:"dept",title:"全校部门总打卡数据",name:"全校部门统计"},parentValue:$.deptParentValue,onEmitDepartmentEchart:ie},null,8,["parentValue"])):k("v-if",!0),x(c,{columns:$.columnsDept,dataSource:ae.value,totals:$.deptPagination,spinLoad:$.spinLoad,rowSelection:!1,onOnSelectedRowKeys:t[6]||(t[6]=e=>le(e,"dept"))},{headerCell:D((({column:e,text:t})=>["className"===e.dataIndex?(y(),v("span",Y,L(t),1)):k("v-if",!0)])),bodyCell:D((({column:e,text:t})=>["pictureList"===e.dataIndex?(y(),v(_,{key:0},[t.length?(y(),v(_,{key:0},[j("div",ee,[x(r,null,{default:D((()=>[(y(!0),v(_,null,I(t,(e=>(y(),b(n,{key:e,src:e},null,8,["src"])))),128))])),_:2},1024)]),x(n,{preview:!1,width:126,height:70,src:t[0]},null,8,["src"])],64)):(y(),v(_,{key:1},[C("--")],64))],64)):(y(),b(p,{key:1,placement:"topLeft"},P({default:D((()=>[j("span",null,L(t),1)])),_:2},[(null==t?void 0:t.length)>8?{name:"title",fn:D((()=>[C(L(t),1)])),key:"0"}:void 0]),1024))])),_:1},8,["columns","dataSource","totals","spinLoad"])])),_:1},8,["span"]),[[O,$.isDept]])])),_:1})])),_:1},8,["spinning"])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-52ce04d0"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/views/punchTheClock/details.vue"]]);export{te as default};
