import{_ as e,H as a,p as l,X as t,u as s,be as i,b1 as o}from"./index.7061e8ea.js";import"./vue.a2f518ee.js";import{a as n,M as r,m as c}from"./ant-design-vue.db4d48e3.js";import{a as d,u}from"./vue-router.907b547c.js";import{a as p,c as m,b as v,d as y,e as f,f as g,g as b,h,i as k,j as _,k as I,l as x,q as w,m as F,n as C}from"./patrol.d6c87ea2.js";import{q as D,y as T,w as S,b8 as L,o as U,a as M,c as j,a3 as q,b as E,a9 as O,O as P,a2 as N,a7 as R,b5 as V,b4 as z,F as A,a8 as J,a4 as B,a5 as H,r as K,Q as $,u as Y,a1 as W,f as Q,M as X,H as G,L as Z,a6 as ee,R as ae}from"./@vue.919ff404.js";import{d as le}from"./dayjs.49e29cb2.js";import{E as te}from"./@ant-design.2e172c39.js";import{_ as se}from"./index.272083a4.js";import{C as ie}from"./index.2069fba3.js";import{D as oe}from"./vuedraggable.644046ad.js";import{u as ne}from"./vuex.f308ecec.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./@babel.6d5f88cb.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";import"./cropperjs.fe6d04b8.js";import"./sortablejs.db2d7738.js";const re=e=>(V("data-v-916cea6c"),e=e(),z(),e),ce={class:"info_class"},de={class:"form_item",style:{margin:"0px"}},ue=re((()=>E("span",{class:"left"},"任务类型：",-1))),pe={class:"right"},me={class:"form_item"},ve=re((()=>E("span",{class:"left"},"计划名称：",-1))),ye={class:"right"},fe={class:"form_item"},ge=re((()=>E("span",{class:"left"},"创建时间：",-1))),be={class:"right"},he={class:"form_item"},ke=re((()=>E("span",{class:"left"},"更新时间：",-1))),_e={class:"right"},Ie={class:"form_item"},xe=re((()=>E("span",{class:"left"},"巡查地点：",-1))),we={class:"right"},Fe={class:"form_item"},Ce=re((()=>E("span",{class:"left"},"执行人员：",-1))),De={class:"right"},Te={class:"form_item"},Se=re((()=>E("span",{class:"left"},"计划负责人：",-1))),Le={class:"right"},Ue=re((()=>E("div",{class:"title_box"},"任务周期设置",-1))),Me={class:"form_item"},je=re((()=>E("span",{class:"left"},"是否周期任务：",-1))),qe={class:"right"},Ee=re((()=>E("div",{class:"tips_class"}," 单次任务会在创建计划后，立即生成巡查任务 ",-1))),Oe={class:"form_item"},Pe=re((()=>E("span",{class:"left"},"巡查日期：",-1))),Ne={class:"right"},Re={class:"form_item"},Ve=re((()=>E("span",{class:"left"},"任务时间：",-1))),ze={class:"right"},Ae=re((()=>E("div",{class:"tips_class"}," 注意：每一个任务时间将单独指派一个巡查任务，若当天仅需要执行一次任务，则只需要添加一个时间。 ",-1))),Je=re((()=>E("div",{class:"title_box"},"任务执行设置",-1))),Be={class:"form_item"},He=re((()=>E("span",{class:"left"},"任务时限：",-1))),Ke={class:"right"},$e={class:"form_item"},Ye=re((()=>E("span",{class:"left"},"是否需要提交反馈表单：",-1))),We={class:"right"},Qe={class:"form_item"},Xe=re((()=>E("span",{class:"left"},"打卡限制：",-1))),Ge={class:"right"},Ze=re((()=>E("div",{class:"tips_class"}," 需要前往场地现场完成巡查任务（如：在班牌提交反馈、App扫场地二维码完成反馈） ",-1)));var ea=e({__name:"planInfo",props:{planInfoVisible:{type:Boolean,default:!1},planInfoModelId:{type:String,default:""}},emits:["update:planInfoVisible","emitViewFormat"],setup(e,{emit:a}){const l=e,t=D({weeks:["","一","二","三","四","五","六","天"],cycleFrequency:{1:"每日",2:"每周",3:"每月",4:"每年"},taskLimitDesc:{1:"分钟",2:"小时",3:"天"},form:{needForm:!1,name:"",patrolTypeName:"",formJson:"",checkinLimit:1,taskLimit:5,taskLimitDesc:2,managers:[],sites:[],users:[],times:[],dates:[]}}),s=T((()=>(e,a)=>{const l=t.form[e].map((l=>"dates"===e?2===t.form.cycleFrequency?`星期${t.weeks[l[a]]}`:3===t.form.cycleFrequency?`${l[a]}日`:l[a]:l[a]));return(null==l?void 0:l.length)?l.join("、"):"managers"===e?"仅管理员":"--"}));return S((()=>l.planInfoVisible),(e=>{e&&l.planInfoModelId&&(()=>{const e={id:l.planInfoModelId};p(e).then((({data:e})=>{t.form={...e}}))})()})),(e,i)=>{const o=L("right-outlined"),n=L("a-button"),r=L("a-form"),c=L("a-modal");return U(),M("div",ce,[j(c,{visible:l.planInfoVisible,"onUpdate:visible":i[1]||(i[1]=e=>l.planInfoVisible=e),title:"巡场计划详情",onCancel:i[2]||(i[2]=e=>a("update:planInfoVisible")),width:800,footer:!1,class:"model_class",zIndex:999},{default:q((()=>[j(r,{layout:"horizontal",model:t.form,class:"form_class"},{default:q((()=>[E("div",de,[ue,E("span",pe,O(t.form.patrolTypeName),1)]),E("div",me,[ve,E("span",ye,O(t.form.name),1)]),E("div",fe,[ge,E("span",be,O(t.form.createTime),1)]),E("div",he,[ke,E("span",_e,O(t.form.updateTime),1)]),E("div",Ie,[xe,E("span",we,O(s.value("sites","businessName")),1)]),E("div",Fe,[Ce,E("span",De,O(s.value("users","businessName")),1)]),E("div",Te,[Se,E("span",Le,O(s.value("managers","userName")),1)]),Ue,E("div",Me,[je,E("span",qe,O(t.form.isCycle?"周期":"单次"),1)]),Ee,E("div",Oe,[Pe,E("span",Ne,O(s.value("dates","patrolDate")),1)]),E("div",Re,[Ve,E("span",ze,O(s.value("times","taskTime")),1)]),Ae,Je,E("div",Be,[He,E("span",Ke,O(t.form.taskLimit)+" "+O(t.taskLimitDesc[t.form.taskLimitDesc]),1)]),E("div",$e,[Ye,E("span",We,[P(O(t.form.needForm?"需要":"不需要")+" ",1),t.form.needForm?(U(),N(n,{key:0,type:"link",class:"button-link",onClick:i[0]||(i[0]=e=>a("emitViewFormat"))},{default:q((()=>[P(" 查看格式 "),j(o)])),_:1})):R("v-if",!0)])]),E("div",Qe,[Xe,E("span",Ge,O(1==t.form.checkinLimit?"现场打卡":"不限制"),1)]),Ze])),_:1},8,["model"])])),_:1},8,["visible"])])}}},[["__scopeId","data-v-916cea6c"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/planInfo.vue"]]);const aa={class:"yd_select_box"},la=["onClick"],ta={class:"yd_top"},sa={key:0,class:"yd_msg_box"},ia={key:1,class:"yd_subscript",src:"/image/subscript.png"};var oa=e({__name:"selectBtn",props:{list:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},disableds:{type:Boolean,default:!1},value:{type:[String,Array,Boolean,Number],default:""}},emits:["update:value","handleClick"],setup(e,{emit:a}){const l=e,t=T((()=>e=>"object"==typeof l.value?l.value.includes(e):l.value===e)),s=e=>{l.disableds||(l.multiple?(e.checked=!e.checked,a("update:value",l.list.filter((e=>e.checked)).map((e=>e.value)))):(l.list.forEach((e=>e.checked=!1)),e.checked=!e.checked,a("update:value",e.value)),a("handleClick",e))};return(a,i)=>(U(),M("div",aa,[(U(!0),M(A,null,J(e.list,((e,a)=>(U(),M("div",{class:B(["yd_select",{active_class:t.value(e.value),disabled_active:l.disableds}]),style:H({width:e.width||"265px"}),key:a,onClick:a=>s(e)},[E("div",ta,O(e.label),1),e.msg?(U(),M("div",sa,O(e.msg),1)):R("v-if",!0),t.value(e.value)?(U(),M("img",ia)):R("v-if",!0)],14,la)))),128))]))}},[["__scopeId","data-v-9ec91506"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/selectBtn.vue"]]);const na={class:"yd_task_time_box"};var ra=e({__name:"changeTaskTime",props:{list:{type:Array,default:()=>[]},flag:{type:String,default:"time"}},setup(e){const a=e,l=e=>e&&e<le(new Date).startOf("day"),t=()=>{a.list.push({value:""})};return(s,i)=>{const o=L("a-time-picker"),n=L("a-date-picker"),r=L("close-outlined"),c=L("plus-outlined"),d=L("a-button");return U(),M(A,null,[E("div",na,[(U(!0),M(A,null,J(e.list,((t,s)=>(U(),M("div",{key:s,class:"yd_time_box"},["time"===e.flag?(U(),N(o,{key:0,value:t.value,"onUpdate:value":e=>t.value=e,format:"HH:mm","value-format":"HH:mm",disabledDate:l},null,8,["value","onUpdate:value"])):R("v-if",!0),"date"===e.flag?(U(),N(n,{key:1,value:t.value,"onUpdate:value":e=>t.value=e,format:"MM月/DD日","value-format":"MM-DD",disabledDate:l},null,8,["value","onUpdate:value"])):R("v-if",!0),a.list.length>1?(U(),N(r,{key:2,class:"yd_icon",style:{color:"#D9D9D9"},onClick:e=>(e=>{a.list.splice(e,1)})(s),disabledDate:l},null,8,["onClick"])):R("v-if",!0)])))),128))]),E("div",null,[j(d,{type:"primary",onClick:t,disabled:e.list.length>=10},{icon:q((()=>[j(c)])),default:q((()=>[P(" 新增 ")])),_:1},8,["disabled"])])],64)}}},[["__scopeId","data-v-068ae755"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/changeTaskTime.vue"]]);const ca=["一","二","三","四","五","六","天"].map(((e,a)=>({value:a+1,label:`星期${e}`}))),da=[...Array(31)].map(((e,a)=>({value:a+1,label:`${a+1}日`})));const ua={cycleList:[{label:"单次任务",value:!1},{label:"周期任务",value:!0}],frequencyList:[{label:"每日",value:"1",width:"122px"},{label:"每周",value:"2",width:"122px"},{label:"每月",value:"3",width:"122px"},{label:"每年",value:"4",width:"122px"}],ruleList:[{label:"现场打卡",value:"1",msg:"需要前往场地现场完成巡查任务（如：在班牌提交反馈、App扫场地二维码完成反馈）"},{label:"不限制",value:"2",msg:"可通过App、班牌应用直接完成巡查任务"}]};const pa={class:"yd_body_box"},ma={class:"yd_tip_msg"},va={class:"yd_icon"},ya=(e=>(V("data-v-418b8930"),e=e(),z(),e))((()=>E("div",null," 创建计划后无法修改请谨慎选择；创建单次任务的计划后，点击启用计划会立即生成巡查任务；周期任务将于每天0点根据设置频次生成当天任务。 ",-1))),fa={class:"yd_inputNumber"},ga={class:"yd_footer"};var ba=e({__name:"patrolDrawer",emits:["emitCancel"],setup(e,{expose:a,emit:l}){const{formState:t,rules:s,patrolDateList:i,typeList:o}=function(){const e=D({title:"创建巡查计划",isEidt:!1,drawerLoading:!1,id:"",patrolTypeId:"",name:"",isCycle:!1,single:{patrolDate:"",times:[{value:""}]},cycle:{cycleFrequency:"",patrolDates:[],times:[{value:""}]},taskLimit:"",taskLimitDesc:2,checkinLimit:""}),a=T((()=>2==e.cycle.cycleFrequency?ca:3==e.cycle.cycleFrequency?da:void 0)),l=async(e,a)=>{const l=a.filter((e=>e.value));return l.length>0?Promise.resolve():0===l.length?Promise.reject("请设置任务时间"):void 0},t=async(e,a)=>{if(!(a.length>0))return Promise.reject("请选择巡查日期");if("object"!=typeof a[0])return Promise.resolve();{const e=a.filter((e=>e.value));if(e.length>0)return Promise.resolve();if(0===e.length)return Promise.reject("请选择巡查日期")}},s={patrolTypeId:[{required:!0,message:"请选择任务类型"}],name:[{required:!0,message:"请输入计划名称"}],taskLimit:[{required:!0,message:"请填写任务时限"}],isCycle:[{required:!0,message:"请选择周期任务"}],checkinLimit:[{required:!0,message:"请选择执行方式 "}]},i={"single.patrolDate":[{required:!0,message:"请选择巡查日期 "}],"single.times":[{required:!0,validator:l}]},o={"cycle.times":[{required:!0,validator:l}],"cycle.cycleFrequency":[{required:!0,message:"请选择频次 "}]},n=T((()=>!1===e.isCycle?{...s,...i}:(!1===e.cycle.cycleFrequency||(1!=e.cycle.cycleFrequency?o["cycle.patrolDates"]=[{required:!0,validator:t}]:delete o["cycle.patrolDates"]),{...s,...o}))),r=K([{label:"巡逻",value:"1"},{label:"巡课",value:"2"}]);return{formState:e,rules:n,patrolDateList:a,typeList:r}}(),{cycleList:d,ruleList:u,frequencyList:y}=ua,f=n.useForm,{validate:g,validateInfos:b,resetFields:h}=f(t,s),k=e=>{t.cycle.patrolDates=[],4==e.value&&t.cycle.patrolDates.push({value:""})},_=$(!1),I=()=>{if(t.drawerLoading)return h(),_.value=!1,void(t.drawerLoading=!1);r.confirm({title:"提示",icon:j(te),content:"关闭窗口将不会保存此次编辑内容,是否取消?",okText:"确定",cancelText:"取消",onOk(){h(),_.value=!1}})},x=()=>{g().then((()=>{const e=JSON.parse(JSON.stringify(t));e.isCycle?(4==e.cycle.cycleFrequency&&(e.cycle.patrolDates=F(t.cycle.patrolDates)),e.cycle.times=F(t.cycle.times),Object.keys(e.single).forEach((e=>""))):(e.single.times=F(t.single.times),Object.keys(e.cycle).forEach((e=>"")));let a=m;e.id&&(a=v),t.drawerLoading=!0,a(e).then((()=>{c.success("计划创建成功，请补充其他配置项后方可启用计划"),I(),l("emitCancel")})).finally((()=>t.drawerLoading=!1))}))},w=e=>e&&e<le(new Date).startOf("day");function F(e){return e.map((e=>e.value))}return a({showDrawer:async(e,a)=>{o.value=e,t.title="创建巡查计划",t.isEidt=!1,a&&(t.isEidt=!0,t.title="编辑巡查计划",await(async e=>{await p({id:e}).then((({data:e})=>{const{id:a,name:l,dates:s,patrolTypeId:i,isCycle:o,times:n,taskLimit:r,taskLimitDesc:c,checkinLimit:d,cycleFrequency:u}=e;if(t.id=a,t.name=l,t.patrolTypeId=i,t.isCycle=o,o){t.cycle.cycleFrequency=u+"";const e=[];s.forEach((a=>{4!==u?a.patrolDate.includes("}")?e.push(JSON.parse(a.patrolDate)):e.push(a.patrolDate-0):e.push({value:a.patrolDate})})),t.cycle.patrolDates=e,t.cycle.times=n.map((e=>e.taskTime.includes("}")?JSON.parse(e.taskTime):{value:e.taskTime}))}else s.forEach((e=>{t.single.patrolDate=e.patrolDate})),t.single.times=n.map((e=>({value:e.taskTime})));t.taskLimit=r,t.taskLimitDesc=c,t.checkinLimit=d+""}))})(a)),_.value=!0}}),(e,a)=>{const l=L("a-form-item"),s=L("a-input"),n=L("exclamation-circle-outlined"),r=L("a-select"),c=L("a-date-picker"),p=L("a-input-number"),m=L("a-select-option"),v=L("a-form"),f=L("close-outlined"),g=L("a-button"),h=L("a-drawer");return U(),N(h,{class:"yd_drawer_box",title:Y(t).title,placement:"right",closable:!1,visible:_.value,keyboard:!1,maskClosable:!1,destroyOnClose:!0,onClose:I,width:"600"},{extra:q((()=>[j(f,{onClick:I,class:"yd_close"})])),footer:q((()=>[E("div",ga,[j(g,{onClick:I},{default:q((()=>[P("取消")])),_:1}),j(g,{type:"primary",loading:Y(t).drawerLoading,onClick:x},{default:q((()=>[P("保存")])),_:1},8,["loading"])])])),default:q((()=>[E("div",pa,[j(v,W({ref:"formRef",model:Y(t)},{layout:"vertical"}),{default:q((()=>[j(l,W({label:"任务类型"},Y(b).patrolTypeId),{default:q((()=>[j(oa,{list:Y(o),disableds:Y(t).isEidt,value:Y(t).patrolTypeId,"onUpdate:value":a[0]||(a[0]=e=>Y(t).patrolTypeId=e)},null,8,["list","disableds","value"])])),_:1},16),j(l,W({label:"计划名称"},Y(b).name),{default:q((()=>[j(s,{value:Y(t).name,"onUpdate:value":a[1]||(a[1]=e=>Y(t).name=e),maxlength:20,placeholder:"请输入"},null,8,["value"])])),_:1},16),j(l,W({label:"是否周期任务"},Y(b).isCycle),{default:q((()=>[j(oa,{list:Y(d),disableds:Y(t).isEidt,value:Y(t).isCycle,"onUpdate:value":a[2]||(a[2]=e=>Y(t).isCycle=e)},null,8,["list","disableds","value"]),E("div",ma,[E("div",va,[j(n)]),ya])])),_:1},16),R(" 周期任务 "),Y(t).isCycle?(U(),M(A,{key:0},[j(l,W({label:"周期频次"},Y(b)["cycle.cycleFrequency"]),{default:q((()=>[j(oa,{list:Y(y),disableds:Y(t).isEidt,value:Y(t).cycle.cycleFrequency,"onUpdate:value":a[3]||(a[3]=e=>Y(t).cycle.cycleFrequency=e),onHandleClick:k},null,8,["list","disableds","value"])])),_:1},16),Y(t).cycle.cycleFrequency&&1!=Y(t).cycle.cycleFrequency?(U(),N(l,W({key:0,label:"巡查日期"},Y(b)["cycle.patrolDates"]),{default:q((()=>[4==Y(t).cycle.cycleFrequency?(U(),N(ra,{key:0,flag:"date",list:Y(t).cycle.patrolDates},null,8,["list"])):(U(),N(r,{key:1,value:Y(t).cycle.patrolDates,"onUpdate:value":a[4]||(a[4]=e=>Y(t).cycle.patrolDates=e),mode:"multiple",style:{width:"100%"},placeholder:"请选择",options:Y(i)},null,8,["value","options"]))])),_:1},16)):R("v-if",!0),j(l,W({label:"任务时间(最多可设置十个)"},Y(b)["cycle.times"]),{default:q((()=>[j(ra,{flag:"time",list:Y(t).cycle.times},null,8,["list"])])),_:1},16)],64)):(U(),M(A,{key:1},[R(" 单次任务 "),j(l,W({label:"巡查日期"},Y(b)["single.patrolDate"]),{default:q((()=>[j(c,{class:"yd_date_picker",value:Y(t).single.patrolDate,"onUpdate:value":a[5]||(a[5]=e=>Y(t).single.patrolDate=e),"value-format":"YYYY-MM-DD",disabledDate:w},null,8,["value"])])),_:1},16),j(l,W({label:"任务时间(最多可设置十个)"},Y(b)["single.times"]),{default:q((()=>[j(ra,{flag:"time",list:Y(t).single.times},null,8,["list"])])),_:1},16)],64)),j(l,W({label:"任务时限"},Y(b).taskLimit),{default:q((()=>[E("div",fa,[j(p,{value:Y(t).taskLimit,"onUpdate:value":a[6]||(a[6]=e=>Y(t).taskLimit=e),placeholder:"请输入",style:{width:"100%"},min:1},null,8,["value"]),j(r,{ref:"select",value:Y(t).taskLimitDesc,"onUpdate:value":a[7]||(a[7]=e=>Y(t).taskLimitDesc=e),placeholder:"请选择",style:{width:"120px"}},{default:q((()=>[j(m,{value:1},{default:q((()=>[P("分钟")])),_:1}),j(m,{value:2},{default:q((()=>[P("小时")])),_:1}),j(m,{value:3},{default:q((()=>[P("天")])),_:1})])),_:1},8,["value"])])])),_:1},16),j(l,W({label:"打卡限制"},Y(b).checkinLimit),{default:q((()=>[j(oa,{list:Y(u),value:Y(t).checkinLimit,"onUpdate:value":a[8]||(a[8]=e=>Y(t).checkinLimit=e)},null,8,["list","value"])])),_:1},16)])),_:1},16,["model"])])])),_:1},8,["title","visible"])}}},[["__scopeId","data-v-418b8930"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/patrolDrawer.vue"]]);const ha={class:"form_categories_class"};var ka=e({__name:"formCategories",props:{formCategoriesVisible:{type:Boolean,default:!1},editData:{type:Object,default:()=>({isDefault:!1})}},emits:["emitFormCategories","update:formCategoriesVisible"],setup(e,{emit:t}){const s=e,i=$(),o=D({title:"新增巡查分类",visibles:!1,multipleTrue:!0,checkParents:!1,checkedList:[],selectTabs:[{tab:"教职工",key:1,checked:!0}],loading:!1,categoriesForm:{id:"",name:"",logo:"",managersUsers:"",purviewRange:[],managers:[]},fileList:[],percentage:0,rulesList:[{label:"按场地架构",value:"1",width:"230px",checked:!1},{label:"按班级架构",value:"2",width:"230px",checked:!1}]}),n={name:[{required:!0,message:"请输入分类名称",trigger:"change"}],purviewRange:[{required:!0,message:"请选择巡查权限"}],logo:[{required:!0,message:"请上传分类图标"}],managersUsers:[{required:!0,message:"请选择分类管理员",trigger:"click"}]},r=e=>{const a=[];o.checkedList=e,o.categoriesForm.managers=[],e.forEach((e=>{a.push(e.name),o.categoriesForm.managers.push(e.id)})),a.length&&(o.categoriesForm.managersUsers=a.join("、"))},d=()=>{o.visibles=!0},u=e=>{const l=new FormData;l.append("file",e.file),a(l).then((e=>{const{data:a}=e;a.map((e=>o.categoriesForm.logo=e.url))}))},p=()=>{i.value.resetFields(),o.checkedList=[],t("update:formCategoriesVisible",!1)},m=()=>{i.value.validate().then((()=>{o.loading=!0;let e=y;o.categoriesForm.id&&(e=f),e(o.categoriesForm).then((e=>{t("emitFormCategories"),c.success(e.message),p()})).finally((()=>o.loading=!1))}))};return S((()=>o.categoriesForm.purviewRange),(()=>{i.value&&i.value.validateFields("purviewRange")})),S((()=>o.categoriesForm.logo),(()=>{i.value&&i.value.validateFields("logo")})),S((()=>s.formCategoriesVisible),(e=>{if(e)if(s.editData&&Object.keys(s.editData).length){const e=JSON.parse(JSON.stringify(s.editData));o.title="编辑巡查分类";for(const a in o.categoriesForm)if("managers"===a&&e.managers.length){const a=[];e.managers.forEach((e=>{e.name=e.userName,e.id=e.userId,a.push(e.userName),o.categoriesForm.managers.push(e.userId)})),o.checkedList=e.managers,o.categoriesForm.managersUsers=a.join(",")}else"purviewRange"===a&&e.purviewRange.length?(e.purviewRange.forEach((e=>{o.rulesList.forEach((a=>{a.value===e&&(a.checked=!0)}))})),o.categoriesForm[a]=e[a]):o.categoriesForm[a]=e[a]}else o.rulesList=[{label:"按场地架构",value:"1",width:"230px",checked:!1},{label:"按班级架构",value:"2",width:"230px",checked:!1}],o.title="新增巡查分类",o.categoriesForm.id="",o.categoriesForm.name="",o.categoriesForm.logo="",o.categoriesForm.managersUsers="",o.categoriesForm.purviewRange=[],o.categoriesForm.managers=[]})),(e,a)=>{const t=L("a-input"),c=L("a-form-item"),v=L("a-form"),y=L("a-modal"),f=l;return U(),M("div",ha,[j(y,{visible:s.formCategoriesVisible,"onUpdate:visible":a[4]||(a[4]=e=>s.formCategoriesVisible=e),title:o.title,confirmLoading:o.loading,maskClosable:!1,onCancel:p,onOk:m},{default:q((()=>[j(v,{layout:"vertical",model:o.categoriesForm,ref_key:"categoriesFormRef",ref:i,rules:n},{default:q((()=>[j(c,{label:"分类名称：",name:"name"},{default:q((()=>[j(t,{value:o.categoriesForm.name,"onUpdate:value":a[0]||(a[0]=e=>o.categoriesForm.name=e),maxlength:10,showCount:"",disabled:s.editData.isDefault,placeholder:"请输入"},null,8,["value","disabled"])])),_:1}),j(c,{label:"分类图标（此图标用于展示在应用台）：",name:"logo"},{default:q((()=>[j(ie,{value:o.categoriesForm.logo,"onUpdate:value":a[1]||(a[1]=e=>o.categoriesForm.logo=e),onChange:u,disableds:s.editData.isDefault,isNum:5,title:"重新上传图标",minCropBoxWidth:48,minCropBoxHeight:48},null,8,["value","disableds"])])),_:1}),j(c,{label:"巡查权限（多选）：",name:"purviewRange"},{default:q((()=>[j(oa,{value:o.categoriesForm.purviewRange,"onUpdate:value":a[2]||(a[2]=e=>o.categoriesForm.purviewRange=e),list:o.rulesList,disableds:s.editData.isDefault,multiple:""},null,8,["value","list","disableds"])])),_:1}),j(c,{label:"分类管理员",name:"managersUsers"},{default:q((()=>[j(t,{value:o.categoriesForm.managersUsers,"onUpdate:value":a[3]||(a[3]=e=>o.categoriesForm.managersUsers=e),placeholder:"请选择",onClick:d},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","confirmLoading"]),j(f,{visible:o.visibles,"onUpdate:visible":a[5]||(a[5]=e=>o.visibles=e),multiple:o.multipleTrue,tabs:o.selectTabs,mode:o.selectMode,checked:o.checkedList,"onUpdate:checked":a[6]||(a[6]=e=>o.checkedList=e),checkParents:o.checkParents,isParents:2!==e.schoolType,checkedKey:"id",optionLength:10,onHandleOk:r},null,8,["visible","multiple","tabs","mode","checked","checkParents","isParents"])])}}},[["__scopeId","data-v-1931aeda"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/formCategories.vue"]]);const _a={class:"categories_class"},Ia=(e=>(V("data-v-f978042c"),e=e(),z(),e))((()=>E("div",{class:"tips"},[E("i",{class:"iconfont icon-outlinebeifen"}),P(" 巡查分类将展示于应用台中 ")],-1))),xa={class:"add_btn"},wa={key:2},Fa={key:3},Ca={key:1,class:"yd_btn_group"};var Da=e({__name:"categoriesModel",props:{categoriesModel:{type:Boolean,default:!1}},emits:["emitPatrolDrawer","update:categoriesModel"],setup(e,{emit:a}){const l=e,s=d(),i=D({editData:{},tableData:[],pagination:{pageNo:1,pageSize:100,total:0},policeId:"",formCategoriesVisible:!1,columnsList:[{title:"分类",dataIndex:"name",key:"name",width:40},{title:"图标",dataIndex:"logo",key:"logo",width:40},{title:"巡查权限",dataIndex:"purviewRange",key:"purviewRange",width:180},{title:"负责人",dataIndex:"managers",key:"managers",width:100},{title:"类型",dataIndex:"isDefault",key:"isDefault",width:80},{title:"操作",dataIndex:"operation",key:"operation",fixed:"right",width:80}]}),o=T((()=>s.query)),n=()=>{a("update:categoriesModel",!1)},u={1:"按场地架构",2:"按班级架构"},p=()=>{const e={};o.value.codeId&&(e.id=o.value.codeId),g(e).then((({data:e})=>{i.tableData=e}))},m=e=>{const{pageSize:a,current:l,status:t}=e,[s]=t;i.queryForm.status=s,i.pagination.pageNo=l,i.pagination.pageSize=a,p()},v=e=>{i.editData=e,i.formCategoriesVisible=!0},y=()=>{a("emitPatrolDrawer"),p()},f=T((()=>(e,a)=>{if(e[a].length){let l=[];return"purviewRange"===a&&(l=e[a].map((e=>u[e]))),"managers"===a&&(l=e[a].map((e=>e.name||e.userName))),l.join("、")}return"仅管理员"}));return S((()=>l.categoriesModel),(e=>e&&p())),(e,a)=>{const s=L("plus-outlined"),o=L("a-button"),d=L("a-avatar"),u=t,g=se,h=L("a-drawer");return U(),M("div",_a,[j(h,{class:"categories_drawer_class",title:"巡查分类管理",width:750,visible:l.categoriesModel,maskClosable:!1,onClose:n},{default:q((()=>[Ia,E("div",xa,[j(o,{type:"primary",disabled:i.tableData.length>19,onClick:a[0]||(a[0]=e=>v({}))},{icon:q((()=>[j(s)])),default:q((()=>[P(" 新增 ")])),_:1},8,["disabled"])]),j(g,{columns:i.columnsList,dataSource:i.tableData,totals:i.pagination,spinLoad:i.spinLoad,rowSelection:!1,onOnSelectedRowKeys:m},{bodyCell:q((({column:e,text:a,record:l})=>["logo"===e.key?(U(),N(d,{key:0,class:"avatar_radius",src:l.logo},null,8,["src"])):R("v-if",!0),E("div",{style:H({width:e.width+"px"})},["name"===e.key?(U(),N(u,{key:0,title:a},null,8,["title"])):R("v-if",!0),"managers"===e.key?(U(),N(u,{key:1,title:f.value(l,"managers")},null,8,["title"])):R("v-if",!0),"purviewRange"===e.key?(U(),M("div",wa,[j(u,{title:f.value(l,"purviewRange")},null,8,["title"])])):R("v-if",!0),"isDefault"===e.key?(U(),M("div",Fa,O(l.isDefault?"系统预设":"手动添加"),1)):R("v-if",!0)],4),"operation"===e.key?(U(),M("div",Ca,[j(o,{class:"button-link",type:"link",size:"small",onClick:e=>v(l)},{default:q((()=>[P(" 编辑 ")])),_:2},1032,["onClick"]),j(o,{type:"link",danger:"",size:"small",disabled:l.isDefault,onClick:e=>{return a=l.id,void r.confirm({title:"提示",icon:j(te),content:"该分类已创建计划，请先删除分类下计划再进行分类删除操作。",okText:"确定",cancelText:"取消",onOk(){const e=new FormData;e.append("id",a),b(e).then((e=>{c.success(e.message),p()}))}});var a}},{default:q((()=>[P(" 删除 ")])),_:2},1032,["disabled","onClick"])])):R("v-if",!0)])),_:1},8,["columns","dataSource","totals","spinLoad"])])),_:1},8,["visible"]),j(ka,{formCategoriesVisible:i.formCategoriesVisible,"onUpdate:formCategoriesVisible":a[1]||(a[1]=e=>i.formCategoriesVisible=e),editData:i.editData,onEmitFormCategories:y},null,8,["formCategoriesVisible","editData"])])}}},[["__scopeId","data-v-f978042c"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/categoriesModel.vue"]]);const Ta={class:"yd_body_box"},Sa={key:1,class:"placeholder"},La={class:"yd_footer"};var Ua=e({__name:"executeDrawer",props:{visibleExecute:{type:Boolean,default:!1},planInfoModelId:{type:String,default:""},planInfoMode:{type:Object,default:()=>{}}},emits:["emitCancel","update:visibleExecute"],setup(e,{emit:a}){const o=e,n=s(),r=D({id:"",businessIds:[],type:1,userSetting:""}),d=D({selectTabs:[{tab:"教职工",key:1,checked:!1},{tab:"角色",key:2,checked:!1}],selectMultiple:"personnel",selectTreeData:[],jeusRole:[],selectTreeOld:[],treeDataStudent:[],loading:!1,managerVisible:!1,checkedList:[]}),u=[{label:"共同完成",value:"1",width:"215px",msg:"任意一人完成巡查即可完成任务"},{label:"各自完成",value:"2",width:"215px",msg:"任务会重复分配到每一个执行人员，需要每一个执行人员各自去完成巡查。"}],m={businessName:[{required:!0,message:"请选择执行人员"}],userSetting:[{required:!0,message:"请选择分工形式"}]},v=(e,a)=>{d.checkedList=[],d.selectMultiple=2===e?"depa":"personnel",d.selectTreeData=2===e?d.jeusRole:d.treeDataStudent},y=$(null),f=()=>{r.businessName="",y.value.resetFields(),a("update:visibleExecute",!1)},g=e=>{const a=[],l=[];e.forEach((e=>{a.push(e.name),l.push(e.id)})),d.checkedList=$(e),a.length&&(d.selectTreeOld=d.checkedList,r.businessIds=l,r.businessName=a.join("、")),r.type="personnel"===d.selectMultiple?1:2},b=()=>{d.selectTabs.forEach((e=>{e.checked=!1,e.key===r.type&&(e.checked=!0,v(r.type))})),d.checkedList=d.selectTreeOld,d.managerVisible=!0},k=()=>{y.value.validate().then((()=>{d.loading=!0;const e={...r,id:o.planInfoModelId};h(e).then((e=>{c.success(e.message),a("emitCancel"),f()})).finally((()=>d.loading=!1))}))};S((()=>o.visibleExecute),(e=>{e&&Object.keys(o.planInfoMode).length&&(()=>{d.checkedList=[],d.selectTreeOld=[],r.businessIds=[];const e={id:o.planInfoModelId};p(e).then((({data:e})=>{const{id:a,users:l,userSetting:t}=e;r.id=a,t&&(r.userSetting=t+""),r.type=1;const s=[];null==l||l.forEach((e=>{const a=JSON.parse(JSON.stringify(e));a.name=a.businessName,a.id=a.businessId,s.push(a.businessName),r.businessIds.push(a.businessId),d.checkedList.push(a),d.selectTreeOld.push(a),r.type=a.type})),s.length&&(r.businessName=s.join("、")),d.selectTreeData=1==r.type?d.treeDataStudent:d.jeusRole}))})()}));return Q((()=>{n.dispatch("selectSource/setOrganizationTree").then((e=>{d.selectTreeData=e,d.treeDataStudent=e})),i().then((e=>{const{data:a}=e;d.jeusRole=a}))})),(e,a)=>{const s=t,i=L("a-form-item"),n=L("a-form"),c=L("close-outlined"),p=L("a-button"),h=l,_=L("a-drawer");return U(),N(_,{class:"yd_executedrawer_box",title:"执行人员设置",placement:"right",closable:!1,visible:o.visibleExecute,keyboard:!1,maskClosable:!1,destroyOnClose:!0,width:"500"},{extra:q((()=>[j(c,{onClick:f,class:"yd_close"})])),footer:q((()=>[E("div",La,[j(p,{onClick:f},{default:q((()=>[P("取消")])),_:1}),j(p,{type:"primary",loading:d.loading,onClick:k},{default:q((()=>[P(" 保存 ")])),_:1},8,["loading"])])])),default:q((()=>[E("div",Ta,[j(n,W({ref_key:"formRef",ref:y,model:r},{layout:"vertical"},{rules:m}),{default:q((()=>[j(i,{label:"执行人员",name:"businessName"},{default:q((()=>[E("div",{class:"business_Name",onClick:b},[r.businessName?(U(),N(s,{key:0,title:r.businessName},null,8,["title"])):(U(),M("span",Sa,"请选择 "))])])),_:1}),j(i,{label:"人员分工",name:"userSetting"},{default:q((()=>[j(oa,{list:u,value:r.userSetting,"onUpdate:value":a[0]||(a[0]=e=>r.userSetting=e)},null,8,["value"])])),_:1})])),_:1},16,["model"])]),j(h,{mode:d.selectMultiple,optionLength:20,tabs:d.selectTabs,visible:d.managerVisible,"onUpdate:visible":a[1]||(a[1]=e=>d.managerVisible=e),checked:d.checkedList,"onUpdate:checked":a[2]||(a[2]=e=>d.checkedList=e),treeData:d.selectTreeData,onHandleOk:g,onEmitChangeTabs:v},null,8,["mode","tabs","visible","checked","treeData"])])),_:1},8,["visible"])}}},[["__scopeId","data-v-22db8dfa"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/components/executeDrawer.vue"]]);const Ma="String",ja="Array",qa=[{name:"基础控件",components:[{title:"单行文本输入",name:"TextInput",icon:"icon-a-danhangwenbenbeifen2",value:"",valueType:Ma,props:{placeholder:"请输入",required:!1,selectUIType:1,enablePrint:!0,maxlength:null}},{title:"多行文本输入",name:"TextareaInput",icon:"icon-a-duohangwenbenbeifen2",value:"",valueType:Ma,props:{placeholder:"请输入",required:!1,selectUIType:1,enablePrint:!0,maxlength:null}},{title:"单选框",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{placeholder:"请选择",required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["选项","选项"],maxlength:null}},{title:"多选框",name:"MultipleSelect",icon:"icon-duoxuanbeifen",value:"[]",valueType:ja,props:{placeholder:"请选择",required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["选项","选项"],maxlength:null}}]}],Ea=[{title:"课程评分（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["5分","4分","3分","2分","1分"],maxlength:null}},{title:"存在问题（多选）",name:"MultipleSelect",icon:"icon-duoxuanbeifen",value:"[]",valueType:ja,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["学生课堂纪律差","教师不在教室"],maxlength:null}},{title:"是否存在缺陷（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["是","否"],maxlength:null}},{title:"缺陷描述单行",name:"TextInput",icon:"icon-a-danhangwenbenbeifen2",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,maxlength:null}}],Oa=[{title:"电源线路（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["存在隐患","正常"],maxlength:null}},{title:"教室门窗（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["门窗损坏","正常"],maxlength:null}},{title:"教学仪器（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["仪器损坏","仪器丢失","正常"],maxlength:null}},{title:"是否存在其他缺陷（单选）",name:"SelectInput",icon:"icon-danxuanbeifen",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,expanding:!1,options:["是","否"],maxlength:null}},{title:"缺陷描述单行",name:"TextInput",icon:"icon-a-danhangwenbenbeifen2",value:"",valueType:Ma,props:{required:!1,selectUIType:1,enablePrint:!0,maxlength:null}}];const Pa={class:"feedback_left"},Na={class:"library_item move"};var Ra=e({__name:"componentLibrary",setup(e){const a=e=>JSON.parse(JSON.stringify(e)),l=()=>{},t=e=>{},s=e=>!0;return(e,i)=>(U(),M("div",Pa,[(U(!0),M(A,null,J(Y(qa),((e,i)=>(U(),M("div",{class:"component_Library",key:i},[E("h2",null,O(e.name),1),j(Y(oe),{list:e.components,"ghost-class":"ghost",handle:".move",filter:".forbid","force-fallback":!0,"chosen-class":"chosenClass",animation:"300",class:"list-group library",onStart:l,onEnd:t,clone:a,group:{name:"itxst",pull:"clone",put:!1},"fallback-class":!0,"fallback-on-body":!0,"touch-start-threshold":50,"fallback-tolerance":50,move:s,sort:!1},{item:q((({element:e})=>[E("div",Na,[E("i",{class:B(["iconfont",e.icon])},null,2),P(" "+O(e.title),1)])])),_:2},1032,["list"])])))),128))]))}},[["__scopeId","data-v-58793f40"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/componentLibrary.vue"]]);var Va=e({__name:"TextInput",props:{placeholder:{type:String,default:"请输入"}},setup(e){const a=e;return(e,l)=>{const t=L("a-input");return U(),N(t,{size:"medium",disabled:"",placeholder:a.placeholder},null,8,["placeholder"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/TextInput.vue"]]);var za=e({__name:"TextareaInput",props:{placeholder:{type:String,default:"请输入"}},setup(e){const a=e;return(e,l)=>{const t=L("a-textarea");return U(),N(t,{disabled:"",placeholder:a.placeholder,"auto-size":{minRows:2,maxRows:3}},null,8,["placeholder"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/TextareaInput.vue"]]);var Aa=e({__name:"NumberInput",props:{placeholder:{type:String,default:"请输入"}},setup(e){const a=e;return(e,l)=>{const t=L("a-input");return U(),N(t,{size:"medium",disabled:"",placeholder:a.placeholder},null,8,["placeholder"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/NumberInput.vue"]]);const Ja={class:"select_input"},Ba={key:0,class:"gutter"};var Ha=e({__name:"SelectInput",props:{placeholder:{type:String,default:"请选择"},elementProps:{type:Object,default:()=>{}}},setup(e){const a=e,l=D({isOptionFormat:!0}),t=T((()=>e=>e.length>7?"270px":"125px"));return(e,s)=>{const i=L("a-cascader");return U(),M("div",Ja,[l.isOptionFormat?(U(),M("div",Ba,[(U(!0),M(A,null,J(a.elementProps.options,((e,a)=>(U(),M("div",{key:a,class:"gutter-box",style:H({minWidth:t.value(e)})},O(e),5)))),128))])):(U(),N(i,{key:1,size:"medium",style:{width:"100%"},disabled:"",placeholder:a.placeholder},null,8,["placeholder"]))])}}},[["__scopeId","data-v-5da64af7"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/SelectInput.vue"]]);var Ka=e({__name:"DateTime",props:{placeholder:{type:String,default:"请选择"}},setup(e){const a=e;return(e,l)=>{const t=L("clock-circle-outlined"),s=L("a-input");return U(),N(s,{size:"medium",disabled:"",placeholder:a.placeholder},{prefix:q((()=>[j(t)])),_:1},8,["placeholder"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/DateTime.vue"]]);var $a=e({__name:"DateTimeRange",props:{placeholder:{type:String,default:"请选择"}},setup(e){const a=e;return(e,l)=>{const t=L("clock-circle-outlined"),s=L("a-input");return U(),N(s,{size:"medium",disabled:"",placeholder:a.placeholder},{prefix:q((()=>[j(t)])),_:1},8,["placeholder"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/DateTimeRange.vue"]]);const Ya={class:"avatar-uploader"},Wa=(e=>(V("data-v-8529d1f6"),e=e(),z(),e))((()=>E("div",{class:"ant-upload-text"},"上传图片",-1)));var Qa=e({__name:"ImageUpload",props:{placeholder:{type:String,default:"请选择"}},setup:e=>(e,a)=>{const l=L("plus-outlined"),t=L("a-upload");return U(),M("div",Ya,[j(t,{disabled:""},{default:q((()=>[j(l),Wa])),_:1})])}},[["__scopeId","data-v-8529d1f6"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/ImageUpload.vue"]]);const Xa={class:"select_input"},Ga={key:0,class:"gutter"};var Za=e({__name:"MultipleSelect",props:{placeholder:{type:String,default:"请选择"},elementProps:{type:Object,default:()=>{}}},setup(e){const a=e,l=D({isOptionFormat:!0}),t=T((()=>e=>e.length>7?"270px":"125px"));return(e,s)=>{const i=L("a-cascader");return U(),M("div",Xa,[l.isOptionFormat?(U(),M("div",Ga,[(U(!0),M(A,null,J(a.elementProps.options,((e,a)=>(U(),M("div",{key:a,class:"gutter-box",style:H({minWidth:t.value(e)})},O(e),5)))),128))])):(U(),N(i,{key:1,size:"medium",style:{width:"100%"},disabled:"",placeholder:a.placeholder},null,8,["placeholder"]))])}}},[["__scopeId","data-v-3d64aef3"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/components/MultipleSelect.vue"]]);const el={class:"feedback_content form"},al={class:"hendle"},ll=(e=>(V("data-v-04fc4c56"),e=e(),z(),e))((()=>E("i",{class:"iconfont icon-a-Batchfolding"},null,-1))),tl={class:"content"},sl={class:"phone_model"},il={class:"tip"},ol=["onClick"],nl={key:0,class:"required"},rl={key:1,class:"title"};var cl=e({__name:"componentFrom",setup(e){const a=ne(),l=D({drag:!1,selectFormItem:null,visibleDropdown:!1,menuActive:null,menuItem:[{key:1,value:"常规巡课"},{key:2,value:"场地巡逻"}],forms:[],component:{DateTime:Ka,TextInput:Va,SelectInput:Ha,NumberInput:Aa,ImageUpload:Qa,TextareaInput:za,DateTimeRange:$a,MultipleSelect:Za}}),t=()=>{},s=()=>{},i=e=>!1,o=e=>{l.menuActive=e.key,a.commit("patrol/UPDATEFORMPROPERTIES",{params:JSON.parse(JSON.stringify(1===e.key?Ea:Oa))})},n=T((()=>a.state.patrol.formItems)),r=T((()=>a.state.patrol.formsActive));return(e,c)=>{const d=L("sapn"),u=L("a-menu-item"),p=L("a-menu"),m=L("a-dropdown"),v=L("close-outlined");return U(),M("div",el,[E("div",al,[j(d),j(m,{visible:l.visibleDropdown,"onUpdate:visible":c[1]||(c[1]=e=>l.visibleDropdown=e)},{overlay:q((()=>[j(p,{onClick:o},{default:q((()=>[(U(!0),M(A,null,J(l.menuItem,(e=>(U(),N(u,{key:e.key,class:B({menuActive:l.menuActive==e.key})},{default:q((()=>[P(O(e.value),1)])),_:2},1032,["class"])))),128))])),_:1})])),default:q((()=>[E("a",{class:"dropdown-link",onClick:c[0]||(c[0]=X((()=>{}),["prevent"]))},[ll,P(" 使用系统模板 ")])])),_:1},8,["visible"])]),E("div",tl,[E("div",sl,[G(E("div",il," 👈 请在左侧选择控件并拖至此处 ",512),[[Z,!n.value.length]]),j(Y(oe),{class:"drag_from",list:n.value,onStart:t,onEnd:s,move:i,sort:!1,group:{name:"itxst",put:!0,pull:!1}},{item:q((({element:e,index:t})=>[(U(),M("div",{key:t,class:B(["from_item",{formsActive:t==r.value}]),onClick:X((e=>(e=>{a.commit("patrol/UPDATEFORMSACTIVE",e)})(t)),["stop"])},[t==r.value?(U(),N(v,{key:0,class:"close",onClick:X((e=>{return l=t,void a.commit("patrol/UPDATEFORMPROPERTIES",{type:"delete",idx:l});var l}),["stop"])},null,8,["onClick"])):R("v-if",!0),E("div",null,[e.props.required?(U(),M("span",nl," * ")):R("v-if",!0),e.title?(U(),M("span",rl,O(e.title)+"： ",1)):R("v-if",!0)]),(U(),N(ee(l.component[e.name]),{ref:"form",elementProps:e.props,placeholder:e.props.placeholder},null,8,["elementProps","placeholder"]))],10,ol))])),_:1},8,["list"])])])])}}},[["__scopeId","data-v-04fc4c56"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/componentFrom.vue"]]);const dl={class:"feedback_right"},ul={class:"tip"},pl={class:"feedback_right_title"},ml={class:"option_settings"},vl={class:"option-item"},yl=(e=>(V("data-v-39ee1d54"),e=e(),z(),e))((()=>E("i",{class:"iconfont icon-tuozhuai movers",style:{color:"#b5b2b2","line-height":"32px"}},null,-1))),fl=["onClick"];var gl=e({__name:"componentFromTypes",props:{placeholder:{type:String,default:"请选择"}},setup(e){const a=e,l=ne(),t=T((()=>l.state.patrol.formItems)),s=T((()=>l.state.patrol.formsActive)),i=T((()=>()=>{const e=t.value[s.value].name;return!["DateTimeRange","MultipleSelect","SelectInput","DateTime","NumberInput"].includes(e)})),o=T((()=>()=>{const e=t.value[s.value].name;return["SelectInput","MultipleSelect"].includes(e)})),n=()=>{t.value[s.value].props.options.length<=19&&t.value[s.value].props.options.push("新选项")},r=()=>{},c=()=>{};return(e,l)=>{const d=L("a-input"),u=L("a-form-item"),p=L("plus-outlined"),m=L("a-button"),v=L("a-input-number"),y=L("a-switch"),f=L("a-form");return U(),M("div",dl,[G(E("div",ul," 😀 选中控件后在这里进行编辑 ",512),[[Z,null==s.value||!t.value.length]]),t.value.length&&null!==s.value?(U(),M(A,{key:0},[E("div",pl,[E("i",{class:B(["iconfont",t.value[s.value].icon])},null,2),P(" "+O(t.value[s.value].title),1)]),j(f,{class:"feedback_right_form",layout:"vertical"},{default:q((()=>[j(u,{label:"表单名称："},{default:q((()=>[j(d,{value:t.value[s.value].title,"onUpdate:value":l[0]||(l[0]=e=>t.value[s.value].title=e),placeholder:a.placeholder,showCount:"",maxlength:50},null,8,["value","placeholder"])])),_:1}),o.value()?(U(),N(u,{key:0,label:"选项设置："},{default:q((()=>[E("div",ml,[j(Y(oe),{class:"drag_from",list:t.value[s.value].props.options,handle:".movers","chosen-class":"chosen","force-fallback":"true",group:"people",animation:"1000",onStart:r,onEnd:c},{item:q((({element:e,index:a})=>[E("div",vl,[yl,j(d,{maxlength:"20",value:t.value[s.value].props.options[a],"onUpdate:value":e=>t.value[s.value].props.options[a]=e},{addonAfter:q((()=>[E("i",{onClick:X((e=>(e=>{t.value[s.value].props.options.length>2&&t.value[s.value].props.options.splice(e,1)})(a)),["stop"]),class:"iconfont icon-shanchu1",style:{color:"#b5b2b2"}},null,8,fl)])),_:2},1032,["value","onUpdate:value"])])])),_:1},8,["list"])]),t.value[s.value].props.options.length<20?(U(),N(m,{key:0,type:"link",size:"mini",style:{color:"#00b781"},onClick:n},{icon:q((()=>[j(p)])),default:q((()=>[P(" 新增选项 ")])),_:1})):R("v-if",!0)])),_:1})):R("v-if",!0),j(u,{label:"提示文字："},{default:q((()=>[j(d,{value:t.value[s.value].props.placeholder,"onUpdate:value":l[1]||(l[1]=e=>t.value[s.value].props.placeholder=e),placeholder:a.placeholder,showCount:"",maxlength:50},null,8,["value","placeholder"])])),_:1}),i.value()?(U(),N(u,{key:1,label:"最大长度："},{default:q((()=>[j(v,{style:{width:"100%"},id:"inputNumber",value:t.value[s.value].props.maxlength,"onUpdate:value":l[2]||(l[2]=e=>t.value[s.value].props.maxlength=e),min:1,max:50,placeholder:"最大长度"},null,8,["value"])])),_:1})):R("v-if",!0),"NumberInput"==t.value[s.value].name?(U(),N(u,{key:2,label:"保留小数："},{default:q((()=>[j(v,{style:{width:"85%"},value:t.value[s.value].props.precision,"onUpdate:value":l[3]||(l[3]=e=>t.value[s.value].props.precision=e),keyboard:!0,min:0,max:3},null,8,["value"]),P(" 位 ")])),_:1})):R("v-if",!0),j(u,{label:"必填项",class:"item-inlin",style:{}},{default:q((()=>[j(y,{checked:t.value[s.value].props.required,"onUpdate:checked":l[4]||(l[4]=e=>t.value[s.value].props.required=e)},null,8,["checked"])])),_:1})])),_:1})],64)):R("v-if",!0)])}}},[["__scopeId","data-v-39ee1d54"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/componentFromTypes.vue"]]);var bl=e({__name:"index",props:{isViewFormat:{type:Boolean,default:!1},visibleFeedback:{type:Boolean,default:!1},planInfoModelId:{type:String,default:""}},emits:["update:visibleFeedback","emitCancel"],setup(e,{emit:a}){const l=e,t=ne(),s=D({loading:!1,title:"编辑反馈表单格式"}),i=()=>{t.commit("patrol/UPDATEFORMPROPERTIES",{params:[]}),a("update:visibleFeedback",!1)},o=()=>{const e={id:l.planInfoModelId,formJson:n.value,needForm:!0};s.loading=!0,k(e).then((()=>{a("emitCancel"),i()})).finally((()=>s.loading=!1))},n=T((()=>t.state.patrol.formItems));return(a,t)=>{const n=L("a-modal");return U(),N(n,{visible:l.visibleFeedback,maskClosable:!1,title:s.title,confirmLoading:s.loading,bodyStyle:{padding:0},onOk:o,onCancel:i,okText:"保存",cancelText:"退出",width:"1200px",zIndex:1002,footer:e.isViewFormat?null:void 0},{default:q((()=>[E("div",{class:B(["feedback",{active:e.isViewFormat}])},[R(" 组件库 "),j(Y(Ra)),j(Y(cl)),j(Y(gl))],2)])),_:1},8,["visible","title","confirmLoading","footer"])}}},[["__scopeId","data-v-60688e40"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/feedbackForm/index.vue"]]);const hl=e=>(V("data-v-0818f464"),e=e(),z(),e),kl={class:"plan_class"},_l={class:"head_operation"},Il={class:"queryform_class"},xl={class:"operation_button"},wl={class:"plan_list_class"},Fl={class:"plan_box"},Cl=["onClick"],Dl=["onClick"],Tl=["onClick"],Sl=["onClick"],Ll=hl((()=>E("i",{class:"iconfont icon-xingzhuangjiehe11 icon"},null,-1))),Ul={class:"plan_item"},Ml={class:"title_class"},jl={class:"plan_item_info"},ql={class:"left"},El={class:"right"},Ol={key:0},Pl=["onClick"],Nl={class:"btn_box"},Rl=hl((()=>E("span",null,"暂无数据",-1))),Vl={class:"pagination"};var zl=e({__name:"index",setup(e){const a=u(),s=d(),i=$(),n=$(null),m=D({selectedKeys:[],selectTabs:[],checkedList:[],checkedListOld:[],siteArchitecture:[],classStructure:[],patrolTreeData:[],viewFormatDetails:null,patrolType:1,viewFormat:!1,patrolVisible:!1,visibleFeedback:!1,visibleExecute:!1,infoModel:!1,infoModelId:"",planInfoMode:{},categoriesModel:!1,pageSizeOptions:["10","20","30","40"],pagination:{pageNo:1,pageSize:20,total:0},queryForm:{name:"",patrolTypeId:null,cycleFrequency:null,status:null},status:[{value:!0,label:"已启用"},{value:!1,label:"未启用"}],frequency:[{value:0,label:"单次任务"},{value:1,label:"每日"},{value:2,label:"每周"},{value:3,label:"每月"},{value:4,label:"每年"}],taskType:[],planLoading:!1,patrolCard:{typeName:"patrolTypeName",title:"name",children:[{key:"isCycle",value:"任务类型"},{key:"userSetting",value:"执行人员"},{key:"siteSetting",value:"巡查场地"},{key:"needForm",value:"是否需要提交反馈表单"},{key:"formJson",value:"反馈表单"},{key:"updateDate",value:"更新时间"},{key:"status",value:"状   态"}]},cycleFrequency:{1:"每日",2:"每周",3:"每月",4:"每年"},planList:[]}),v=[{tab:"场地架构选择",key:1,checked:!0,disabled:[],_type:"sites"},{tab:"按班级架构选择",key:2,disabled:[],checked:!1}],y=ne(),f=T((()=>s.query)),b=async e=>{const a=m.taskType.map((e=>({value:e.id,label:e.name})));n.value.showDrawer(a,e)},h=()=>{m.planLoading=!0;const e={...m.pagination,...m.queryForm};f.value.codeId&&(e.patrolTypeId=f.value.codeId),_(e).then((({data:e})=>{const{pageNo:a,pageSize:l,total:t,list:s=[]}=e;m.planList=s||[],m.pagination={pageNo:a,pageSize:l,total:t}})).finally((()=>m.planLoading=!1))},S=(e,a)=>{a||(m.checkedList=[]),m.patrolTreeData=$(e>1?W:m.siteArchitecture)},V=async(e,a)=>{switch(m.infoModelId=e.id,a){case"formJson":e[a]&&y.commit("patrol/UPDATEFORMPROPERTIES",{params:JSON.parse(e[a])}),m.viewFormat=!1,m.visibleFeedback=!0;break;case"userSetting":e[a]&&(m.planInfoMode=e),m.visibleExecute=!0;break;case"siteSetting":m.checkedList=[],await(async()=>{const e={id:m.infoModelId},{data:a}=await p(e);a&&a.sites.length&&(m.checkedList=a.sites.map((e=>(m.patrolType=e.siteRange,{...e,id:e.businessId||e.id,name:e.businessName||e.name}))),m.checkedListOld=m.checkedList)})(),m.siteArchitecture.length||await(async()=>{await o().then((({data:e})=>{m.selectedKeys=e.length?[e[0].id,e[0].children[0].id]:[],m.siteArchitecture=e,m.patrolTreeData=e}))})(),m.selectTabs=[],e.purviewRange.forEach((e=>{const a=Number(e);v.forEach((e=>{e.checked=!1,e.key===a&&m.selectTabs.push(e)}))}));let l=!1;m.selectTabs.forEach(((e,a)=>{e.key===m.patrolType&&(l=!0,e.checked=!0,S(e.key,!0)),l||m.selectTabs.length-1!==a||(m.selectTabs[0].checked=!0,S(m.selectTabs[0].key,!0))})),m.patrolVisible=!0}},z=()=>{y.commit("patrol/UPDATEFORMPROPERTIES",{params:m.viewFormatDetails.formJson?JSON.parse(m.viewFormatDetails.formJson):""}),m.viewFormat=!0,m.visibleFeedback=!0},K=e=>{const{infoModelId:a,patrolType:l}=m,t={id:a,siteRange:l,sites:{site:[],grade:[],campus:[],classes:[],college:[],professional:[]}};e.forEach((e=>{e.businessCode?(t.sites[e.businessCode].push(e.id),t.siteRange="site"===e.businessCode?1:2):(e.rollValue&&(t.sites[e.rollValue].push(e.id),t.siteRange=2),e.buildingId&&(t.sites.site.push(e.id),t.siteRange=1))})),(e=>{C(e).then((e=>{c.success(e.message),h()}))})(t)},W=T((()=>{if(m.selectTabs.length){const e=[],a=(e=>{if("INIT_STUDENT_TABLE_LIST"===e){const a=ae(y.state.base.commentJsonKeys[e])||[],l=[];return a.forEach((e=>{e.show&&l.push(e)})),T((()=>l))}return T((()=>ae(y.state.base.commentJsonKeys[e])))})("INIT_ROLL_LIST").value;null==a||a.forEach((a=>"classes"!==a.key&&e.push(a.level))),m.selectTabs.forEach((a=>{a.disabled=e}))}return y.state.base.schoolRollTree})),X=e=>{m.pagination.pageNo=e,h()},G=()=>{m.pagination.pageNo=1,m.pagination.pageSize=20,h()},Z=()=>{i.value.resetFields(),m.pagination.pageNo=1,m.pagination.pageSize=20,h()},ee=T((()=>e=>e?"#00b781":"#faad14")),le=T((()=>(e,a,l)=>{const t=a.key,s=e[t]||!1;return"setEdit"===l?s?"编辑":"设置":"status"===t?s?"启用":"未启用":"isCycle"===t?s?`周期 - ${m.cycleFrequency[e.cycleFrequency]}`:"单次":s?"已设置":"未设置"})),se=T((()=>e=>{const a=e[m.patrolCard.typeName];return"巡逻"===a?"#faad14":"巡课"===a?"#99CC0EFF":"#666666"})),ie=T((()=>e=>e.status)),oe=T((()=>(e,a)=>{const{status:l,needForm:t}=e;return"formJson"===a.key?!l&&t:!l})),re=()=>{const e={};f.value.codeId&&(e.id=f.value.codeId),g(e).then((({data:e})=>{m.taskType=e}))};return Q((()=>{w().then((({data:e})=>{e||r.confirm({title:"提示",icon:j(te),content:"请初始默认的巡查应用",okText:"确定",cancelText:"取消",onOk(){F()}})})),h(),re()})),(e,s)=>{const o=L("a-select-option"),d=L("a-select"),u=L("a-form-item"),p=L("a-input"),v=L("SearchOutlined"),y=L("a-button"),g=L("redo-outlined"),_=L("a-form"),w=L("plus-outlined"),F=L("a-popover"),C=t,D=L("a-switch"),T=L("a-col"),$=L("a-row"),W=L("a-empty"),Q=L("a-spin"),ae=L("a-pagination");return U(),M("div",kl,[R(" 条件查询  "),E("div",_l,[j(_,{layout:"horizontal",model:m.queryForm,ref_key:"queryVoteRef",ref:i},{default:q((()=>[E("div",Il,[f.value.codeId?R("v-if",!0):(U(),N(u,{key:0,label:"分类：",name:"patrolTypeId"},{default:q((()=>[j(d,{style:{width:"240px"},value:m.queryForm.patrolTypeId,"onUpdate:value":s[0]||(s[0]=e=>m.queryForm.patrolTypeId=e),placeholder:"请选择"},{default:q((()=>[(U(!0),M(A,null,J(m.taskType,(e=>(U(),N(o,{value:e.id,key:e.id},{default:q((()=>[P(O(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})),j(u,{label:"频次：",name:"cycleFrequency"},{default:q((()=>[j(d,{style:{width:"240px"},value:m.queryForm.cycleFrequency,"onUpdate:value":s[1]||(s[1]=e=>m.queryForm.cycleFrequency=e),placeholder:"请选择"},{default:q((()=>[(U(!0),M(A,null,J(m.frequency,(e=>(U(),N(o,{value:e.value,key:e.value},{default:q((()=>[P(O(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),j(u,{label:"状态：",name:"status"},{default:q((()=>[j(d,{style:{width:"240px"},value:m.queryForm.status,"onUpdate:value":s[2]||(s[2]=e=>m.queryForm.status=e),placeholder:"请选择"},{default:q((()=>[(U(!0),M(A,null,J(m.status,(e=>(U(),N(o,{value:e.value,key:e.value},{default:q((()=>[P(O(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),j(u,{label:"关键字：",name:"name"},{default:q((()=>[j(p,{style:{width:"240px"},value:m.queryForm.name,"onUpdate:value":s[3]||(s[3]=e=>m.queryForm.name=e),placeholder:"请输入计划名称关键词"},null,8,["value"])])),_:1}),j(u,null,{default:q((()=>[j(y,{type:"primary","html-type":"submit",onClick:G},{icon:q((()=>[j(v,{style:{"margin-right":"6px"}})])),default:q((()=>[P(" 查询 ")])),_:1}),j(y,{style:{"margin-left":"10px"},onClick:Z},{icon:q((()=>[j(g,{style:{"margin-right":"6px"}})])),default:q((()=>[P(" 重置 ")])),_:1})])),_:1})])])),_:1},8,["model"])]),R(" 操作按钮 "),E("div",xl,[j(y,{type:"primary","html-type":"submit",style:{"margin-right":"12px"},onClick:s[4]||(s[4]=e=>b(""))},{icon:q((()=>[j(w)])),default:q((()=>[P(" 创建计划 ")])),_:1}),f.value.codeId?R("v-if",!0):(U(),N(y,{key:0,onClick:s[5]||(s[5]=e=>m.categoriesModel=!0)},{default:q((()=>[P(" 分类管理 ")])),_:1}))]),R(" 计划列表 "),E("div",wl,[j(Q,{spinning:m.planLoading},{default:q((()=>[m.planList.length?(U(),N($,{key:0,justify:"start",align:"top",gutter:[24,16]},{default:q((()=>[(U(!0),M(A,null,J(m.planList,((e,l)=>(U(),N(T,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6,key:e.id+"video"+l},{default:q((()=>[E("div",Fl,[j(F,{placement:"bottom"},{content:q((()=>[E("div",{class:"popover_item",onClick:l=>{return t=e.id,void a.push({path:"/appModel/patrol/patrolPlan/planInfo",query:{patrolProjectId:t}});var t}}," 巡查记录 ",8,Cl),e.status?R("v-if",!0):(U(),M("div",{key:0,class:"popover_item",onClick:a=>b(e.id)}," 编辑 ",8,Dl)),!e.status||e.isCycle?(U(),M("div",{key:1,class:"popover_item",onClick:a=>(e=>{const{id:a,status:l,isCycle:t,formJson:s,siteSetting:i,userSetting:o,needForm:n}=e;if(n&&(!s||!i||!o)||!n&&(!i||!o))return void r.success({title:"提示",icon:j(te),content:"需要完成所有设置项目才可启用计划"});let d="本计划为单次任务，启用成功后将立即将任务指派给执行人员，是否确定启用此计划？";t&&(d="本计划为周期任务，启用成功后将在每日0点根据您配置的计划内容将巡查任务指派给执行人员，是否确定启用此计划？"),l&&(d="计划停用后将不再进行任务派发，是否确定停用此计划？"),r.confirm({title:"提示",icon:j(te),content:d,okText:"确定",cancelText:"取消",onOk(){I({id:a,status:!l}).then((e=>{h(),c.success(e.message)}))}})})(e)},O(e.status?"停用":"启用"),9,Tl)):R("v-if",!0),!e.status||!e.isCycle&&e.status?(U(),M("div",{key:2,class:"popover_item delect_color",onClick:a=>(e=>{const{id:a}=e;r.confirm({title:"提示",icon:j(te),content:"是否确定删除此计划，将同步删除改计划下所有任务，此操作无法恢复？",okText:"确定",cancelText:"取消",onOk(){const e=new FormData;e.append("id",a),x(e).then((e=>{h(),c.success(e.message)}))}})})(e)}," 删除 ",8,Sl)):R("v-if",!0)])),default:q((()=>[Ll])),_:2},1024),E("div",Ul,[R(" 计划标题 "),E("div",Ml,[E("div",{class:"tip",style:H({background:se.value(e)})},O(e[m.patrolCard.typeName]),5),j(C,{title:e[m.patrolCard.title]},null,8,["title"])]),R(" 计划详情 "),E("div",jl,[(U(!0),M(A,null,J(m.patrolCard.children,((a,l)=>(U(),M("div",{key:l,class:B(["info_item",{active:"formJson"===a.key&&!e.needForm}])},[E("span",ql,O(a.value)+"： ",1),E("span",El,["isCycle"==a.key?(U(),M("div",Ol,O(le.value(e,a)),1)):"updateDate"==a.key?(U(),M(A,{key:1},[P(O(e[a.key]),1)],64)):"status"==a.key?(U(),M("span",{key:2,style:H({color:ee.value(e[a.key])})},O(le.value(e,a)),5)):"needForm"==a.key?(U(),M(A,{key:3},[E("span",null,O(e.needForm?"需要":"不需要"),1),j(D,{disabled:ie.value(e),onChange:a=>((e,a)=>{let{formJson:l,id:t,needForm:s}=a;l&&(l=JSON.parse(l)),k({formJson:l,id:t,needForm:s}).then((e=>{c.success(e.message)}))})(0,e),checked:e.needForm,"onUpdate:checked":a=>e.needForm=a},null,8,["disabled","onChange","checked","onUpdate:checked"])],64)):(U(),M(A,{key:4},[E("span",null,[E("i",{class:"iconfont icon-Shape3",style:H({color:ee.value(e[a.key])})},null,4),P(" "+O(le.value(e,a)),1)]),oe.value(e,a)?(U(),M("span",{key:0,class:"yd_hover set_edit",onClick:l=>V(e,a.key)},[E("i",{class:B(["iconfont",e[a.key]?"icon-xingzhuangjiehe27":"icon-a-shezhi2"])},null,2),P(" "+O(le.value(e,a,"setEdit")),1)],8,Pl)):R("v-if",!0)],64))])],2)))),128))]),R(" 计划操作按钮 "),E("div",Nl,[j(y,{type:"primary",ghost:"",shape:"round",onClick:l=>(e=>{const l={patrolProjectId:e};f.value.codeId&&(l.codeId=f.value.codeId),a.push({path:"/appModel/patrol/patrolTask",query:l})})(e.id)},{default:q((()=>[P("查看任务")])),_:2},1032,["onClick"]),j(y,{type:"primary",shape:"round",onClick:a=>(e=>{m.infoModel=!0,m.infoModelId=e.id,m.viewFormatDetails=e})(e)},{default:q((()=>[P("查看详情")])),_:2},1032,["onClick"])])])])])),_:2},1024)))),128))])),_:1})):(U(),M(A,{key:1},[R(" 无数据 "),j(W,{image:"image/empty.png","image-style":{width:"100%",height:"180px"}},{description:q((()=>[Rl])),_:1})],2112))])),_:1},8,["spinning"]),R(" 分页 "),E("div",Vl,[m.pagination.total>20?(U(),N(ae,{key:0,current:m.pagination.pageNo,"onUpdate:current":s[6]||(s[6]=e=>m.pagination.pageNo=e),"page-size":m.pagination.pageSize,"onUpdate:pageSize":s[7]||(s[7]=e=>m.pagination.pageSize=e),"show-quick-jumper":"","show-size-changer":"",pageSizeOptions:m.pageSizeOptions,total:m.pagination.total,"show-total":e=>`共 ${e} 条`,onChange:X},null,8,["current","page-size","pageSizeOptions","total","show-total"])):R("v-if",!0)])]),j(ea,{planInfoVisible:m.infoModel,"onUpdate:planInfoVisible":s[8]||(s[8]=e=>m.infoModel=e),planInfoModelId:m.infoModelId,onEmitViewFormat:z},null,8,["planInfoVisible","planInfoModelId"]),j(Da,{categoriesModel:m.categoriesModel,"onUpdate:categoriesModel":s[9]||(s[9]=e=>m.categoriesModel=e),onEmitPatrolDrawer:re},null,8,["categoriesModel"]),R(" 巡查分类管理 "),j(Y(ba),{ref_key:"PatrolDrawerCom",ref:n,onEmitCancel:h},null,512),R(" 反馈表单 "),j(Y(bl),{visibleFeedback:m.visibleFeedback,"onUpdate:visibleFeedback":s[10]||(s[10]=e=>m.visibleFeedback=e),planInfoModelId:m.infoModelId,isViewFormat:m.viewFormat,onEmitCancel:h},null,8,["visibleFeedback","planInfoModelId","isViewFormat"]),R(" 执行人员设置 "),j(Ua,{visibleExecute:m.visibleExecute,"onUpdate:visibleExecute":s[11]||(s[11]=e=>m.visibleExecute=e),planInfoModelId:m.infoModelId,planInfoMode:m.planInfoMode,onEmitCancel:h},null,8,["visibleExecute","planInfoModelId","planInfoMode"]),j(Y(l),{mode:"depa",tabs:m.selectTabs,selectedKeys:m.selectedKeys,checked:m.checkedList,"onUpdate:checked":s[12]||(s[12]=e=>m.checkedList=e),visible:m.patrolVisible,"onUpdate:visible":s[13]||(s[13]=e=>m.patrolVisible=e),treeData:m.patrolTreeData,onHandleOk:K,onEmitChangeTabs:S},null,8,["tabs","selectedKeys","checked","visible","treeData"])])}}},[["__scopeId","data-v-0818f464"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolPlan/index.vue"]]);export{zl as default};
