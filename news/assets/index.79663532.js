import"./vue.a2f518ee.js";import{a as e,m as a,M as t}from"./ant-design-vue.db4d48e3.js";import{_ as l}from"./index.7061e8ea.js";import{e as s,q as o,R as r,b8 as i,o as n,a2 as u,a3 as d,c,a1 as p,u as m,f as v,b as f,a as y,F as g,a8 as b,b5 as _,b4 as h,r as w,O as j,a9 as k,D as x,a5 as L,a7 as F,n as C,y as I}from"./@vue.919ff404.js";import{k as U,f as T,l as V,m as B,n as D,o as M,s as S}from"./model.465db796.js";import{g as q}from"./oss.72e23b0d.js";import{Y as R}from"./table.81b98c8b.js";import{f as E}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./vue-router.907b547c.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./FilterDropdown.5a779a00.js";import"./ali-oss.e15d125a.js";import"./ydutils.99497787.js";import"./ydutils.a58fbaf1.js";var P=l(s({__name:"categoryForm",setup(a,{expose:t}){const l=e.useForm,s=o({name:"",description:""}),v=o({name:[{required:!0,message:"请输入评比类目"}]}),{resetFields:f,validate:y,validateInfos:g}=l(s,v,{onValidate:(...e)=>{}});return t({validate:y,resetFields:f,formInfo:r(s)}),(e,a)=>{const t=i("a-input"),l=i("a-form-item"),o=i("a-textarea"),r=i("a-form");return n(),u(r,{layout:"vertical"},{default:d((()=>[c(l,p({label:"评比类目"},m(g).name),{default:d((()=>[c(t,{"show-count":"",placeholder:"请输入",maxlength:10,value:s.name,"onUpdate:value":a[0]||(a[0]=e=>s.name=e)},null,8,["value"])])),_:1},16),c(l,p({label:"描述"},m(g).description),{default:d((()=>[c(o,{value:s.description,"onUpdate:value":a[1]||(a[1]=e=>s.description=e),"show-count":"",rows:4,maxlength:100},null,8,["value"])])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-6fd93a04"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/studentEvaluation/setup/components/categoryForm.vue"]]);const z=e=>(_("data-v-0259ec29"),e=e(),h(),e),A={style:{display:"flex"}},O={key:1},H=z((()=>f("div",{class:"ant-upload-text"},"点击上传图片",-1))),K=z((()=>f("ul",{class:"upload_tips"},[f("li",null,"温馨提示："),f("li",null,"上传透明背景的png/svg格式图片；"),f("li",null,"图片尺寸：200x200px；图片大小不超过2M")],-1)));var N=l(s({__name:"medalForm",setup(t,{expose:l}){const s=e.useForm,_=o({medalList:[],url:"",uploadLoading:!1});let h=null;v((()=>{U({pageNo:1,pageSize:10}).then((({data:e})=>{const{list:a}=e;_.medalList=a||[]}))}));const w=o({url:"",description:""}),j=o({url:[{required:!0,message:"请输入奖章logo"}]}),{resetFields:k,validate:x,validateInfos:L}=s(w,j,{onValidate:(...e)=>{}});function F(e){w.url=e.target.value,h=null}async function C(e){return e.size/1024/1024<2?(h=e,function(e,a){const t=new FileReader;t.addEventListener("load",(()=>a(t.result))),t.readAsDataURL(e)}(e,(e=>{w.url=e,_.url=""})),!1):(a.error("图片大小不超过2M"),!1)}return l({validate:async()=>{if(h){_.uploadLoading=!0;try{const{url:e}=await q(h,{catalogue:"studentAssessmentMedal"});return h=null,w.url=e,_.uploadLoading=!1,_.url="",Promise.resolve()}catch(e){w.url="",a.error("上传图片出错了")}_.uploadLoading=!1}return _.url="",x()},resetFields:k,formInfo:r(w)}),(e,a)=>{const t=i("a-image"),l=i("loading-outlined"),s=i("plus-outlined"),o=i("a-upload"),r=i("a-form-item"),v=i("a-radio"),h=i("a-col"),j=i("a-row"),k=i("a-radio-group"),x=i("a-textarea"),I=i("a-form");return n(),u(I,{layout:"vertical"},{default:d((()=>[c(r,p({label:"奖章logo："},m(L).url),{default:d((()=>[f("div",A,[f("div",null,[c(o,{name:"avatar","list-type":"picture-card",class:"uploader","show-upload-list":!1,action:"/","before-upload":C,accept:"image/png,image/svg"},{default:d((()=>[w.url?(n(),u(t,{width:64,height:64,preview:!1,key:w.url,src:w.url,class:"animate__animated animate__headShake"},null,8,["src"])):(n(),y("div",O,[_.uploadLoading?(n(),u(l,{key:0})):(n(),u(s,{key:1})),H]))])),_:1})]),K])])),_:1},16),c(r,{label:"平台提供的奖章样式："},{default:d((()=>[c(k,{value:_.url,"onUpdate:value":a[0]||(a[0]=e=>_.url=e),style:{width:"100%"},onChange:F},{default:d((()=>[c(j,null,{default:d((()=>[(n(!0),y(g,null,b(_.medalList,((e,a)=>(n(),u(h,{span:8,key:a,class:"medal_item"},{default:d((()=>[c(v,{value:e},{default:d((()=>[c(t,{width:64,height:64,preview:!1,src:e},null,8,["src"])])),_:2},1032,["value"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1}),c(r,p({label:"描述："},m(L).description),{default:d((()=>[c(x,{value:w.description,"onUpdate:value":a[1]||(a[1]=e=>w.description=e),"show-count":"",rows:4,maxlength:50},null,8,["value"])])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-0259ec29"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/studentEvaluation/setup/components/medalForm.vue"]]);const Y=(e=>(_("data-v-ea30e9fc"),e=e(),h(),e))((()=>f("span",{style:{"padding-left":"8px"}},"添加细则 ",-1)));var $=l(s({__name:"ruleForm",props:{categoryList:{type:Array,default:()=>[]}},setup(a,{expose:t}){const l=e.useForm,s=o({categoryId:"",ruleList:[{description:"",score:"",item:0}]}),v=w([]),f=o({categoryId:[{required:!0,message:"请选择评分类目"}],ruleList:[{required:!0,trigger:"blur",validator:(e,a)=>{let t="";for(let l=0;l<a.length;l++){const e=a[l];if(""===e.description.replace(/(^\s*)|(\s*$)/g,"")){v.value.push(l+1),t="请填写评分细则";break}if(""===e.score){v.value.push(l+1),t="请输入该项分值";break}}return t?Promise.reject(t):Promise.resolve()}}]}),{resetFields:_,validate:h,validateInfos:I}=l(s,f,{onValidate:(...e)=>{}});function U(){s.ruleList.push({description:"",score:"",item:0}),C((()=>{const e=document.querySelector(".ant-drawer-body"),a=e.clientHeight;0===e.scrollTop?e.scrollTo(0,a-220):e.scrollTo(0,e.scrollTop+208)}))}return t({validate:()=>(v.value=[],h()),resetFields:_,formInfo:r(s)}),(e,t)=>{const l=i("a-select-option"),o=i("a-select"),r=i("a-form-item"),f=i("a-textarea"),_=i("a-col"),h=i("a-input-number"),w=i("a-row"),C=i("close-circle-outlined"),T=i("a-button"),V=i("plus-outlined"),B=i("a-form");return n(),u(B,{layout:"vertical"},{default:d((()=>[c(r,p({label:"所属评分类目"},m(I).categoryId),{default:d((()=>[c(o,{value:s.categoryId,"onUpdate:value":t[0]||(t[0]=e=>s.categoryId=e),placeholder:"Please select a country"},{default:d((()=>[(n(!0),y(g,null,b(a.categoryList,((e,a)=>(n(),u(l,{value:e.id,key:a},{default:d((()=>[j(k(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1},16),c(r,p({label:"评分细则"},m(I).ruleList,{validateStatus:"success",class:"ruleList_formitem"}),{default:d((()=>[c(x,{name:"timeList"},{default:d((()=>[(n(!0),y(g,null,b(s.ruleList,((e,a)=>(n(),y("div",{key:a,class:"rule_item",style:L({border:""+(v.value.includes(a+1)?"1px solid #f5222d":"1px solid #00b78100"),marginBottom:s.ruleList.length>1?"16px":0})},[c(r,{labelCol:{span:24}},{default:d((()=>[c(f,{value:e.description,"onUpdate:value":a=>e.description=a,"show-count":"",rows:4,maxlength:100,placeholder:"请输入"},null,8,["value","onUpdate:value"])])),_:2},1024),c(w,{gutter:"24"},{default:d((()=>[c(_,{span:12},{default:d((()=>[c(r,{style:{display:"flex","flex-direction":"row","align-items":"baseline","margin-bottom":"0"},label:"该项评分细则为",labelCol:{span:13},"wrapper-col":{span:11}},{default:d((()=>[c(o,{value:e.item,"onUpdate:value":a=>e.item=a},{default:d((()=>[c(l,{value:0},{default:d((()=>[j("加分项")])),_:1}),c(l,{value:1},{default:d((()=>[j("减分项")])),_:1})])),_:2},1032,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024),c(_,{span:12},{default:d((()=>[c(r,{label:"该项分值为",style:{display:"flex","flex-direction":"row","align-items":"baseline","margin-bottom":"0"},labelCol:{span:10},"wrapper-col":{span:14}},{default:d((()=>[c(h,{placeholder:"请输入",value:e.score,"onUpdate:value":a=>e.score=a,min:0,max:100,precision:1},null,8,["value","onUpdate:value"])])),_:2},1024)])),_:2},1024)])),_:2},1024),s.ruleList.length>1?(n(),u(T,{key:0,type:"text",class:"remove_item",onClick:e=>function(e){s.ruleList.splice(e,1)}(a)},{default:d((()=>[c(C,{class:"remove_item__icon",title:"删除"})])),_:2},1032,["onClick"])):F("v-if",!0)],4)))),128))])),_:1}),c(T,{type:"primary",style:{background:"rgba(0, 183, 129, 0.08)",color:"#00b781","margin-top":"16px"},onClick:U},{icon:d((()=>[c(V)])),default:d((()=>[Y])),_:1})])),_:1},16)])),_:1})}}}),[["__scopeId","data-v-ea30e9fc"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/studentEvaluation/setup/components/ruleForm.vue"]]);const G={class:"assessment_activity"},J={style:{"text-align":"center"}};var Q=l(s({__name:"index",setup(e){var l;const{tableTypeList:s}=T(),r=w(0),p=w([]),v=o({columns:(null==(l=s[r.value])?void 0:l.columns)||[],drawerVisible:!1,drawerBtnLoading:!1,componentsType:1}),g=I((()=>{var e;let a="新增"+(null==(e=s[r.value])?void 0:e.title);if(2===r.value){const e=a.indexOf("设置");a=a.substr(0,e)}return a})),b=w(),_=w(),h=w();function x(){1===v.componentsType?b.value.validate().then((()=>{var e;v.drawerBtnLoading=!0;const t=b.value.formInfo;null==(e=V(t))||e.then((e=>{a.success(e.message),v.drawerVisible=!1,b.value.resetFields(),null==C||C.update()}))})).catch((e=>{})).finally((()=>{v.drawerBtnLoading=!1})):2===v.componentsType?h.value.validate().then((()=>{var e;v.drawerBtnLoading=!0;const t=h.value.formInfo;null==(e=B(t))||e.then((e=>{a.success(e.message),v.drawerVisible=!1,h.value.resetFields(),null==C||C.update()}))})).catch((e=>{})).finally((()=>{v.drawerBtnLoading=!1})):3===v.componentsType&&_.value.validate().then((()=>{var e;v.drawerBtnLoading=!0;const t=_.value.formInfo;null==(e=D(t))||e.then((e=>{a.success(e.message),v.drawerVisible=!1,_.value.resetFields(),null==C||C.update()}))})).catch((e=>{})).finally((()=>{v.drawerBtnLoading=!1}))}function L(){v.drawerVisible=!1}const C=e=>S(e);return(e,l)=>{const s=i("plus-outlined"),o=i("a-button"),w=i("a-drawer");return n(),y("div",G,[(n(),u(m(R),{columns:v.columns,key:r.value,loadData:C,rowKey:"id"},{handle:d((()=>[c(o,{type:"primary",style:{"margin-left":"12px"},onClick:l[0]||(l[0]=e=>(v.drawerVisible=!0,void(v.componentsType=3)))},{icon:d((()=>[c(s)])),default:d((()=>[j(" "+k(g.value),1)])),_:1})])),bodyCell:d((({column:e,record:l})=>["operation"===e.key?(n(),u(o,{key:0,type:"link",danger:"",onClick:e=>{return s=l.id,void t.confirm({title:"确定删除吗",icon:c(E),okText:"确定",okType:"danger",cancelText:"取消",onOk(){var e;null==(e=M([s]))||e.then((e=>{a.success(e.message),null==C||C.update()}))},onCancel(){}});var s},class:"btn btn_danger"},{default:d((()=>[j("删除")])),_:2},1032,["onClick"])):F("v-if",!0)])),_:1},8,["columns"])),F("  "),c(w,{visible:v.drawerVisible,"onUpdate:visible":l[1]||(l[1]=e=>v.drawerVisible=e),width:500,title:g.value,placement:"right"},{footer:d((()=>[f("div",J,[c(o,{style:{"margin-right":"8px"},onClick:L},{default:d((()=>[j("取消")])),_:1}),c(o,{type:"primary",loading:v.drawerBtnLoading,onClick:x},{default:d((()=>[j("确定")])),_:1},8,["loading"])])])),default:d((()=>[1===v.componentsType?(n(),u(m(P),{key:0,ref_key:"currentFormRef",ref:b},null,512)):F("v-if",!0),3===v.componentsType?(n(),u(m(N),{key:1,ref_key:"medalFormRef",ref:_},null,512)):F("v-if",!0),2===v.componentsType?(n(),u(m($),{key:2,categoryList:p.value,ref_key:"ruleFormRef",ref:h},null,8,["categoryList"])):F("v-if",!0)])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-7ee2885b"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/studentEvaluation/setup/index.vue"]]);export{Q as default};
