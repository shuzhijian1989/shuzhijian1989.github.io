import"./vue.a2f518ee.js";import{m as e}from"./ant-design-vue.db4d48e3.js";import{_ as a,ae as t}from"./index.7061e8ea.js";import{h as l,q as i,w as s,b8 as n,o,a as r,c as u,a3 as p,a2 as d,a7 as c,W as m,b as g,u as _,O as f,F as v,a8 as h,a9 as y,b5 as b,b4 as k,a5 as w,a4 as L,y as x}from"./@vue.919ff404.js";import{L as S}from"./@ant-design.2e172c39.js";import{_ as C}from"./defal_user.ed3800e6.js";import{a as j}from"./vue-router.907b547c.js";const M=e=>(b("data-v-3073a760"),e=e(),k(),e),U={style:{display:"inline-block"}},I={class:"upload_wap"},B={class:"upload"},P=M((()=>g("p",{class:"upload_format__hint upload_hint__rule"}," 仅支持上传jpeg/jpg/png格式文件，单个文件不能超过1M,单次最多可选200张 ",-1))),T={class:"upload_item__warp"},z={class:"upload_item_image__warp"},D={key:0},N=M((()=>g("div",{class:"upload_item__error__warp"},null,-1))),O={class:"upload_file__name"},$={title:"单击可以编辑名字"},A={class:"upload_hint"},F={class:"upload_hint__title"},G=M((()=>g("span",null,"照片命名规则：",-1))),E={class:"upload_hint__rule"};var J=a({__name:"batchCollect",props:{visible:Boolean,id:String,type:[String,Number],userId:String,title:String,multiple:{type:Boolean,default:!0},buttonType:{type:String,default:""},outsiders:{type:Boolean,default:!1},disableds:{type:Boolean,default:!1}},emits:["update:visible","changeMultiple","complete"],setup(a,{emit:b}){const k=a,w=l(S,{style:{fontSize:"24px"},spin:!0}),L=i({fileList:[],imageList:[],spinning:!1,progress:0,okText:"上传",visible:!1,image1M:!1});s((()=>k.visible),(e=>{L.visible=e,b("update:visible",e)})),s((()=>L.visible),(e=>{b("update:visible",e)}));const x=()=>{L.visible=!1,L.fileList=[],L.imageList=[],b("complete"),b("update:visible",!1)},C=async a=>{const{size:t,name:l,uid:i}=a;return t/1024/1024<1?(L.imageList.push({name:l,file:a,url:await J(a),uid:i,path:null,errorMsg:""}),L.fileList.push(a)):e.warning("上传图像须小于1MB！"),!1},j=()=>{if(L.fileList.length>200)return e.warning("超出限制，最多只能选择200张照片！");const a=JSON.parse(JSON.stringify(L.imageList));L.spinning=!0,L.progress=0;const l=[],i=[];for(let e=0;e<L.imageList.length;e++){const l=L.imageList[e],s=new FormData,{id:n,type:o,outsiders:r,userId:u}=k;s.append("file",l.file),s.append("id",n),s.append("type",r?3:o),u&&s.append("userId",u),t(s,(e=>{L.progress=e})).then((t=>{const l=t.data;l.length&&(L.imageList.forEach(((e,a)=>{const t=l.find((a=>a.fileName===e.name));t&&t.status&&(e.errorMsg=t.errorInfo,t.errorInfo&&i.push(t.errorInfo))})),a.length-1===e&&(L.spinning=!1),i.length||a.length-1!==e||setTimeout((()=>{x()}),1e3))})).catch((()=>{L.spinning=!1}))}l.length&&(L.fileList=l,L.imageList=l)},M=()=>{L.imageList=[],L.fileList=[],b("changeMultiple"),L.visible=!0,b("update:visible",!0)},J=e=>new Promise(((a,t)=>{const l=new FileReader;l.readAsDataURL(e),l.onload=()=>a(l.result),l.onerror=e=>t(e)}));return(e,t)=>{const l=n("plus-outlined"),i=n("a-button"),s=n("a-upload"),b=n("a-image"),S=n("close-circle-filled"),J=n("exclamation-circle-filled"),R=n("a-tooltip"),q=n("a-col"),V=n("a-row"),W=n("a-spin"),H=n("a-modal");return o(),r("div",U,[u(i,{onClick:M,type:a.buttonType,disabled:k.disableds},{icon:p((()=>[a.buttonType?(o(),d(l,{key:0})):c("v-if",!0)])),default:p((()=>[m(e.$slots,"default",{},void 0,!0)])),_:3},8,["type","disabled"]),u(H,{visible:L.visible,"onUpdate:visible":t[0]||(t[0]=e=>L.visible=e),title:a.multiple?"批量采集":"个人采集",onOk:j,okButtonProps:{loading:L.spinning,disabled:!L.imageList.length},onCancel:x,width:"700px",okText:L.okText},{default:p((()=>[g("div",null,[c("  "),g("div",I,[u(W,{tip:`${L.progress}%`,indicator:_(w),spinning:L.spinning},{default:p((()=>[g("div",B,[u(s,{"before-upload":C,showUploadList:!1,fileList:L.fileList,name:"file",multiple:a.multiple,action:"/",class:"upload_comp",accept:"image/png,image/jpg,image/jpeg"},{default:p((()=>[u(i,{type:"primary",ghost:"",style:{"margin-top":"75px"},disabled:!a.multiple&&L.imageList.length>199},{default:p((()=>[f(" 选择照片 ")])),_:1},8,["disabled"])])),_:1},8,["fileList","multiple"]),P]),c(" 已上传图片 "),u(V,{gutter:[24,24],class:"upload_list"},{default:p((()=>[(o(!0),r(v,null,h(L.imageList,((e,a)=>(o(),d(q,{span:4,key:e.id+"image"+a},{default:p((()=>[g("div",T,[g("div",z,[u(b,{class:"upload_item_image",preview:!1,width:"86px",height:"86px",src:e.url},null,8,["src"]),c(" remove "),u(S,{class:"upload_item__remove",title:"删除",onClick:e=>(e=>{L.imageList.splice(e,1),L.fileList.splice(e,1)})(a)},null,8,["onClick"]),c(" error "),e.errorMsg?(o(),r("div",D,[N,u(R,{placement:"top"},{title:p((()=>[f(y(e.errorMsg),1)])),default:p((()=>[u(J,{class:"upload_item__error"})])),_:2},1024)])):c("v-if",!0)]),c(" inpurt "),g("div",O,[g("span",$,y(e.name),1),c(" <a-input></a-input> ")])])])),_:2},1024)))),128))])),_:1})])),_:1},8,["tip","indicator","spinning"])])]),g("div",A,[g("div",F,[u(J,{class:"upload_hint__icon"}),G]),g("div",E,' 教职工和学生的照片文件命名为“姓名”，如 "张三" '+y(a.outsiders?"":"，如存在重名情况，则教职工重名命名为“姓名-手机号”，学生重名命名为“姓名-学籍号”"),1)])])),_:1},8,["visible","title","okButtonProps","okText"])])}}},[["__scopeId","data-v-3073a760"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/basicManagement/faceLibrary/components/batchCollect.vue"]]);const R={class:"personnel_item"},q=["onClick"],V={class:"personnel_item__upload"},W={key:0,src:C,alt:"",style:{width:"100%",height:"100%"}},H={style:{padding:"12px 0 12px 0","text-align":"center",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},K=["title"];var Q=a({__name:"faceList",props:{mode:{type:String,default:"multiple"},data:{type:Array,default:()=>[]},selectUserIds:{type:Array,default:()=>[]}},emits:["open","changeSelect"],setup(e,{emit:a}){const t=e,l=j(),m=i({checkboxGroup:[]});s((()=>t.selectUserIds),(e=>{m.checkboxGroup=e}));const b=e=>{a("changeSelect",e)};return(t,i)=>{const s=n("a-image"),k=n("plus-outlined"),x=n("a-checkbox"),S=n("a-col"),C=n("a-row"),j=n("a-checkbox-group"),M=n("a-empty");return o(),r(v,null,[g("div",null,[u(j,{value:m.checkboxGroup,"onUpdate:value":i[0]||(i[0]=e=>m.checkboxGroup=e),style:{width:"100%"},class:"personnel_list__warp",onChange:b},{default:p((()=>[u(C,{gutter:[16,16]},{default:p((()=>[(o(!0),r(v,null,h(e.data,((t,i)=>(o(),d(S,{md:3,lg:6,xl:4,xxl:3,class:"personnel_item__warp",key:i},{default:p((()=>[c("  "),g("div",R,[c(" 已上传 "),g("div",{class:"personnel_item__upload__warp",onClick:e=>(e=>{var t;const i=((null==(t=l.meta)?void 0:t.btnList)||[]).map((e=>e.value));(i.includes("batchCollection")||i.includes("faceLibraryOutsiders"))&&a("open",e)})(t)},[g("div",{style:w({background:`url(${t.imgPath?t.imgPath+"?x-oss-process=image/resize,h_100,m_lfit":"/image/defal_user.png"})`,filter:"blur(20px)",width:"100%",height:"100%",position:"absolute",backgroundSize:"auto",overflow:"hidden"})},null,4),0==t.collect?(o(),d(s,{key:0,class:"image",preview:!1,width:"100%",src:""+(t.imgPath?t.imgPath+"?x-oss-process=image/resize,h_128,m_lfit":"/image/defal_user.png")},null,8,["src"])):(o(),r(v,{key:1},[c(" 未上传 "),g("div",V,["multiple"==e.mode?(o(),r("img",W)):(o(),d(k,{key:1,class:"personnel_item__upload_icon"}))])],2112)),"faceLibraryCustom"===_(l).name&&t.imgPath?(o(),r("span",{key:2,class:L(["status_label",{active:t.status}])},y(t.status?"失效":"生效"),3)):c("v-if",!0)],8,q),c("  "),g("div",H,["multiple"==e.mode?(o(),d(x,{key:0,value:t.id,title:t.name},{default:p((()=>[f(y(t.name),1)])),_:2},1032,["value","title"])):(o(),r("span",{key:1,title:t.name},y(t.name),9,K))])]),c("  ")])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"]),c("  "),e.data.length?c("v-if",!0):(o(),d(M,{key:0,image:"/image/faceEmpty.png","image-style":{height:"180px"},description:"暂无搜索匹配结果"}))]),c("  ")],2112)}}},[["__scopeId","data-v-41441adb"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/basicManagement/faceLibrary/components/faceList.vue"]]);var X=a({__name:"faceSearch",props:{placeholder:String,status:{type:Number,default:1},name:String,data:{type:Array,BVdefault:()=>[]}},emits:["search","update:name","update:status"],setup(e,{emit:a}){const t=e,l=x((()=>t.placeholder)),i=x((()=>t.name)),s=x((()=>t.status)),c=x((()=>t.data)),m=e=>{a("update:status",e.target.value),a("search",{name:t.name,status:e.target.value})},_=e=>{a("update:name",e.target.value)},b=()=>{a("search",{name:t.name,status:t.status})};return(e,a)=>{const t=n("a-radio-button"),k=n("a-radio-group"),L=n("a-col"),x=n("a-input"),S=n("a-form-item"),C=n("a-button"),j=n("a-form"),M=n("a-row");return o(),d(M,{type:"flex"},{default:p((()=>[u(L,{style:{"margin-bottom":"16px"}},{default:p((()=>[u(k,{value:s.value,"onUpdate:value":a[0]||(a[0]=e=>s.value=e),"button-style":"solid",onChange:m},{default:p((()=>[(o(!0),r(v,null,h(c.value,((e,a)=>(o(),d(t,{value:e.value,key:`tab_${a}`},{default:p((()=>[f(y(e.label)+"（",1),g("span",{style:w({color:a==c.value.length-1&&"#f8535c"})},y(e.count),5),f("） ")])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),u(L,{style:{"margin-left":"12px"}},{default:p((()=>[u(j,{layout:"inline"},{default:p((()=>[u(S,null,{default:p((()=>[u(x,{value:i.value,"onUpdate:value":a[1]||(a[1]=e=>i.value=e),onChange:_,placeholder:l.value,max:"100"},null,8,["value","placeholder"])])),_:1}),u(S,null,{default:p((()=>[u(C,{type:"primary",onClick:b},{default:p((()=>[f("查 询")])),_:1})])),_:1}),u(S,null,{default:p((()=>[u(C,{onClick:a[2]||(a[2]=a=>e.$emit("reset"))},{default:p((()=>[f("重 置")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/basicManagement/faceLibrary/components/faceSearch.vue"]]);export{J as B,X as F,Q as a};
