import{D as e}from"./index.1cbb3529.js";import"./vue.a2f518ee.js";import{a as t}from"./vue-router.907b547c.js";import{F as a,B as s,a as i}from"./faceSearch.43b839f6.js";import{_ as l,ag as n,ah as o}from"./index.7061e8ea.js";import{q as d,f as r,b8 as p,I as u,o as c,a2 as m,a3 as f,c as g,a as b,a9 as y,a7 as j,b as h,H as v,O as x}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";import"./defal_user.ed3800e6.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const I={key:0},_={class:"faceLibrary_type__title"},C={style:{padding:"0 16px 16px 16px"}},q={style:{display:"flex"}};var S=l({__name:"index",setup(l){const S=t(),L=d({treeDataChild:0,outsidersTitle:"",treeSpinning:!1,listSpinning:!1,groupIndex:0,treeData:[],defaultExpand:[],selectedKeys:[],fieldNames:{children:"children",title:"name",key:"id"},query:{id:"",type:4,status:1,name:null},outsiders:"1"===S.query.type,multipleUpload:!0,batchCollectVisible:!1,selectUserIds:[],facePageList:[],singleCollect:{userId:""},activeId:"",statusList:[{label:"全部",value:1,count:0},{label:"已采集",value:2,count:0},{label:"未采集",value:3,count:0}],pagination:{pageNo:1,pageSize:20,total:0}}),U=()=>{L.listSpinning=!0;const e={...L.query,...L.pagination};o(e).then((e=>{var t;const{list:a,pageNo:s,pageSize:i,total:l}=null==(t=e.data)?void 0:t.page,{countAll:n,count:o}=e.data;L.statusList[0].count=n||0,L.statusList[1].count=o||0,L.statusList[2].count=n-o||0,L.facePageList=a||[],L.pagination.pageNo=s||1,L.pagination.pageSize=i||20,L.pagination.total=l||0,S.query.deptId&&(L.selectedKeys=[S.query.deptId])})).catch((()=>{L.statusList[0].count=0,L.statusList[1].count=0,L.statusList[2].count=0,L.facePageList=[],L.pagination.pageNo=1,L.pagination.pageSize=20,L.pagination.total=0})).finally((()=>{L.listSpinning=!1}))},D=(e,t)=>{L.groupIndex=L.treeData.findIndex((t=>t.id===e)),L.selectedKeys=[e],L.defaultExpand=[e],L.query.id=e,L.outsidersTitle=`${t.name}${t.numberCount?"（"+t.numberCount+"）":""}`,U()},N=()=>{L.pagination.pageNo=1,L.pagination.pageSize=20,U()},E=()=>{L.query.name="",L.pagination.pageNo=1,L.pagination.pageSize=20,U()},K=()=>{L.multipleUpload=!0,L.singleCollect.userId="",U()},z=e=>{L.singleCollect.userId=e.id,L.batchCollectVisible=!0,L.multipleUpload=!1},w=e=>{L.singleCollect.userId=e.id,L.batchCollectVisible=!0,L.multipleUpload=!1},T=()=>{U()};return r((()=>{n().then((({data:e})=>{if(e.length){let{id:t,name:a,numberCount:s}=e[L.groupIndex];S.query.deptId&&(t=S.query.deptId),L.defaultExpand=[t],L.selectedKeys=[t],L.query.id=t,L.outsidersTitle=`${a}${s?"（"+s+"）":""}`,U()}else L.defaultExpand=["-10000"],L.selectedKeys=["-10000"],L.outsidersTitle="外部人员";L.treeDataChild=e.length,L.treeData=[{name:"外部人员",id:"-10000",children:e}]}))})),(t,l)=>{const n=e,o=p("a-spin"),d=p("a-col"),r=p("a-row"),S=u("auth");return c(),m(r,{type:"flex",class:"faceLibrary_warp_pageitem"},{default:f((()=>[g(d,{class:"demp_tree"},{default:f((()=>[g(o,{spinning:L.treeSpinning},{default:f((()=>[g(n,{style:{"min-height":"200px",transition:"all 0.25s"},ref:"dempTree",treeData:L.treeData,selectedKeys:L.selectedKeys,defaultExpand:L.defaultExpand,isDraggable:!0,fieldNames:L.fieldNames,onEmitSelect:D},{handleItem:f((({handleItem:e})=>[e.numberCount?(c(),b("span",I," （"+y(e.numberCount)+"） ",1)):j("v-if",!0)])),_:1},8,["treeData","selectedKeys","defaultExpand","fieldNames"])])),_:1},8,["spinning"])])),_:1}),g(d,{style:{flex:"1"}},{default:f((()=>[h("div",_,y(L.outsidersTitle),1),g(o,{spinning:L.listSpinning},{default:f((()=>[h("div",C,[g(r,{type:"flex",justify:"space-between"},{default:f((()=>[g(d,null,{default:f((()=>[g(a,{status:L.query.status,"onUpdate:status":l[0]||(l[0]=e=>L.query.status=e),name:L.query.name,"onUpdate:name":l[1]||(l[1]=e=>L.query.name=e),placeholder:"请输入学生姓名搜索",onSearch:N,onReset:E,data:L.statusList},null,8,["status","name","data"])])),_:1}),g(d,{style:{"margin-bottom":"16px"}},{default:f((()=>[h("div",q,[v((c(),m(s,{title:"批量采集",outsiders:L.outsiders,multiple:L.multipleUpload,id:L.query.id,type:3,userId:L.singleCollect.userId,visible:L.batchCollectVisible,"onUpdate:visible":l[2]||(l[2]=e=>L.batchCollectVisible=e),onChangeMultiple:K,onComplete:T},{default:f((()=>[x(" 批量采集 ")])),_:1},8,["outsiders","multiple","id","userId","visible"])),[[S,"batchCollection"]])])])),_:1})])),_:1}),j(" 人脸列表 "),g(i,{mode:"none",data:L.facePageList,style:{"min-height":"500px"},selectUserIds:L.selectUserIds,onOpen:w,onChangeSelect:z},null,8,["data","selectUserIds"])])])),_:1},8,["spinning"])])),_:1})])),_:1})}}},[["__scopeId","data-v-9f5976e0"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/basicManagement/faceLibrary/outsiders/index.vue"]]);export{S as default};
