import"./vue.a2f518ee.js";import{m as e}from"./ant-design-vue.db4d48e3.js";import{b as i,c as a,e as t,f as s,h as l,u as o,i as n,j as r,k as d}from"./exam.ac418e80.js";import{_ as u,L as c,u as m,p}from"./index.7061e8ea.js";import{d as v}from"./dayjs.49e29cb2.js";import{a as g,u as f}from"./vue-router.907b547c.js";import{q as b,y,r as h,f as L,b8 as x,o as C,a2 as k,a3 as I,c as w,u as j,O as N,b as _,a7 as T,w as S,Q as A,W as K,R as U,a as M,F as q,a9 as P,a8 as R,a4 as D,D as E,n as V,b5 as Y,b4 as H,s as F,A as O,aA as B}from"./@vue.919ff404.js";import{e as $}from"./@vueuse.66569c4a.js";import{v as z}from"./uuid.73c2ed78.js";import"./@babel.6d5f88cb.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const J=b({signIn:!1,showed:!0}),G=()=>{for(const e in J)delete J[e];J.signIn=!1,J.showed=!0};function W(){return{formState:J,resetState:G}}const Q={class:"rangeBox"},X={class:"signInEnd"};var Z=u({__name:"examInfo",setup(e,{expose:a}){const t=g(),{formState:s,resetState:l}=W(),o=y((()=>"look"===t.query.type)),n=e=>e&&e<v().subtract(1,"day"),r=h(),d=(e,i)=>s.startTime&&s.endTime?v(s.endTime).isBefore(v(s.startTime))?Promise.reject(new Error("考试结束日期不能提前于考试开始日期!")):Promise.resolve():Promise.reject(new Error("请选择考试日期!"));return L((()=>{t.query.id&&(async()=>{const{data:e}=await i({id:t.query.id});s.name=e.name,s.showed=e.showed,s.signIn=e.signIn,s.startTime=e.startTime,s.endTime=e.endTime,s.startMinute=e.startMinute,s.endMinute=e.endMinute})(),1===c.get("examNewForm")&&l()})),a({formState:s,infoFormRef:r}),(e,i)=>{const a=x("a-input"),t=x("a-form-item"),l=x("a-date-picker"),u=x("a-form-item-rest"),c=x("a-radio"),m=x("a-radio-group"),p=x("a-input-number"),v=x("a-form");return C(),k(v,{class:"info-form",ref_key:"infoFormRef",ref:r,autocomplete:"off",layout:"vertical",model:j(s)},{default:I((()=>[w(t,{label:"考试名称",name:"name",rules:[{required:j(s).name,message:"请输入考试名称!",required:!0}]},{default:I((()=>[w(a,{"show-count":"",disabled:o.value,style:{width:"556px"},maxlength:30,value:j(s).name,"onUpdate:value":i[0]||(i[0]=e=>j(s).name=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["disabled","value"])])),_:1},8,["rules"]),w(t,{label:"考试日期",name:"examTime",validateTrigger:"onSubmit",rules:[{validator:d,required:!0,trigger:["submit"]}]},{default:I((()=>[w(l,{disabled:o.value,style:{width:"47%","margin-right":"32px"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","disabled-date":n,value:j(s).startTime,"onUpdate:value":i[1]||(i[1]=e=>j(s).startTime=e),placeholder:"开始日期"},null,8,["disabled","value"]),w(u,null,{default:I((()=>[w(l,{disabled:o.value,style:{width:"47%"},value:j(s).endTime,"onUpdate:value":i[2]||(i[2]=e=>j(s).endTime=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","disabled-date":n,placeholder:"结束日期"},null,8,["disabled","value"])])),_:1})])),_:1},8,["rules"]),w(t,{label:"考试签到",name:"signIn",rules:[{required:j(s).signIn,message:"请选择考试签到!",required:!0}]},{default:I((()=>[w(m,{value:j(s).signIn,"onUpdate:value":i[3]||(i[3]=e=>j(s).signIn=e),disabled:o.value,name:"signIn"},{default:I((()=>[w(c,{value:!0},{default:I((()=>[N("要求签到")])),_:1}),w(c,{value:!1},{default:I((()=>[N("不要求签到")])),_:1})])),_:1},8,["value","disabled"]),j(s).signIn?(C(),k(u,{key:0},{default:I((()=>[_("div",Q,[_("div",X,[N(" 考试开场前 "),w(p,{disabled:o.value,id:"inputNumber",value:j(s).startMinute,"onUpdate:value":i[4]||(i[4]=e=>j(s).startMinute=e),min:0,max:60,defaultValue:0},null,8,["disabled","value"]),N("分钟，方可允许签到；考试开场 "),w(p,{disabled:o.value,id:"inputNumber",value:j(s).endMinute,"onUpdate:value":i[5]||(i[5]=e=>j(s).endMinute=e),min:0,max:60,defaultValue:0},null,8,["disabled","value"]),N("分钟后，不允许签到 ")])])])),_:1})):T("v-if",!0)])),_:1},8,["rules"]),w(t,{label:"准考证号",name:"showed",rules:[{required:j(s).showed,message:"请选择是否显示准考证号!",required:!0}]},{default:I((()=>[w(m,{disabled:o.value,value:j(s).showed,"onUpdate:value":i[6]||(i[6]=e=>j(s).showed=e),name:"showed"},{default:I((()=>[w(c,{value:!1},{default:I((()=>[N("不显示")])),_:1}),w(c,{value:!0},{default:I((()=>[N("显示")])),_:1})])),_:1},8,["disabled","value"])])),_:1},8,["rules"])])),_:1},8,["model"])}}},[["__scopeId","data-v-04290102"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/comp/examInfo.vue"]]);var ee=u({__name:"index",props:{columns:{type:Array,default:()=>[]},dataSource:{type:Array,default:()=>[]},rowKeyId:{type:[Function,String],default:"id"},isRadio:{type:Boolean,default:!1},rowSelection:{type:Boolean,default:!1},selectedRowKeys:{type:Array,default:()=>[]},paginations:{type:Object,default:()=>({pageNo:1,pageSize:1e3,total:0})},spinning:{type:Boolean,default:!1},bordered:{type:Boolean,default:!0},scrolls:{type:Object,default:()=>{}}},emits:["change","selectChange"],setup(e,{emit:i}){const a=e,t=b({selectedRowKeys:a.selectedRowKeys||[],paginationAttr:{total:0,current:1,pageSize:10,hideOnSinglePage:!0,showLessItems:!0,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],...a.paginations,showTotal:e=>`共 ${e}  条`}});S((()=>a.paginations),(({pageNo:e,pageSize:i,total:a})=>{t.paginationAttr.current=e,t.paginationAttr.pageSize=i,t.paginationAttr.total=a,t.paginationAttr.hideOnSinglePage=a<11})),S((()=>a.selectedRowKeys),(e=>{t.selectedRowKeys=e}));const s=A(["bottomLeft"]),l=e=>{const{current:a,pageSize:t,total:s}=e;i("change",{pageNo:a,pageSize:t,total:s})},o=(e,a)=>{t.selectedRowKeys=e,i("selectChange",e,a)};return L((()=>{})),(i,a)=>{const n=x("a-empty"),r=x("a-table"),d=x("a-spin");return C(),k(d,{spinning:e.spinning},{default:I((()=>[w(r,{columns:e.columns,"data-source":e.dataSource,align:"center",bordered:e.bordered,pagination:t.paginationAttr,position:s.value,onChange:l,scroll:e.scrolls,"row-key":e.rowKeyId,"row-selection":e.rowSelection?{selectedRowKeys:t.selectedRowKeys,onChange:o,type:e.isRadio?"radio":"checkbox"}:null},{headerCell:I((({column:e,text:a,record:t,index:s})=>[K(i.$slots,"headerCell",{column:e,text:a,record:t,index:s})])),bodyCell:I((({column:e,text:a,record:t,index:s})=>[K(i.$slots,"bodyCell",{column:e,text:a,record:t,index:s})])),emptyText:I((()=>[K(i.$slots,"emptyText",{},(()=>[w(n,{image:"/image/empty.png","image-style":{width:"100%",height:"180px"}})]))])),_:3},8,["columns","data-source","bordered","pagination","position","scroll","row-key","row-selection"])])),_:3},8,["spinning"])}}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/table/index.vue"]]);const ie=[{title:"考试科目",key:"subjectName",dataIndex:"subjectName",width:"90px"},{title:"考试时间",key:"timeList",dataIndex:"timeList",width:"300px"},{title:"考试时长",key:"duration",dataIndex:"duration",width:"90px"},{title:"主考员",key:"chiefListArr",dataIndex:"chiefListArr",width:"300px"},{title:"巡考员",key:"inspectorListArr",dataIndex:"inspectorListArr",width:"300px"}],ae=[{title:"考场名称",key:"name",dataIndex:"name"},{title:"考场地点",key:"buildingName",dataIndex:"buildingName"},{title:"考场教室",key:"siteName",dataIndex:"siteName"},{title:"考场容量",key:"examPeopleNum",dataIndex:"examPeopleNum"},{title:"考场规格",key:"specification",dataIndex:"specification"},{title:"监考老师",key:"invigilatorTeachName",dataIndex:"invigilatorTeachName"},{title:"操作",key:"operation",dataIndex:"operation"}],te=[{title:"考场名称",key:"name",dataIndex:"name"},{title:"考场地点",key:"buildingName",dataIndex:"buildingName"},{title:"考场教室",key:"siteName",dataIndex:"siteName"},{title:"考场容量",key:"examPeopleNum",dataIndex:"examPeopleNum"},{title:"考场规格",key:"specification",dataIndex:"specification"},{title:"监考老师",key:"invigilatorTeachName",dataIndex:"invigilatorTeachName"}],se=[{title:"建筑",key:"buildingName",dataIndex:"buildingName"},{title:"场地名称",key:"name",dataIndex:"name"},{title:"容纳人数（人）",key:"peppleNum",dataIndex:"peppleNum"}],le=[{title:"课程",key:"subjectName",dataIndex:"subjectName"},{title:"考试时间",key:"timeList",dataIndex:"timeList"},{title:"监考老师",key:"invigilator",dataIndex:"invigilator"}];function oe(){return{subColumns:ie,lookRoomColumns:te,roomColumns:ae,buildColumns:se,teachColumns:le}}function ne(e){const i=[];e.forEach((e=>{const a={name:e.subjectName,person:[]},t={person_name:e.personName,person_id:e.personId};a.person.push(t),i.push(a)}));const a=[],t={};i.forEach(((e,s)=>{t[e.name]?a.forEach((e=>{e.name===i[s].name&&(e.person=e.person.concat(i[s].person))})):(a.push(e),t[e.name]=!0)}));return a.map((e=>{const i=e.person.map((e=>e.person_name));return`${e.name}:${i.join("、")}`})).join(";")}const re={class:"btnClass"},de={key:0,class:"subDelBtn"},ue={key:1},ce={key:0},me={key:1},pe={key:0},ve={key:1},ge={key:0},fe={key:1},be={class:"gradeBox"},ye={class:"gradeTitle"},he={key:0},Le={class:"arrange"},xe=(e=>(Y("data-v-37575d45"),e=e(),H(),e))((()=>_("div",{class:"titleText"},"考场布置：",-1))),Ce={class:"examRadio"},ke={key:1},Ie={key:0,class:"classdelBtn"},we={key:5,style:{display:"flex"}},je={class:"teachNameJoin"},Ne=["onClick"],_e=["onClick"],Te={class:"courseModal"},Se={class:"courseModal"},Ae={class:"courseModal"},Ke={class:"teacherModal"};var Ue=u({__name:"unify",setup(i,{expose:o}){const n=m(),{subColumns:r,roomColumns:d,buildColumns:u,teachColumns:c,lookRoomColumns:f}=oe(),A=g(),K=y((()=>"look"===A.query.type)),Y=y((()=>{const e=[];return n.state.base.commentJsonKeys.INIT_ROLL_LIST.forEach((i=>"grade"!==i.key&&e.push(i.level))),e})),H=y((()=>n.state.base.schoolRollTree)),F=h(),O=b({selectTabs:[{tab:"选择年级",key:2,checked:!0,disabled:Y}],teacherCheckedList:[],gradeCheckedList:[],buildArr:[],Keys:[],buildKeys:[],classVisible:!1,managerVisible:!1,gridType:"1",setTeacherShow:!1,amendExamination:!1,examination:!1,visible:!1,courseVisible:!1,subjectList:[],roomSource:[],buildSource:[],groupConfigList:[],courseValue:[]}),B=h(),J=h(),G=(e,i)=>Z.row&&Z.cell?Promise.resolve():Promise.reject(new Error("请输入考场规格!")),W=(e,i)=>ie.line&&ie.column?Promise.resolve():Promise.reject(new Error("请输入考场规格!")),Q=(e,i)=>O.buildArr.length?Promise.resolve():Promise.reject(new Error("请选择考场建筑!")),X=h([]),Z=b({}),ie=b({}),ae=y((()=>e=>(e.duration=v(e.timeList[1]).diff(v(e.timeList[0]),"minute"),e.duration))),te=h([]),se=()=>{O.Keys=[],O.subjectList.length?O.courseValue=O.subjectList.map((e=>e.basicsSubjectId)):O.courseValue=[],O.courseVisible=!0},le=()=>{O.courseVisible=!1},Ue=()=>{O.courseVisible=!1,O.subjectList=Me.value.map((e=>{var i,a,t,s,l;const o=O.subjectList.findIndex((i=>i.basicsSubjectId===e.basicsSubjectId)),n=(null==(i=O.subjectList[o])?void 0:i.timeList)||[],r=(null==(a=O.subjectList[o])?void 0:a.chiefListArr)||[],d=(null==(t=O.subjectList[o])?void 0:t.chiefList)||[],u=(null==(s=O.subjectList[o])?void 0:s.inspectorListArr)||[],c=(null==(l=O.subjectList[o])?void 0:l.inspectorList)||[];return{...e,chiefListArr:r,timeList:n,chiefList:d,inspectorListArr:u,inspectorList:c}}))},Me=y((()=>te.value.filter((e=>O.courseValue.includes(e.id))).map((e=>({id:e.id,basicsSubjectId:e.id,subjectName:e.name,chiefListArr:[],timeList:[]}))))),qe=$((async(e,i,a)=>{if(2===e.target.value)try{const{data:e}=await l({objectId:i.objectId});e||e.length?i.siteList=e:(i.examinationArrange=1,i.siteList=[])}catch(t){i.examinationArrange=1,i.siteList=[]}else i.siteList=[]}),1e3,{maxWait:3e3}),Pe=async()=>{if(Z.examPeopleNum){const{data:e}=await a({examPeopleNum:Z.examPeopleNum});X.value=e}else e.destroy(),e.warning("请输入考场容量!")},Re=()=>{B.value.resetFields(),Z.row=null,Z.cell=null,O.buildArr=[],O.buildKeys=[],O.buildSource=[],O.examination=!1},De=()=>{B.value.validateFields().then((()=>{const i=O.buildArr.map((e=>({cell:Z.cell,examPeopleNum:Z.examPeopleNum,row:Z.row,name:e.buildingName+e.name,siteId:e.id,id:z(),buildingName:e.buildingName,siteName:e.name,sitePeopleNum:e.peppleNum,invigilatorList:[],teacherTableList:[]}))),a=[];O.groupConfigList.forEach((e=>{var i;null==(i=e.siteList)||i.forEach((e=>a.push(e.siteId)))}));O.buildArr.map((e=>a.includes(e.id))).includes(!0)?e.warning("考场场地已被选择不允许重复勾选!"):(i.forEach((e=>{O.groupConfigList[O.roomIndex].siteList.push(e)})),B.value.resetFields(),Z.row=null,Z.cell=null,O.buildArr=[],O.buildKeys=[],O.buildSource=[],O.examination=!1)}))},Ee=(e,i)=>{O.Keys=e},Ve=()=>{O.Keys.forEach((e=>{O.subjectList.splice(O.subjectList.findIndex((i=>i.basicsSubjectId===e)),1)})),O.Keys=[]},Ye=e=>{O.buildArr=[],O.buildKeys=[],X.value.forEach((i=>{i.id===e&&(O.buildSource=i.siteList)}))},He=(e,i)=>{O.buildKeys=e,O.buildArr=i},Fe=y((()=>U(O.Keys).length>0)),Oe=(e,i,a)=>{var t,s,l;"chiefList"===a&&(null==(t=e.chiefList)?void 0:t.length)?O.teacherCheckedList=e.chiefList.map((e=>({id:e.personId,showName:e.personName}))):"inspectorList"===a&&(null==(s=e.inspectorList)?void 0:s.length)?O.teacherCheckedList=e.inspectorList.map((e=>({id:e.personId,showName:e.personName}))):"invigilator"===a&&(null==(l=e.invigilatorTeacher)?void 0:l.length)?O.teacherCheckedList=e.invigilatorTeacher.map((e=>({id:e.personId,showName:e.personName}))):O.teacherCheckedList=[],O.thisNum=i,O.personType=a,O.managerVisible=!0},Be=i=>{"invigilator"!==O.personType?"chiefList"===O.personType&&i.length<=2?(O.subjectList[O.thisNum].chiefList=i.map((e=>({personId:e.id,personName:e.showName}))),O.subjectList[O.thisNum].chiefListArr=i.map((e=>e.id))):"inspectorList"===O.personType&&i.length<=2?(O.subjectList[O.thisNum].inspectorList=i.map((e=>({personId:e.id,personName:e.showName}))),O.subjectList[O.thisNum].inspectorListArr=i.map((e=>e.id))):e.warning("每个考试科目主考员或巡考员最多只能选择两名人员!"):i.length<=10?(O.setTeacherList[O.thisNum].invigilatorTeacher=i.map((e=>({personId:e.id,personName:e.showName}))),O.setTeacherList[O.thisNum].invigilator=i.map((e=>e.id))):e.warning("每个考试科目监考老师最多只能选择10名人员!")},$e=()=>{O.classVisible=!0},ze=e=>{O.gradeName=e.map((e=>e.showName)).join("；"),O.groupList=e.map((e=>({objectId:e.id,objectName:e.showName}))),O.groupConfigList=Je.value.map((e=>{var i,a,t,s,l,o;const n=O.groupConfigList.findIndex((i=>i.objectId===e.id)),r=(null==(i=O.groupConfigList[n])?void 0:i.objectId)||e.id,d=(null==(a=O.groupConfigList[n])?void 0:a.objectName)||e.objectName,u=(null==(t=O.groupConfigList[n])?void 0:t.examinationArrange)||1,c=(null==(s=O.groupConfigList[n])?void 0:s.siteList)||[],m=(null==(l=O.groupConfigList[n])?void 0:l.roomKeys)||[],p=(null==(o=O.groupConfigList[n])?void 0:o.subjectList)||[];return{...e,objectId:r,objectName:d,examinationArrange:u,siteList:c,roomKeys:m,subjectList:p}}))},Je=y((()=>O.gradeCheckedList.map((e=>({id:e.id,objectId:e.id,objectName:e.showName,examinationArrange:1,subjectList:[],siteList:[],roomKeys:[]}))))),Ge=()=>{if(O.setTeacherList.every((e=>{var i;return(null==(i=e.invigilator)?void 0:i.length)>0}))){O.groupConfigList[O.boxIndex].siteList[O.lineIndex].teacherTableList=O.setTeacherList;const e=[];O.setTeacherList.forEach((i=>{i.invigilatorTeacher.forEach((a=>{a.subjectName=i.subjectName,a.subjectId=i.subjectId,e.push(a)}))})),O.groupConfigList[O.boxIndex].siteList[O.lineIndex].invigilatorList=e,O.setTeacherShow=!1}else e.warning("考试每门科目必须设置监考老师!")},We=()=>{O.setTeacherShow=!1},Qe=()=>{J.value.resetFields(),ie.line=null,ie.column=null,O.amendExamination=!1},Xe=()=>{J.value.validateFields().then((()=>{Number(ie.districtCapacity)>Number(ie.capacity)?e.warning("考场容量必须要小于等于场地容量!"):(O.groupConfigList[O.boxIndex].siteList[O.lineIndex].name=ie.designation,O.groupConfigList[O.boxIndex].siteList[O.lineIndex].row=ie.line,O.groupConfigList[O.boxIndex].siteList[O.lineIndex].cell=ie.column,O.groupConfigList[O.boxIndex].siteList[O.lineIndex].examPeopleNum=ie.districtCapacity,O.amendExamination=!1)}))};return S((()=>O.gradeCheckedList),((e,i)=>{O.groupList=e.map((e=>({objectId:e.id,objectName:e.showName}))),O.gradeName=e.map((e=>e.showName)).join("；")}),{deep:!0}),S((()=>Z.examPeopleNum),((e,i)=>{Z.location=null,X.value=[],O.buildArr=[],O.buildKeys=[],O.buildSource=[]}),{deep:!0}),L((()=>{(async()=>{const{data:e}=await t();te.value=e})(),A.query.id&&(async()=>{const{data:e}=await s({id:A.query.id});O.subjectList=e.subjectList,O.groupList=e.groupList,O.groupConfigList=e.groupConfigList,O.gradeCheckedList=e.groupList.map((e=>({id:e.objectId,showName:e.objectName}))),O.gradeName=e.groupList.map((e=>e.objectName)).join("；")})()})),o({state:O}),(i,a)=>{const t=x("a-button"),s=x("a-range-picker"),l=x("plus-outlined"),o=x("a-select"),n=x("down-outlined"),m=x("a-input"),g=x("a-form-item"),b=x("a-form"),y=x("delete-outlined"),h=x("a-radio"),L=x("a-radio-group"),S=x("a-tooltip"),Y=x("a-checkbox"),$=x("a-col"),z=x("a-row"),oe=x("a-checkbox-group"),Me=x("a-modal"),Je=x("a-form-item-rest");return C(),M(q,null,[T(" 统一考试选项的页面 "),_("div",re,[K.value?T("v-if",!0):(C(),k(t,{key:0,type:"primary",onClick:se},{default:I((()=>[N("选择课程")])),_:1}))]),T(" 科目列表行信息 按钮 "),!K.value&&O.subjectList.length?(C(),M("div",de,[w(t,{danger:"",disabled:!Fe.value,onClick:Ve},{default:I((()=>[N("删除")])),_:1},8,["disabled"])])):T("v-if",!0),T(" 如果没有选择课程 科目teble 不显示 "),O.subjectList.length?(C(),M("div",ue,[w(j(ee),{selectedRowKeys:O.Keys,columns:j(r),dataSource:O.subjectList,bordered:!1,rowSelection:!K.value,isRadio:!1,onSelectChange:Ee,rowKeyId:e=>e.basicsSubjectId},{bodyCell:I((({column:i,text:a,record:n,index:r})=>{var d;return["timeList"===i.dataIndex?(C(),M(q,{key:0},[K.value?(C(),M("div",me,P(`${n.timeList[0]} - ${n.timeList[1]}`),1)):(C(),M("div",ce,[w(s,{value:n.timeList,"onUpdate:value":e=>n.timeList=e,"disabled-date":e=>(e=>{const i=v().subtract(1,"day").format("YYYY-MM-DD HH:mm");return e&&e<=v(i).endOf("day")})(e),onCalendarChange:i=>((i,a)=>{if(F.value=i,i&&F.value[1]){const[i,t]=F.value.map((e=>e.split(" ")[0]));i===t||(e.warning("考试时间不允许跨天!"),V((()=>{O.subjectList[a].timeList=null})))}})(i,r),"show-time":{hideDisabledOptions:!0,defaultValue:[j(v)("00:00","HH:mm"),j(v)("23:59","HH:mm")]},format:"YYYY-MM-DD HH:mm",valueFormat:"YYYY-MM-DD HH:mm",placeholder:["开始时间","结束时间"]},null,8,["value","onUpdate:value","disabled-date","onCalendarChange","show-time"])]))],64)):T("v-if",!0),"duration"===i.dataIndex?(C(),M(q,{key:1},[N(P((null==(d=n.timeList)?void 0:d.length)?`${ae.value(n)}分钟`:"-"),1)],64)):T("v-if",!0),T(" 主考员输入选人框 "),"chiefListArr"===i.dataIndex?(C(),M(q,{key:2},[K.value?(C(),M("div",pe,P(n.chiefList.map((e=>e.personName)).join(",")),1)):(C(),M("div",ve,[w(o,{value:n.chiefListArr,"onUpdate:value":e=>n.chiefListArr=e,style:{width:"300px"},open:!1,onChange:e=>{return i=e,a=n,O.teacherCheckedList=a.chiefList.filter((e=>i.includes(e.personId))),void(a.chiefList=O.teacherCheckedList);var i,a},placeholder:"请选择",options:n.chiefList,showArrow:"","max-tag-count":2,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(t,{onClick:e=>Oe(n,r,"chiefList"),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(l)])),_:2},1032,["onClick"])])),_:2},1032,["value","onUpdate:value","onChange","options"])]))],64)):T("v-if",!0),T(" 巡考员选人框 "),"inspectorListArr"===i.dataIndex?(C(),M(q,{key:3},[K.value?(C(),M("div",ge,P(n.inspectorList.map((e=>e.personName)).join(",")),1)):(C(),M("div",fe,[w(o,{style:{width:"300px"},value:n.inspectorListArr,"onUpdate:value":e=>n.inspectorListArr=e,placeholder:"请选择",onChange:e=>{return i=e,a=n,O.teacherCheckedList=a.inspectorList.filter((e=>i.includes(e.personId))),void(a.inspectorList=O.teacherCheckedList);var i,a},options:n.inspectorList,open:!1,showArrow:"","max-tag-count":2,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(t,{onClick:e=>Oe(n,r,"inspectorList"),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(l)])),_:2},1032,["onClick"])])),_:2},1032,["value","onUpdate:value","onChange","options"])]))],64)):T("v-if",!0)]})),_:1},8,["selectedRowKeys","columns","dataSource","rowSelection","rowKeyId"])])):T("v-if",!0),T(" 年级选择框 "),_("div",be,[w(b,{ref:"gradeRef",layout:"vertical",model:O},{default:I((()=>[w(g,{label:"考试年级",name:"gradeName",rules:[{required:O.gradeName,message:"请选择考试年级!",required:!0}]},{default:I((()=>[w(m,{disabled:K.value,style:{width:"556px"},value:O.gradeName,"onUpdate:value":a[0]||(a[0]=e=>O.gradeName=e),onClick:$e,allowClear:"",placeholder:"请选择",readonly:"readonly"},{suffix:I((()=>[w(n,{style:{color:"rgba(0, 0, 0, 0.45)"}})])),_:1},8,["disabled","value"])])),_:1},8,["rules"])])),_:1},8,["model"])]),T(" 循环遍历生成每年级考试场地信息 "),w(E,{name:"list",tag:"ul"},{default:I((()=>[(C(!0),M(q,null,R(O.groupConfigList,((i,a)=>{var s;return C(),M("div",{class:"examPlaceInfo",key:i.objectId},[_("div",{class:D({gradeHead:!0,lookGradeHead:K.value})},[_("div",ye,P(i.objectName),1),K.value?T("v-if",!0):(C(),M("div",he,[w(t,{type:"text",onClick:e=>((e,i)=>{O.groupConfigList.splice(e,1),O.gradeCheckedList.splice(O.gradeCheckedList.findIndex((e=>e.id===i.objectId)),1)})(a,i)},{icon:I((()=>[w(y,{style:{color:"rgb(147 147 147)"}})])),_:2},1032,["onClick"])]))],2),T(" 边框内容 "),_("div",Le,[xe,_("div",Ce,[w(L,{disabled:K.value,onChange:e=>j(qe)(e,O.groupConfigList[a],a),value:O.groupConfigList[a].examinationArrange,"onUpdate:value":e=>O.groupConfigList[a].examinationArrange=e,name:"gridType"},{default:I((()=>[w(h,{value:1},{default:I((()=>[N("随机排位")])),_:1}),w(h,{value:2},{default:I((()=>[N("本班排位")])),_:1})])),_:2},1032,["disabled","onChange","value","onUpdate:value"])]),K.value?T("v-if",!0):(C(),k(t,{key:0,type:"primary",onClick:e=>{return i=a,O.roomIndex=i,void(O.examination=!0);var i},disabled:2===i.examinationArrange},{default:I((()=>[N("选择考场")])),_:2},1032,["onClick","disabled"])),O.groupConfigList[a].siteList.length?(C(),M("div",ke,[K.value?T("v-if",!0):(C(),M("div",Ie,[T(" 此处的删除按钮是动态的 要根据每个box框框的选择 场地id拼凑年级id 的数组进行判断 是不是禁用状态的  "),w(t,{danger:"",disabled:!((null==(s=O.groupConfigList[a].roomKeys)?void 0:s.length)>0)||2===i.examinationArrange,onClick:e=>(e=>{O.groupConfigList[e].roomKeys.forEach((i=>{O.groupConfigList[e].siteList.splice(O.groupConfigList[e].siteList.findIndex((e=>e.id===i)),1)})),O.groupConfigList[e].roomKeys=[]})(a)},{default:I((()=>[N("删除")])),_:2},1032,["disabled","onClick"])])),_("div",null,[w(j(ee),{selectedRowKeys:O.groupConfigList[a].roomKeys,columns:K.value?j(f):j(d),dataSource:O.groupConfigList[a].siteList,bordered:!1,rowSelection:!K.value,isRadio:!1,onSelectChange:(e,i)=>((e,i,a)=>{O.groupConfigList[a].roomKeys=e})(e,0,a),rowKeyId:e=>e.id},{bodyCell:I((({column:i,text:t,record:s,index:l})=>{var o;return["name"===i.dataIndex?(C(),M(q,{key:0},[T(' {{ `${record.construct}${record.placeName}` || "-" }} ')],64)):T("v-if",!0),"buildingName"===i.dataIndex?(C(),M(q,{key:1},[N(P(s.buildingName||"-"),1)],64)):T("v-if",!0),"siteName"===i.dataIndex?(C(),M(q,{key:2},[N(P(s.siteName||"-"),1)],64)):T("v-if",!0),"examPeopleNum"===i.dataIndex?(C(),M(q,{key:3},[N(P(s.examPeopleNum||"-"),1)],64)):T("v-if",!0),"specification"===i.dataIndex?(C(),M(q,{key:4},[N(P(s.row&&s.cell?`${s.row} * ${s.cell}`:"-"),1)],64)):T("v-if",!0),"invigilatorTeachName"===i.dataIndex?(C(),M("div",we,[(null==(o=null==s?void 0:s.invigilatorList)?void 0:o.length)?(C(),k(S,{key:0},{title:I((()=>[N(P(j(ne)(s.invigilatorList)),1)])),default:I((()=>[_("div",je,P(j(ne)(s.invigilatorList)),1)])),_:2},1024)):T("v-if",!0),K.value?T("v-if",!0):(C(),M("a",{key:1,style:{color:"var(--primary-color)"},onClick:i=>((i,a,t)=>{var s;if(O.boxIndex=a,O.lineIndex=t,O.subjectList.every((e=>{var i;return(null==(i=e.timeList)?void 0:i.length)>0}))){const e=O.subjectList.map((e=>({id:e.basicsSubjectId,subjectName:e.subjectName,subjectId:e.basicsSubjectId,timeList:e.timeList})));if(i.setTeacherList=e||[],O.setTeacherList=[...U(e)],null==(s=O.groupConfigList[O.boxIndex].siteList[O.lineIndex].invigilatorList)?void 0:s.length)if(A.query.id)if(O.groupConfigList[O.boxIndex].siteList[O.lineIndex].teacherTableList)O.setTeacherList=O.groupConfigList[O.boxIndex].siteList[O.lineIndex].teacherTableList;else{const e=O.groupConfigList[O.boxIndex].siteList[O.lineIndex].invigilatorList.filter((e=>e.siteId===i.id));O.setTeacherList.forEach((i=>{i.invigilatorTeacher=e.filter((e=>i.id===e.subjectId)),i.invigilator=i.invigilatorTeacher.map((e=>e.personId))}))}else O.setTeacherList=O.groupConfigList[O.boxIndex].siteList[O.lineIndex].teacherTableList;O.setTeacherShow=!0}else e.warning("请填写考试开始时间及考试结束时间!")})(s,a,l)},"设置",8,Ne))])):T("v-if",!0),"operation"!==i.dataIndex||K.value||1!==O.groupConfigList[a].examinationArrange?T("v-if",!0):(C(),M("a",{key:6,style:{color:"var(--primary-color)"},onClick:e=>((e,i,a)=>{O.boxIndex=i,O.lineIndex=a,ie.designation=e.name,ie.venues=e.buildingName,ie.classroom=e.siteName,ie.capacity=e.sitePeopleNum,ie.districtCapacity=e.examPeopleNum,ie.line=e.row,ie.column=e.cell,O.amendExamination=!0})(s,a,l)},"修改",8,_e))]})),_:2},1032,["selectedRowKeys","columns","dataSource","rowSelection","onSelectChange","rowKeyId"])])])):T("v-if",!0)])])})),128))])),_:1}),T(" 选择考试科目对话框 "),_("div",Te,[w(Me,{maskClosable:!1,style:{width:"492px"},visible:O.courseVisible,"onUpdate:visible":a[2]||(a[2]=e=>O.courseVisible=e),title:"选择课程",onCancel:le,onOk:Ue},{footer:I((()=>[w(t,{key:"back",onClick:le},{default:I((()=>[N("取消")])),_:1}),w(t,{key:"submit",type:"primary",onClick:Ue},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(oe,{value:O.courseValue,"onUpdate:value":a[1]||(a[1]=e=>O.courseValue=e),style:{width:"100%"}},{default:I((()=>[w(z,{gutter:[16,24]},{default:I((()=>[(C(!0),M(q,null,R(te.value,(e=>(C(),k($,{span:8,key:e.id},{default:I((()=>[w(Y,{value:e.id},{default:I((()=>[N(P(e.name),1)])),_:2},1032,["value"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["visible"])]),T(" 选择考场对话框 "),_("div",Se,[w(Me,{class:"siteModal",visible:O.examination,"onUpdate:visible":a[10]||(a[10]=e=>O.examination=e),title:"选择考场",maskClosable:!1,onCancel:Re,onOk:De},{footer:I((()=>[w(t,{key:"back",onClick:Re},{default:I((()=>[N("取消")])),_:1}),w(t,{key:"submit",type:"primary",onClick:De},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(b,{ref_key:"roomFormRef",ref:B,autocomplete:"off",layout:"vertical",model:Z},{default:I((()=>[w(g,{label:"考场容量",name:"examPeopleNum",rules:[{required:Z.examPeopleNum,message:"请输入考场容量!",required:!0}]},{default:I((()=>[w(m,{onKeyup:a[3]||(a[3]=e=>Z.examPeopleNum=Z.examPeopleNum.replace(/\D/g,"")),value:Z.examPeopleNum,"onUpdate:value":a[4]||(a[4]=e=>Z.examPeopleNum=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"人"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"考场规格",name:"size",validateTrigger:"onSubmit",rules:[{validator:G,required:!0,trigger:["submit"]}]},{default:I((()=>[w(m,{onKeyup:a[5]||(a[5]=e=>Z.row=Z.row.replace(/\D/g,"")),style:{width:"50%"},value:Z.row,"onUpdate:value":a[6]||(a[6]=e=>Z.row=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"行"},null,8,["value"]),w(Je,null,{default:I((()=>[w(m,{onKeyup:a[7]||(a[7]=e=>Z.cell=Z.cell.replace(/\D/g,"")),style:{width:"50%"},value:Z.cell,"onUpdate:value":a[8]||(a[8]=e=>Z.cell=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"列"},null,8,["value"])])),_:1})])),_:1},8,["rules"]),w(g,{label:"考场地点",name:"location",validateTrigger:"onSubmit",rules:[{required:Z.location,message:"请选择考场地点!",required:!0},{validator:Q,required:!0,trigger:["submit"]}]},{default:I((()=>[w(o,{ref:"locationSelect",value:Z.location,"onUpdate:value":a[9]||(a[9]=e=>Z.location=e),options:X.value,onChange:Ye,onDropdownVisibleChange:Pe,fieldNames:{label:"name",value:"id"}},null,8,["value","options"])])),_:1},8,["rules"]),w(g,{name:"architecture"},{default:I((()=>[w(Je,null,{default:I((()=>[w(j(ee),{selectedRowKeys:O.buildKeys,columns:j(u),dataSource:O.buildSource,bordered:!1,rowSelection:!0,isRadio:!1,onSelectChange:He,"row-key":e=>e.id},null,8,["selectedRowKeys","columns","dataSource","row-key"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])]),T(" 修改考场对话框 "),_("div",Ae,[w(Me,{visible:O.amendExamination,"onUpdate:visible":a[21]||(a[21]=e=>O.amendExamination=e),title:"修改",maskClosable:!1,onCancel:Qe,onOk:Xe},{footer:I((()=>[w(t,{key:"back",onClick:Qe},{default:I((()=>[N("取消")])),_:1}),w(t,{key:"submit",type:"primary",onClick:Xe},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(b,{class:"info-form",ref_key:"amendFormRef",ref:J,autocomplete:"off",layout:"vertical",model:ie},{default:I((()=>[w(g,{label:"考场名称",name:"designation",rules:[{required:ie.designation,message:"请输入考场名称!",required:!0}]},{default:I((()=>[w(m,{maxlength:10,value:ie.designation,"onUpdate:value":a[11]||(a[11]=e=>ie.designation=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"考试地点",name:"venues",rules:[{required:ie.venues,message:"请输入考场地点!",required:!0}]},{default:I((()=>[w(m,{disabled:"",value:ie.venues,"onUpdate:value":a[12]||(a[12]=e=>ie.venues=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"考试教室",name:"classroom",rules:[{required:ie.classroom,message:"请输入考试教室!",required:!0}]},{default:I((()=>[w(m,{disabled:"",value:ie.classroom,"onUpdate:value":a[13]||(a[13]=e=>ie.classroom=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"场地容量",name:"classroom",rules:[{required:ie.classroom,message:"请输入场地容量!",required:!0}]},{default:I((()=>[w(m,{disabled:"",value:ie.capacity,"onUpdate:value":a[14]||(a[14]=e=>ie.capacity=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"考场容量",name:"districtCapacity",rules:[{required:ie.districtCapacity,message:"请输入考场容量!",required:!0}]},{default:I((()=>[w(m,{onKeyup:a[15]||(a[15]=e=>ie.districtCapacity=ie.districtCapacity.replace(/\D/g,"")),value:ie.districtCapacity,"onUpdate:value":a[16]||(a[16]=e=>ie.districtCapacity=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(g,{label:"考场规格",name:"specification",validateTrigger:"onSubmit",rules:[{validator:W,required:!0,trigger:"submit"}]},{default:I((()=>[w(m,{onKeyup:a[17]||(a[17]=e=>ie.line=ie.line.replace(/\D/g,"")),style:{width:"50%"},value:ie.line,"onUpdate:value":a[18]||(a[18]=e=>ie.line=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"行"},null,8,["value"]),w(Je,null,{default:I((()=>[w(m,{onKeyup:a[19]||(a[19]=e=>ie.column=ie.column.replace(/\D/g,"")),style:{width:"50%"},value:ie.column,"onUpdate:value":a[20]||(a[20]=e=>ie.column=e),placeholder:"请输入",suffix:"列"},null,8,["value"])])),_:1})])),_:1},8,["rules"])])),_:1},8,["model"])])),_:1},8,["visible"])]),T(" 设置监考老师对话框 "),_("div",Ke,[w(Me,{style:{width:"723px"},maskClosable:!1,visible:O.setTeacherShow,"onUpdate:visible":a[22]||(a[22]=e=>O.setTeacherShow=e),title:"设置监考老师",onOk:Ge},{footer:I((()=>[w(t,{key:"back",onClick:We},{default:I((()=>[N("取消")])),_:1}),w(t,{key:"submit",type:"primary",onClick:Ge},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(j(ee),{columns:j(c),dataSource:O.setTeacherList,bordered:!1,"row-key":e=>e.id},{bodyCell:I((({column:e,text:i,record:a,index:s})=>["timeList"===e.dataIndex?(C(),M(q,{key:0},[N(P(a.timeList[0]+"-"+a.timeList[1].split(" ")[1]),1)],64)):T("v-if",!0),"invigilator"===e.dataIndex?(C(),k(o,{key:1,value:a.invigilator,"onUpdate:value":e=>a.invigilator=e,style:{width:"300px"},open:!1,onChange:e=>{return i=e,t=a,O.teacherCheckedList=t.invigilatorTeacher.filter((e=>i.includes(e.personId))),void(t.invigilatorTeacher=O.teacherCheckedList);var i,t},placeholder:"请选择",options:a.invigilatorTeacher,showArrow:"","max-tag-count":4,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(t,{onClick:e=>Oe(a,s,"invigilator"),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(l)])),_:2},1032,["onClick"])])),_:2},1032,["value","onUpdate:value","onChange","options"])):T("v-if",!0)])),_:1},8,["columns","dataSource","row-key"])])),_:1},8,["visible"])]),T(" 选择主考员/巡考员 "),w(j(p),{mode:"personnel",tabs:[{tab:"教职工",key:1,checked:!0}],visible:O.managerVisible,"onUpdate:visible":a[23]||(a[23]=e=>O.managerVisible=e),selectedKeys:[],checked:O.teacherCheckedList,"onUpdate:checked":a[24]||(a[24]=e=>O.teacherCheckedList=e),onHandleOk:Be},null,8,["visible","checked"]),T(" 年级选择 "),w(j(p),{multiple:!0,treeData:H.value.value,tabs:O.selectTabs,mode:"depa",visible:O.classVisible,"onUpdate:visible":a[25]||(a[25]=e=>O.classVisible=e),selectedKeys:[],checked:O.gradeCheckedList,"onUpdate:checked":a[26]||(a[26]=e=>O.gradeCheckedList=e),onHandleOk:ze},null,8,["treeData","tabs","visible","checked"])],64)}}},[["__scopeId","data-v-37575d45"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/comp/children/unify.vue"]]);const Me={class:"gradeBox"},qe={class:"gradeTitle"},Pe={key:0},Re={class:"arrange"},De={class:"btnClass titleText"},Ee={key:0,class:"subDelBtn"},Ve={key:1},Ye={key:0},He={key:1},Fe={key:0},Oe={key:1},Be={key:0},$e={key:1},ze=(e=>(Y("data-v-0f689d59"),e=e(),H(),e))((()=>_("div",{class:"titleText arrangement"},"考场布置：",-1))),Je={class:"examRadio"},Ge={key:3},We={key:0,class:"classdelBtn"},Qe={style:{display:"flex"}},Xe={class:"teachNameJoin"},Ze=["onClick"],ei=["onClick"],ii={class:"courseModal"},ai={class:"courseModal"},ti={class:"courseModal"},si={class:"teacherModal"};var li=u({__name:"grade",setup(i,{expose:o}){const n=m(),{subColumns:r,roomColumns:d,buildColumns:u,teachColumns:c,lookRoomColumns:f}=oe(),h=g(),K=y((()=>{const e=[];return n.state.base.commentJsonKeys.INIT_ROLL_LIST.forEach((i=>"grade"!==i.key&&e.push(i.level))),e})),Y=y((()=>n.state.base.schoolRollTree)),H=y((()=>"look"===h.query.type)),F=A(),O=A(),B=A(),J=A([]),G=A([]),W=b({patrolExaminer:[{tab:"教职工",key:1,checked:!0}],selectTabs:[{tab:"选择年级",key:2,checked:!0,disabled:K}],teacherCheckedList:[],gradeCheckedList:[],buildArr:[],buildKeys:[],classVisible:!1,managerVisible:!1,gridType:"1",setTeacherShow:!1,amendExamination:!1,examination:!1,visible:!1,courseVisible:!1,subjectList:[],roomSource:[],buildSource:[],groupConfigList:[],courseValue:[]}),Q=(e,i)=>ie.row&&ie.cell?Promise.resolve():Promise.reject(new Error("请输入考场规格!")),X=(e,i)=>ae.line&&ae.column?Promise.resolve():Promise.reject(new Error("请输入考场规格!")),Z=(e,i)=>W.buildArr.length?Promise.resolve():Promise.reject(new Error("请选择考场建筑!")),ie=b({}),ae=b({}),te=y((()=>e=>(e.duration=v(e.timeList[1]).diff(v(e.timeList[0]),"minute"),e.duration))),se=()=>{W.courseVisible=!1},le=()=>{W.courseVisible=!1,W.groupConfigList[W.roomIndex].subjectList=re.value.map((e=>{var i,a,t,s,l;const o=W.groupConfigList[W.roomIndex].subjectList.findIndex((i=>i.basicsSubjectId===e.basicsSubjectId)),n=(null==(i=W.groupConfigList[W.roomIndex].subjectList[o])?void 0:i.timeList)||[],r=(null==(a=W.groupConfigList[W.roomIndex].subjectList[o])?void 0:a.chiefListArr)||[],d=(null==(t=W.groupConfigList[W.roomIndex].subjectList[o])?void 0:t.chiefList)||[],u=(null==(s=W.groupConfigList[W.roomIndex].subjectList[o])?void 0:s.inspectorListArr)||[],c=(null==(l=W.groupConfigList[W.roomIndex].subjectList[o])?void 0:l.inspectorList)||[];return{...e,chiefListArr:r,timeList:n,chiefList:d,inspectorListArr:u,inspectorList:c}}))},re=y((()=>G.value.filter((e=>W.courseValue.includes(e.id))).map((e=>({id:e.id,basicsSubjectId:e.id,subjectName:e.name,chiefListArr:[],timeList:[]}))))),de=$((async(e,i)=>{if(2===e.target.value)try{const{data:e}=await l({objectId:i.objectId});e||e.length?i.siteList=e:(i.examinationArrange=1,i.siteList=[])}catch(a){i.examinationArrange=1,i.siteList=[]}else i.siteList=[]}),1e3,{maxWait:3e3}),ue=async()=>{if(ie.examPeopleNum){const{data:e}=await a({examPeopleNum:ie.examPeopleNum});J.value=e}else e.destroy(),e.warning("请输入考场容量!")},ce=()=>{O.value.resetFields(),ie.row=null,ie.cell=null,W.buildArr=[],W.buildKeys=[],W.buildSource=[],W.examination=!1},me=()=>{O.value.validateFields().then((()=>{const i=W.buildArr.map((e=>({cell:ie.cell,examPeopleNum:ie.examPeopleNum,row:ie.row,name:e.buildingName+e.name,siteId:e.id,id:z(),buildingName:e.buildingName,siteName:e.name,sitePeopleNum:e.peppleNum,invigilatorList:[],teacherTableList:[]})));let a=[];W.groupConfigList.forEach((e=>{var i;a=null==(i=e.siteList)?void 0:i.map((e=>e.siteId))}));W.buildArr.map((e=>a.includes(e.id))).includes(!0)?e.warning("不允许选择相同的场地!"):(i.forEach((e=>{W.groupConfigList[W.roomIndex].siteList.push(e)})),O.value.resetFields(),ie.row=null,ie.cell=null,W.buildArr=[],W.buildKeys=[],W.buildSource=[],W.examination=!1)}))},pe=e=>{W.buildArr=[],W.buildKeys=[],J.value.forEach((i=>{i.id===e&&(W.buildSource=i.siteList)}))},ve=(e,i)=>{W.buildKeys=e,W.buildArr=i},ge=y((()=>e=>!(null==e?void 0:e.length))),fe=(e,i,a,t)=>{var s,l,o;"chiefList"===a&&(null==(s=e.chiefList)?void 0:s.length)?W.teacherCheckedList=e.chiefList.map((e=>({id:e.personId,showName:e.personName}))):"inspectorList"===a&&(null==(l=e.inspectorList)?void 0:l.length)?W.teacherCheckedList=e.inspectorList.map((e=>({id:e.personId,showName:e.personName}))):"invigilator"===a&&(null==(o=e.invigilatorTeacher)?void 0:o.length)?W.teacherCheckedList=e.invigilatorTeacher.map((e=>({id:e.personId,showName:e.personName}))):W.teacherCheckedList=[],W.outBoxIndex=t,W.thisNum=i,W.personType=a,W.managerVisible=!0},be=i=>{"invigilator"!==W.personType?"chiefList"===W.personType&&i.length<=2?(W.groupConfigList[W.outBoxIndex].subjectList[W.thisNum].chiefList=i.map((e=>({personId:e.id,personName:e.showName}))),W.groupConfigList[W.outBoxIndex].subjectList[W.thisNum].chiefListArr=i.map((e=>e.id))):"inspectorList"===W.personType&&i.length<=2?(W.groupConfigList[W.outBoxIndex].subjectList[W.thisNum].inspectorList=i.map((e=>({personId:e.id,personName:e.showName}))),W.groupConfigList[W.outBoxIndex].subjectList[W.thisNum].inspectorListArr=i.map((e=>e.id))):e.warning("每个考试科目主考员或巡考员最多只能选择两名人员!"):i.length<=10?(W.setTeacherList[W.thisNum].invigilatorTeacher=i.map((e=>({personId:e.id,personName:e.showName}))),W.setTeacherList[W.thisNum].invigilator=i.map((e=>e.id))):e.warning("每个考试科目监考老师最多只能选择10名人员!")},ye=()=>{W.classVisible=!0},he=e=>{W.gradeName=e.map((e=>e.showName)).join("；"),W.groupList=e.map((e=>({objectId:e.id,objectName:e.showName}))),W.groupConfigList=Le.value.map((e=>{var i,a,t,s,l,o,n;const r=W.groupConfigList.findIndex((i=>i.objectId===e.id)),d=(null==(i=W.groupConfigList[r])?void 0:i.objectId)||e.id,u=(null==(a=W.groupConfigList[r])?void 0:a.objectName)||e.objectName,c=(null==(t=W.groupConfigList[r])?void 0:t.examinationArrange)||1,m=(null==(s=W.groupConfigList[r])?void 0:s.siteList)||[],p=(null==(l=W.groupConfigList[r])?void 0:l.roomKeys)||[],v=(null==(o=W.groupConfigList[r])?void 0:o.Keys)||[],g=(null==(n=W.groupConfigList[r])?void 0:n.subjectList)||[];return{...e,objectId:d,objectName:u,examinationArrange:c,siteList:m,roomKeys:p,Keys:v,subjectList:g}}))},Le=y((()=>W.gradeCheckedList.map((e=>({id:e.id,objectId:e.id,objectName:e.showName,examinationArrange:1,subjectList:[],siteList:[],roomKeys:[]}))))),xe=()=>{if(W.setTeacherList.every((e=>{var i;return(null==(i=e.invigilator)?void 0:i.length)>0}))){W.groupConfigList[W.boxIndex].siteList[W.lineIndex].teacherTableList=W.setTeacherList;const e=[];W.setTeacherList.forEach((i=>{i.invigilatorTeacher.forEach((a=>{a.subjectName=i.subjectName,a.subjectId=i.subjectId,e.push(a)}))})),W.groupConfigList[W.boxIndex].siteList[W.lineIndex].invigilatorList=e,W.setTeacherShow=!1}else e.warning("考试每门科目必须设置监考老师!")},Ce=()=>{W.setTeacherShow=!1},ke=()=>{B.value.resetFields(),ae.line=null,ae.column=null,W.amendExamination=!1},Ie=()=>{B.value.validateFields().then((()=>{Number(ae.districtCapacity)>Number(ae.capacity)?e.warning("考场容量必须要小于等于场地容量!"):(W.groupConfigList[W.boxIndex].siteList[W.lineIndex].name=ae.designation,W.groupConfigList[W.boxIndex].siteList[W.lineIndex].row=ae.line,W.groupConfigList[W.boxIndex].siteList[W.lineIndex].cell=ae.column,W.groupConfigList[W.boxIndex].siteList[W.lineIndex].examPeopleNum=ae.districtCapacity,W.amendExamination=!1)}))};return S((()=>W.gradeCheckedList),((e,i)=>{W.groupList=e.map((e=>({objectId:e.id,objectName:e.showName}))),W.gradeName=e.map((e=>e.showName)).join("；")}),{deep:!0}),S((()=>ie.examPeopleNum),((e,i)=>{ie.location=null,J.value=[],W.buildArr=[],W.buildKeys=[],W.buildSource=[]}),{deep:!0}),L((()=>{(async()=>{const{data:e}=await t();G.value=e})(),h.query.id&&(async()=>{const{data:e}=await s({id:h.query.id});W.subjectList=e.subjectList,W.groupList=e.groupList,W.groupConfigList=e.groupConfigList,W.gradeCheckedList=e.groupList.map((e=>({id:e.objectId,showName:e.objectName}))),W.gradeName=e.groupList.map((e=>e.objectName)).join("；")})()})),o({state:W}),(i,a)=>{const t=x("down-outlined"),s=x("a-input"),l=x("a-form-item"),o=x("a-form"),n=x("delete-outlined"),m=x("a-button"),g=x("a-range-picker"),b=x("plus-outlined"),y=x("a-select"),L=x("a-radio"),S=x("a-radio-group"),A=x("a-tooltip"),K=x("a-checkbox"),$=x("a-col"),z=x("a-row"),oe=x("a-checkbox-group"),re=x("a-modal"),Le=x("a-form-item-rest");return C(),M(q,null,[T(" 分年级考试时间选项的页面 "),T(" 年级选择框 "),_("div",Me,[w(o,{ref:"gradeRef",layout:"vertical",model:W.gradeName},{default:I((()=>[w(l,{label:"考试年级",name:"gradeName",rules:[{required:W.gradeName,message:"请选择考试年级!",required:!0}]},{default:I((()=>[w(s,{disabled:H.value,style:{width:"556px"},value:W.gradeName,"onUpdate:value":a[0]||(a[0]=e=>W.gradeName=e),onClick:ye,allowClear:"",placeholder:"请选择",readonly:"readonly"},{suffix:I((()=>[w(t,{style:{color:"rgba(0, 0, 0, 0.45)"}})])),_:1},8,["disabled","value"])])),_:1},8,["rules"])])),_:1},8,["model"])]),T(" 循环遍历生成每年级考试场地信息 "),w(E,{name:"list",tag:"ul"},{default:I((()=>[(C(!0),M(q,null,R(W.groupConfigList,((i,a)=>{var t;return C(),M("div",{class:"examPlaceInfo",key:i.objectId},[_("div",{class:D({gradeHead:!0,lookGradeHead:H.value})},[_("div",qe,P(i.objectName),1),H.value?T("v-if",!0):(C(),M("div",Pe,[w(m,{type:"text",onClick:e=>((e,i)=>{W.groupConfigList.splice(e,1),W.gradeCheckedList.splice(W.gradeCheckedList.findIndex((e=>e.id===i.objectId)),1)})(a,i)},{icon:I((()=>[w(n,{style:{color:"rgb(147 147 147)"}})])),_:2},1032,["onClick"])]))],2),T(" 边框内容 "),_("div",Re,[_("div",De,[N(" 考场科目： "),H.value?T("v-if",!0):(C(),k(m,{key:0,type:"primary",onClick:e=>(e=>{W.groupConfigList[e].Keys=[],W.roomIndex=e;const i=W.groupConfigList[e].subjectList;i.length?W.courseValue=i.map((e=>e.basicsSubjectId)):W.courseValue=[],W.courseVisible=!0})(a)},{default:I((()=>[N("选择课程")])),_:2},1032,["onClick"]))]),i.subjectList.length&&!H.value?(C(),M("div",Ee,[w(m,{danger:"",disabled:ge.value(i.Keys),onClick:e=>(e=>{W.groupConfigList[e].Keys.forEach((i=>{W.groupConfigList[e].subjectList.splice(W.groupConfigList[e].subjectList.findIndex((e=>e.basicsSubjectId===i)),1)})),W.groupConfigList[e].Keys=[]})(a)},{default:I((()=>[N("删除")])),_:2},1032,["disabled","onClick"])])):T("v-if",!0),T(" 如果没有选择课程 科目teble 不显示 "),i.subjectList.length?(C(),M("div",Ve,[w(j(ee),{selectedRowKeys:i.Keys,columns:j(r),dataSource:i.subjectList,bordered:!1,rowSelection:!H.value,isRadio:!1,onSelectChange:(e,i)=>((e,i,a)=>{W.groupConfigList[a].Keys=e})(e,0,a),rowKeyId:e=>e.basicsSubjectId},{bodyCell:I((({column:i,text:t,record:s,index:l})=>{var o;return["timeList"===i.dataIndex?(C(),M(q,{key:0},[H.value?(C(),M("div",He,P(`${s.timeList[0]} - ${s.timeList[1]}`),1)):(C(),M("div",Ye,[w(g,{value:s.timeList,"onUpdate:value":e=>s.timeList=e,"disabled-date":e=>(e=>{const i=v().subtract(1,"day").format("YYYY-MM-DD HH:mm:ss");return e&&e<=v(i).endOf("day")})(e),onCalendarChange:i=>((i,a,t)=>{if(F.value=i,i&&F.value[1]){const[i,s]=F.value.map((e=>e.split(" ")[0]));i===s||(e.warning("考试时间不允许跨天!"),V((()=>{W.groupConfigList[a].subjectList[t].timeList=null})))}})(i,a,l),"show-time":{hideDisabledOptions:!0,defaultValue:[j(v)("00:00","HH:mm"),j(v)("23:59","HH:mm")]},format:"YYYY-MM-DD HH:mm",valueFormat:"YYYY-MM-DD HH:mm",placeholder:["开始时间","结束时间"]},null,8,["value","onUpdate:value","disabled-date","onCalendarChange","show-time"])]))],64)):T("v-if",!0),"duration"===i.dataIndex?(C(),M(q,{key:1},[N(P((null==(o=s.timeList)?void 0:o.length)?`${te.value(s)}分钟`:"-"),1)],64)):T("v-if",!0),T(" 主考员输入选人框 "),"chiefListArr"===i.dataIndex?(C(),M(q,{key:2},[H.value?(C(),M("div",Fe,P(s.chiefList.map((e=>e.personName)).join(",")),1)):(C(),M("div",Oe,[w(y,{value:s.chiefListArr,"onUpdate:value":e=>s.chiefListArr=e,style:{width:"300px"},open:!1,placeholder:"请选择",options:s.chiefList,showArrow:"",onChange:e=>((e,i)=>{W.teacherCheckedList=i.chiefList.filter((i=>e.includes(i.personId))),i.chiefList=W.teacherCheckedList})(e,s),"max-tag-count":2,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(m,{onClick:e=>fe(s,l,"chiefList",a),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(b)])),_:2},1032,["onClick"])])),_:2},1032,["value","onUpdate:value","options","onChange"])]))],64)):T("v-if",!0),T(" 巡考员选人框 "),"inspectorListArr"===i.dataIndex?(C(),M(q,{key:3},[H.value?(C(),M("div",Be,P(s.inspectorList.map((e=>e.personName)).join(",")),1)):(C(),M("div",$e,[w(y,{style:{width:"300px"},onChange:e=>((e,i)=>{W.teacherCheckedList=i.inspectorList.filter((i=>e.includes(i.personId))),i.inspectorList=W.teacherCheckedList})(e,s),value:s.inspectorListArr,"onUpdate:value":e=>s.inspectorListArr=e,placeholder:"请选择",options:s.inspectorList,open:!1,showArrow:"","max-tag-count":2,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(m,{onClick:e=>fe(s,l,"inspectorList",a),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(b)])),_:2},1032,["onClick"])])),_:2},1032,["onChange","value","onUpdate:value","options"])]))],64)):T("v-if",!0)]})),_:2},1032,["selectedRowKeys","columns","dataSource","rowSelection","onSelectChange","rowKeyId"])])):T("v-if",!0),ze,_("div",Je,[w(S,{disabled:H.value,onChange:e=>j(de)(e,W.groupConfigList[a],a),value:W.groupConfigList[a].examinationArrange,"onUpdate:value":e=>W.groupConfigList[a].examinationArrange=e,name:"gridType"},{default:I((()=>[w(L,{value:1},{default:I((()=>[N("随机排位")])),_:1}),w(L,{value:2},{default:I((()=>[N("本班排位")])),_:1})])),_:2},1032,["disabled","onChange","value","onUpdate:value"])]),H.value?T("v-if",!0):(C(),k(m,{key:2,type:"primary",onClick:e=>(async e=>{W.roomIndex=e,W.examination=!0})(a),disabled:2===i.examinationArrange},{default:I((()=>[N("选择考场")])),_:2},1032,["onClick","disabled"])),W.groupConfigList[a].siteList.length?(C(),M("div",Ge,[H.value?T("v-if",!0):(C(),M("div",We,[T(" 此处的删除按钮是动态的 要根据每个box框框的选择 场地id拼凑年级id 的数组进行判断 是不是禁用状态的  "),w(m,{danger:"",disabled:!((null==(t=W.groupConfigList[a].roomKeys)?void 0:t.length)>0)||2===i.examinationArrange,onClick:e=>(e=>{W.groupConfigList[e].roomKeys.forEach((i=>{W.groupConfigList[e].siteList.splice(W.groupConfigList[e].siteList.findIndex((e=>e.id===i)),1)})),W.groupConfigList[e].roomKeys=[]})(a)},{default:I((()=>[N("删除")])),_:2},1032,["disabled","onClick"])])),_("div",null,[w(j(ee),{selectedRowKeys:W.groupConfigList[a].roomKeys,columns:H.value?j(f):j(d),dataSource:W.groupConfigList[a].siteList,bordered:!1,rowSelection:!H.value,isRadio:!1,onSelectChange:(e,i)=>((e,i,a)=>{W.groupConfigList[a].roomKeys=e})(e,0,a),rowKeyId:e=>e.id},{bodyCell:I((({column:i,text:t,record:s,index:l})=>{var o;return["roomName"===i.dataIndex?(C(),M(q,{key:0},[N(P(`${s.construct}${s.placeName}`||"-"),1)],64)):T("v-if",!0),"buildingName"===i.dataIndex?(C(),M(q,{key:1},[N(P(s.buildingName||"-"),1)],64)):T("v-if",!0),"siteName"===i.dataIndex?(C(),M(q,{key:2},[N(P(s.siteName||"-"),1)],64)):T("v-if",!0),"examPeopleNum"===i.dataIndex?(C(),M(q,{key:3},[N(P(s.examPeopleNum||"-"),1)],64)):T("v-if",!0),"specification"===i.dataIndex?(C(),M(q,{key:4},[N(P(s.row&&s.cell?`${s.row} * ${s.cell}`:"-"),1)],64)):T("v-if",!0),"invigilatorTeachName"===i.dataIndex?(C(),M(q,{key:5},[T(" 这段在究极麻烦的处理出字符串来显示 "),_("div",Qe,[(null==(o=null==s?void 0:s.invigilatorList)?void 0:o.length)?(C(),k(A,{key:0},{title:I((()=>[N(P(j(ne)(s.invigilatorList)),1)])),default:I((()=>[_("div",Xe,P(j(ne)(s.invigilatorList)),1)])),_:2},1024)):T("v-if",!0),H.value?T("v-if",!0):(C(),M("a",{key:1,style:{color:"var(--primary-color)"},onClick:i=>((i,a,t)=>{var s;if(W.boxIndex=a,W.lineIndex=t,W.groupConfigList[W.boxIndex].subjectList.every((e=>{var i;return(null==(i=e.timeList)?void 0:i.length)>0}))){const e=W.groupConfigList[W.boxIndex].subjectList.map((e=>({id:e.basicsSubjectId,subjectName:e.subjectName,subjectId:e.basicsSubjectId,timeList:e.timeList})));if(i.setTeacherList=e||[],W.setTeacherList=[...U(e)],null==(s=W.groupConfigList[W.boxIndex].siteList[W.lineIndex].invigilatorList)?void 0:s.length)if(h.query.id)if(W.groupConfigList[W.boxIndex].siteList[W.lineIndex].teacherTableList)W.setTeacherList=W.groupConfigList[W.boxIndex].siteList[W.lineIndex].teacherTableList;else{const e=W.groupConfigList[W.boxIndex].siteList[W.lineIndex].invigilatorList.filter((e=>e.siteId===i.id));W.setTeacherList.forEach((i=>{i.invigilatorTeacher=e.filter((e=>i.id===e.subjectId)),i.invigilator=i.invigilatorTeacher.map((e=>e.personId))}))}else W.setTeacherList=W.groupConfigList[W.boxIndex].siteList[W.lineIndex].teacherTableList;W.setTeacherShow=!0}else e.warning("请填写考试开始时间及考试结束时间!")})(s,a,l)},"设置",8,Ze))])],64)):T("v-if",!0),"operation"!==i.dataIndex||H.value||1!==W.groupConfigList[a].examinationArrange?T("v-if",!0):(C(),M("a",{key:6,style:{color:"var(--primary-color)"},onClick:e=>((e,i,a)=>{W.boxIndex=i,W.lineIndex=a,ae.designation=e.name,ae.venues=e.buildingName,ae.classroom=e.siteName,ae.capacity=e.sitePeopleNum,ae.districtCapacity=e.examPeopleNum,ae.line=e.row,ae.column=e.cell,W.amendExamination=!0})(s,a,l)},"修改",8,ei))]})),_:2},1032,["selectedRowKeys","columns","dataSource","rowSelection","onSelectChange","rowKeyId"])])])):T("v-if",!0)])])})),128))])),_:1}),T(" 选择考试科目对话框 "),_("div",ii,[w(re,{style:{width:"492px"},visible:W.courseVisible,"onUpdate:visible":a[2]||(a[2]=e=>W.courseVisible=e),title:"选择课程",maskClosable:!1,onCancel:se,onOk:le},{footer:I((()=>[w(m,{key:"back",onClick:se},{default:I((()=>[N("取消")])),_:1}),w(m,{key:"submit",type:"primary",onClick:le},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(oe,{value:W.courseValue,"onUpdate:value":a[1]||(a[1]=e=>W.courseValue=e),style:{width:"100%"}},{default:I((()=>[w(z,{gutter:[16,24]},{default:I((()=>[(C(!0),M(q,null,R(G.value,(e=>(C(),k($,{span:8,key:e.id},{default:I((()=>[w(K,{value:e.id},{default:I((()=>[N(P(e.name),1)])),_:2},1032,["value"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["visible"])]),T(" 选择考场对话框 "),_("div",ai,[w(re,{class:"siteModal",visible:W.examination,"onUpdate:visible":a[10]||(a[10]=e=>W.examination=e),title:"选择考场",maskClosable:!1,onCancel:ce,onOk:me},{footer:I((()=>[w(m,{key:"back",onClick:ce},{default:I((()=>[N("取消")])),_:1}),w(m,{key:"submit",type:"primary",onClick:me},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(o,{ref_key:"roomFormRef",ref:O,autocomplete:"off",layout:"vertical",model:ie},{default:I((()=>[w(l,{label:"考场容量",name:"examPeopleNum",rules:[{required:ie.examPeopleNum,message:"请输入考场容量!",required:!0}]},{default:I((()=>[w(s,{onKeyup:a[3]||(a[3]=e=>ie.examPeopleNum=ie.examPeopleNum.replace(/\D/g,"")),value:ie.examPeopleNum,"onUpdate:value":a[4]||(a[4]=e=>ie.examPeopleNum=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"人"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"考场规格",validateTrigger:"onSubmit",name:"size",rules:[{validator:Q,required:!0,trigger:["submit"]}]},{default:I((()=>[w(s,{onKeyup:a[5]||(a[5]=e=>ie.row=ie.row.replace(/\D/g,"")),style:{width:"50%"},value:ie.row,"onUpdate:value":a[6]||(a[6]=e=>ie.row=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"行"},null,8,["value"]),w(Le,null,{default:I((()=>[w(s,{style:{width:"50%"},onKeyup:a[7]||(a[7]=e=>ie.cell=ie.cell.replace(/\D/g,"")),value:ie.cell,"onUpdate:value":a[8]||(a[8]=e=>ie.cell=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"列"},null,8,["value"])])),_:1})])),_:1},8,["rules"]),w(l,{label:"考场地点",name:"location",validateTrigger:"onSubmit",rules:[{required:ie.location,message:"请选择考场地点!",required:!0},{validator:Z,required:!0,trigger:["submit"]}]},{default:I((()=>[w(y,{ref:"locationSelect",value:ie.location,"onUpdate:value":a[9]||(a[9]=e=>ie.location=e),options:J.value,onDropdownVisibleChange:ue,onChange:pe,fieldNames:{label:"name",value:"id"}},null,8,["value","options"])])),_:1},8,["rules"]),w(l,{name:"architecture"},{default:I((()=>[w(Le,null,{default:I((()=>[w(j(ee),{selectedRowKeys:W.buildKeys,columns:j(u),dataSource:W.buildSource,bordered:!1,rowSelection:!0,isRadio:!1,onSelectChange:ve,"row-key":e=>e.id},null,8,["selectedRowKeys","columns","dataSource","row-key"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])]),T(" 修改考场对话框 "),_("div",ti,[w(re,{visible:W.amendExamination,"onUpdate:visible":a[21]||(a[21]=e=>W.amendExamination=e),title:"修改",maskClosable:!1,onCancel:ke,onOk:Ie},{footer:I((()=>[w(m,{key:"back",onClick:ke},{default:I((()=>[N("取消")])),_:1}),w(m,{key:"submit",type:"primary",onClick:Ie},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(o,{class:"info-form",ref_key:"amendFormRef",ref:B,autocomplete:"off",layout:"vertical",model:ae},{default:I((()=>[w(l,{label:"考场名称",name:"designation",rules:[{required:ae.designation,message:"请输入考场名称!",required:!0}]},{default:I((()=>[w(s,{maxlength:10,value:ae.designation,"onUpdate:value":a[11]||(a[11]=e=>ae.designation=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"考试地点",name:"venues",rules:[{required:ae.venues,message:"请输入考场地点!",required:!0}]},{default:I((()=>[w(s,{disabled:"",value:ae.venues,"onUpdate:value":a[12]||(a[12]=e=>ae.venues=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"考试教室",name:"classroom",rules:[{required:ae.classroom,message:"请输入考试教室!",required:!0}]},{default:I((()=>[w(s,{disabled:"",value:ae.classroom,"onUpdate:value":a[13]||(a[13]=e=>ae.classroom=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"场地容量",name:"classroom",rules:[{required:ae.classroom,message:"请输入场地容量!",required:!0}]},{default:I((()=>[w(s,{disabled:"",value:ae.capacity,"onUpdate:value":a[14]||(a[14]=e=>ae.capacity=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"考场容量",name:"districtCapacity",rules:[{required:ae.districtCapacity,message:"请输入考场容量!",required:!0}]},{default:I((()=>[w(s,{onKeyup:a[15]||(a[15]=e=>ae.districtCapacity=ae.districtCapacity.replace(/\D/g,"")),value:ae.districtCapacity,"onUpdate:value":a[16]||(a[16]=e=>ae.districtCapacity=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1},8,["rules"]),w(l,{label:"考场规格",name:"specification",validateTrigger:"onSubmit",rules:[{validator:X,required:!0,trigger:"submit"}]},{default:I((()=>[w(s,{onKeyup:a[17]||(a[17]=e=>ae.line=ae.line.replace(/\D/g,"")),style:{width:"50%"},value:ae.line,"onUpdate:value":a[18]||(a[18]=e=>ae.line=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"行"},null,8,["value"]),w(Le,null,{default:I((()=>[w(s,{onKeyup:a[19]||(a[19]=e=>ae.column=ae.column.replace(/\D/g,"")),style:{width:"50%"},value:ae.column,"onUpdate:value":a[20]||(a[20]=e=>ae.column=e),valueModifiers:{trim:!0},placeholder:"请输入",suffix:"列"},null,8,["value"])])),_:1})])),_:1},8,["rules"])])),_:1},8,["model"])])),_:1},8,["visible"])]),T(" 设置监考老师对话框 "),_("div",si,[w(re,{style:{width:"723px"},maskClosable:!1,visible:W.setTeacherShow,"onUpdate:visible":a[22]||(a[22]=e=>W.setTeacherShow=e),title:"设置监考老师",onOk:xe},{footer:I((()=>[w(m,{key:"back",onClick:Ce},{default:I((()=>[N("取消")])),_:1}),w(m,{key:"submit",type:"primary",onClick:xe},{default:I((()=>[N("确认")])),_:1})])),default:I((()=>[w(j(ee),{columns:j(c),dataSource:W.setTeacherList,bordered:!1,"row-key":e=>e.id},{bodyCell:I((({column:e,text:i,record:a,index:t})=>["timeList"===e.dataIndex?(C(),M(q,{key:0},[N(P(a.timeList[0]+"-"+a.timeList[1].split(" ")[1]),1)],64)):T("v-if",!0),"invigilator"===e.dataIndex?(C(),k(y,{key:1,value:a.invigilator,"onUpdate:value":e=>a.invigilator=e,style:{width:"300px"},open:!1,onChange:e=>{return i=e,t=a,W.teacherCheckedList=t.invigilatorTeacher.filter((e=>i.includes(e.personId))),void(t.invigilatorTeacher=W.teacherCheckedList);var i,t},placeholder:"请选择",options:a.invigilatorTeacher,showArrow:"","max-tag-count":4,mode:"multiple","field-names":{label:"personName",value:"personId"}},{suffixIcon:I((()=>[w(m,{onClick:e=>fe(a,t,"invigilator"),type:"primary",size:"small",style:{bottom:"6px",right:"8px",display:"flex","align-items":"center","justify-content":"center"}},{icon:I((()=>[w(b)])),_:2},1032,["onClick"])])),_:2},1032,["value","onUpdate:value","onChange","options"])):T("v-if",!0)])),_:1},8,["columns","dataSource","row-key"])])),_:1},8,["visible"])]),T(" 选择主考员/巡考员 "),w(j(p),{mode:"personnel",tabs:W.patrolExaminer,visible:W.managerVisible,"onUpdate:visible":a[23]||(a[23]=e=>W.managerVisible=e),selectedKeys:[],checked:W.teacherCheckedList,"onUpdate:checked":a[24]||(a[24]=e=>W.teacherCheckedList=e),onHandleOk:be},null,8,["tabs","visible","checked"]),T(" 年级选择 "),w(j(p),{multiple:!0,treeData:Y.value.value,tabs:W.selectTabs,mode:"depa",visible:W.classVisible,"onUpdate:visible":a[25]||(a[25]=e=>W.classVisible=e),selectedKeys:[],checked:W.gradeCheckedList,"onUpdate:checked":a[26]||(a[26]=e=>W.gradeCheckedList=e),onHandleOk:he},null,8,["treeData","tabs","visible","checked"])],64)}}},[["__scopeId","data-v-0f689d59"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/comp/children/grade.vue"]]);const oi=(e=>(Y("data-v-33c6b3a1"),e=e(),H(),e))((()=>_("div",{class:"title"},"考试时间设置：",-1))),ni={key:0},ri={key:0};var di=u({__name:"examSet",setup(e,{expose:i}){const a=g(),t=y((()=>"look"===a.query.type)),l=h(),o=h(),n=b({timeType:1});return L((()=>{a.query.id&&(async()=>{const{data:e}=await s({id:a.query.id});n.timeType=e.type})(),n.Rawdata=l.value.state})),F((()=>{var e,i;1===n.timeType?n.Rawdata=null==(e=l.value)?void 0:e.state:n.Rawdata=null==(i=o.value)?void 0:i.state})),i({state:n}),(e,i)=>{const a=x("a-radio"),s=x("a-radio-group");return C(),M(q,null,[oi,w(s,{value:n.timeType,"onUpdate:value":i[0]||(i[0]=e=>n.timeType=e),name:"radioGroup",disabled:t.value},{default:I((()=>[w(a,{value:1},{default:I((()=>[N("统一考试时间")])),_:1}),w(a,{value:2},{default:I((()=>[N("分年级考试时间")])),_:1})])),_:1},8,["value","disabled"]),T(" 统一考试页面 "),1===n.timeType?(C(),M("div",ni,[w(j(Ue),{ref_key:"unifyref",ref:l},null,512)])):T("v-if",!0),w(O,{name:"fade",mode:"out-in"},{default:I((()=>[2===n.timeType?(C(),M("div",ri,[w(j(li),{ref_key:"graderef",ref:o},null,512)])):T("v-if",!0)])),_:1})],64)}}},[["__scopeId","data-v-33c6b3a1"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/comp/examSet.vue"]]);const ui=e=>(Y("data-v-4b9a897e"),e=e(),H(),e),ci={class:"create_warp"},mi={class:"header"},pi={style:{display:"inline-block"}},vi=ui((()=>_("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),gi={class:"stepsBox"},fi=ui((()=>_("div",null,null,-1))),bi={key:0,class:"footer"},yi={key:0,class:"nextBox"};var hi=u({__name:"examAddOrEdit",setup(i){const{formState:a}=W(),t=f(),s=g(),l=y((()=>"look"===s.query.type)),u=y((()=>"look"===s.query.type?"查看":"amend"===s.query.type?"修改":"新增")),m=h(),p=h(),v=b({iscomp:"info"}),L=()=>{v.iscomp="info"},j=()=>{m.value.infoFormRef.validateFields().then((()=>{v.iscomp="set",c.set("examNewForm",2)}))},S=async()=>{if(s.query.id){const i=U(a),l=U(p.value.state),r={id:s.query.id,...i,type:l.timeType,subjectList:l.Rawdata.subjectList,groupList:l.Rawdata.groupList,groupConfigList:l.Rawdata.groupConfigList};1===l.timeType?(await o(r),e.success("修改成功!"),t.push({path:"/appModel/examManage/list"})):(delete r.subjectList,await n(r),e.success("修改成功!"),t.push({path:"/appModel/examManage/list"}))}else{const i=U(a),s=U(p.value.state),l={...i,type:s.timeType,subjectList:s.Rawdata.subjectList,groupList:s.Rawdata.groupList,groupConfigList:s.Rawdata.groupConfigList};1===s.timeType?(await r(l),e.success("新增成功!"),t.push({path:"/appModel/examManage/list"})):(delete l.subjectList,await d(l),e.success("新增成功!"),t.push({path:"/appModel/examManage/list"}))}},A=()=>{v.iscomp="info"},K=()=>{m.value.infoFormRef.validateFields().then((()=>{v.iscomp="set",c.set("examNewForm",2)}))},q=()=>{t.push({path:"/appModel/examManage/list"})};return(e,i)=>{const a=x("a-button");return C(),M("div",ci,[_("div",mi,[_("div",pi,[w(a,{type:"text",class:"tabs_back",onClick:q},{default:I((()=>[vi])),_:1}),_("span",null,P(u.value)+"考试",1)]),_("div",gi,[_("div",{style:{display:"inline-flex","align-items":"center","margin-right":"60px",cursor:"pointer"},class:D("info"===v.iscomp?"activeBorder":""),onClick:A},[_("div",{class:D("info"===v.iscomp?"circleActivate":"circle")},[_("span",{class:D("info"===v.iscomp?"ytextActivate":"ytext")},"1",2)],2),_("div",{class:D("info"===v.iscomp?"textActivate":"text")}," 基本信息 ",2)],2),_("div",{style:{display:"inline-flex","align-items":"center",cursor:"pointer"},onClick:K,class:D("set"===v.iscomp?"activeBorder":"")},[_("div",{class:D("set"===v.iscomp?"circleActivate":"circle")},[_("span",{class:D("set"===v.iscomp?"ytextActivate":"ytext")},"2",2)],2),_("div",{class:D("set"===v.iscomp?"textActivate":"text")}," 考试设置 ",2)],2)])]),T(" 考试基本信息页面 "),_("div",{class:D({body:!0,center:"info"===v.iscomp})},["info"===v.iscomp?(C(),k(Z,{key:0,ref_key:"info",ref:m},null,512)):T("v-if",!0),(C(),k(B,null,["set"===v.iscomp?(C(),k(di,{key:0,ref_key:"set",ref:p},null,512)):T("v-if",!0)],1024))],2),fi,l.value?T("v-if",!0):(C(),M("div",bi,["info"===v.iscomp?(C(),M("div",yi,[w(a,{class:"planBtns",type:"primary",onClick:j},{default:I((()=>[N("下一步")])),_:1})])):T("v-if",!0),_("div",null,["set"===v.iscomp?(C(),k(a,{key:0,class:"planBtn",onClick:L},{default:I((()=>[N("上一步")])),_:1})):T("v-if",!0),"set"===v.iscomp?(C(),k(a,{key:1,class:"planBtn",type:"primary",onClick:S},{default:I((()=>[N("提交")])),_:1})):T("v-if",!0)])]))])}}},[["__scopeId","data-v-4b9a897e"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/examAddOrEdit.vue"]]);export{hi as default};
