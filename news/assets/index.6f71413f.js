import"./vue.a2f518ee.js";import{u as e,a as s}from"./vue-router.907b547c.js";import{a as t,s as a}from"./siteDetail.3ffd69d1.js";import{_ as i}from"./index.272083a4.js";import{S as o}from"./SearchForm.90e601d6.js";import{s as n,t as l}from"./signInSheet.1d637576.js";import{m as p}from"./ant-design-vue.db4d48e3.js";import{b as r,c as m,g as d,j as u}from"./siteBooking.8c7dbe73.js";import{_ as c}from"./index.7061e8ea.js";import{Q as g,r as y,q as b,f,b8 as j,o as h,a as v,b as k,c as I,a3 as x,a2 as w,F as N,a8 as S,a4 as T,a9 as _,M as F,O as C,a7 as L,u as B,n as R}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./dayjs.49e29cb2.js";import"./siteImg.e530de90.js";import"./chooseSite.149fe6d3.js";import"./index.7c2c5596.js";import"./@fullcalendar.ad7c7755.js";import"./tslib.792e82ab.js";import"./preact.c7815627.js";import"./rrule.c06e606d.js";import"./tippy.js.395eb5fc.js";import"./@popperjs.19b6ba11.js";import"./uuid.73c2ed78.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const V={class:"warps"},D={key:0,class:"site_booking"},O={class:"search_form"},z={class:"table"},E={key:0},J={key:1},q=["onClick"],U=["onClick"],M={key:1,style:{color:"#ccc"},disabled:!0};var Q=c({__name:"index",setup(c){const Q=["拒绝","审批中","已通过","已取消","已过期"],G=["error","warning","success","default","default"],K=g({}),P=y(),A=e(),H=s(),W=b({spinLoad:!1,showFlag:!1,showFlag1:!1,showFlag2:!1,onStatus:!1,isVisible:!1,visibleJ:!1,isOpen:!1,open:!0,close:!1,name:"",status:"",themeitem:{signIn:!1,bookingTime:"",sponsorName:"",signList:[],describe:"",siteInfo:{},she:"会议机，投影仪"},audits:{sponsorName:"",sponsorTime:"",approvalTimeStr:"",shenpis:[],refuseReason:""},myBookDetailId:"",ju:"",maxNum:300,textNum:0,recordTable:[],statusList:[{statusName:"全部",status:null},{statusName:"已拒绝",status:0},{statusName:"审批中",status:1},{statusName:"已通过",status:2},{statusName:"已取消",status:3},{statusName:"已过期",status:4}],pagination:{pageNo:1,pageSize:10,total:0},appointType:[],appointTypes:[],statusIndex:0,typeIndex:0,typeId:""}),X=()=>{W.showFlag=!1,W.showFlag1=!1},Y=()=>{W.showFlag=!1,W.showFlag2=!1,R((()=>{re()}))},Z=()=>{W.isVisible=!1},$=e=>{e?(W.isOpen=!0,W.open=!1,W.close=!0):(W.isOpen=!1,W.open=!0,W.close=!1)},ee=()=>{m({status:3,id:W.myBookDetailId}).then((e=>{0===e.code&&(re(),W.isVisible=!1,p.success(e.message))}))},se=()=>{W.isVisible=!1,W.showFlag=!0,W.showFlag2=!0,r({id:W.myBookDetailId}).then((e=>{const{data:s}=e;K.value=s}))},te=()=>{W.visibleJ=!0},ae=()=>{W.ju="",W.textNum=0},ie=()=>{W.ju.trim()?m({status:0,refuseReason:W.ju,id:W.myBookDetailId}).then((e=>{0===e.code&&(re(),W.visibleJ=!1,W.isVisible=!1,p.success(e.message))})):p.warning("请输入拒绝原因")},oe=()=>{m({status:2,id:W.myBookDetailId}).then((e=>{0===e.code&&(re(),W.isVisible=!1,p.success(e.message))}))},ne=e=>{const{current:s,pageSize:t}=e;W.pagination.pageNo=s,W.pagination.pageSize=t,re()},le=()=>{re()},pe=()=>{W.pagination.pageNo=1,re()},re=(e="",s=null)=>{const t={},a=P.value.sear;t.pageNo=W.pagination.pageNo,t.pageSize=W.pagination.pageSize,t.name=a.name,t.sponsorName=a.sponsorName,t.startTime=a.time[0],t.endTime=a.time[1],t.siteName=a.siteName,t.siteTypeId=a.siteTypeId,t.buildingId=a.buildingId,t.siteBookingTypeId=e,t.status=s,W.spinLoad=!0,u(t).then((e=>{const{list:s,total:t,pageNo:a,pageSize:i}=e.data;W.recordTable=s,W.pagination.pageNo=a,W.pagination.pageSize=i,W.pagination.total=t,W.spinLoad=!1})).finally((()=>{W.spinLoad=!1}))};return f((()=>{d().then((e=>{W.appointType=e.data,W.appointTypes=[{name:"全部",id:""}].concat(W.appointType)})),re()})),(e,s)=>{const p=j("caret-down-outlined"),m=j("a-menu-item"),d=j("a-menu"),u=j("a-dropdown"),c=j("a-badge"),g=j("a-textarea"),y=j("a-modal");return h(),v("div",V,[W.showFlag?L("v-if",!0):(h(),v("div",D,[k("div",O,[I(o,{ref_key:"searRef",ref:P,onQueryList:le,onResetList:pe,showBooker:!0},null,512)]),k("div",z,[I(i,{columns:B(t),dataSource:W.recordTable,slots:["operation"],rowSelection:!1,totals:W.pagination,spinLoad:W.spinLoad,onOnSelectedRowKeys:ne},{headerCell:x((({column:e})=>["siteBookingTypeName"===e.dataIndex?(h(),w(u,{key:0},{overlay:x((()=>[I(d,null,{default:x((()=>[(h(!0),v(N,null,S(W.appointTypes,((e,s)=>(h(),w(m,{key:s,onClick:t=>((e,s)=>{W.typeIndex=s,W.typeId=e.id,W.pagination.pageNo=1,W.statusIndex=0,re(e.id,null)})(e,s)},{default:x((()=>[k("span",{class:T(W.typeIndex===s?"actt":"")},_(e.name),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:x((()=>[k("a",{style:{color:"#000"},onClick:s[0]||(s[0]=F((()=>{}),["prevent"]))},[C(" 预约类型 "),I(p,{style:{color:"var(--primary-color)"}})])])),_:1})):L("v-if",!0),"status"===e.dataIndex?(h(),w(u,{key:1},{overlay:x((()=>[I(d,null,{default:x((()=>[(h(!0),v(N,null,S(W.statusList,((e,s)=>(h(),w(m,{key:s,onClick:t=>((e,s)=>{W.statusIndex=s,W.pagination.pageNo=1,W.typeIndex=0,re("",e.status)})(e,s)},{default:x((()=>[k("span",{class:T(W.statusIndex===s?"acti":"")},_(e.statusName),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:x((()=>[k("a",{style:{color:"#000"},onClick:s[1]||(s[1]=F((()=>{}),["prevent"]))},[C(" 审核状态 "),I(p,{style:{color:"var(--primary-color)"}})])])),_:1})):L("v-if",!0)])),bodyCell:x((({column:e,record:s})=>["signIn"===e.dataIndex?(h(),v(N,{key:0},[s.signIn?(h(),v("span",E,"需签到")):(h(),v("span",J,"无需签到"))],64)):L("v-if",!0),"status"===e.dataIndex?(h(),v(N,{key:1},[4!=s.status?(h(),w(c,{key:0,status:G[s.status],text:Q[s.status]},null,8,["status","text"])):(h(),w(c,{key:1,style:{color:"#ccc"},status:G[s.status],text:Q[s.status]},null,8,["status","text"]))],64)):L("v-if",!0),"operation"===e.dataIndex?(h(),v(N,{key:2},[k("a",{onClick:e=>(e=>{W.myBookDetailId=e.id,W.onStatus=!1,r({id:e.id}).then((e=>{const{data:s}=e;W.name=s.name,W.themeitem.signIn=s.signIn,W.themeitem.bookingTime=s.bookingTime,W.themeitem.sponsorName=s.sponsorName,W.themeitem.signList=s.signList,W.themeitem.describe=s.describe,W.themeitem.siteInfo=s.siteInfo,W.audits.shenpis=s.siteInfo.list,W.audits.sponsorName=s.sponsorName,W.audits.refuseReason=s.refuseReason,W.audits.sponsorTime=s.sponsorTime,W.audits.approvalTimeStr=s.approvalTimeStr,W.status=s.status})),W.isVisible=!0})(s),style:{color:"var(--primary-color)","margin-right":"10px"}},"详情",8,q),2===s.status&&s.signIn?(h(),v("a",{key:0,onClick:e=>{return t=s,A.replace({query:{...H.query,type:"true",siteBookingId:t.id}}),W.showFlag=!0,void(W.showFlag1=!0);var t},style:{color:"var(--primary-color)"}},"签到表",8,U)):(h(),v("a",M,"签到表"))],64)):L("v-if",!0)])),_:1},8,["columns","dataSource","totals","spinLoad"])])])),L(" 签到表 "),W.showFlag1?(h(),w(n,{key:1,onShowViews:X,class:T(W.showFlag1?"top01":"")},null,8,["class"])):L("v-if",!0),L(" 预约申请 "),W.showFlag2?(h(),w(l,{key:2,onShowView:Y,typeId:W.typeId,bookDetail:K.value,class:T(W.showFlag2?"top02":"")},null,8,["typeId","bookDetail","class"])):L("v-if",!0),L(" 预约详情 "),I(a,{onEmithandleCancel:Z,onOpened:$,onEmitCancelBook:ee,onEmitReEdit:se,onEmitRefuse:te,onEmitPass:oe,title:"查看详情",onStatus:W.onStatus,open:W.open,nobtn:!1,close:W.close,isOpen:W.isOpen,audits:W.audits,isVisible:W.isVisible,themeitem:W.themeitem,status:Number(W.status),name:W.name},null,8,["onStatus","open","close","isOpen","audits","isVisible","themeitem","status","name"]),L(" 拒绝原因弹框 "),I(y,{visible:W.visibleJ,"onUpdate:visible":s[4]||(s[4]=e=>W.visibleJ=e),title:"拒绝原因",onOk:ie,onCancel:ae},{default:x((()=>[I(g,{maxlength:W.maxNum,value:W.ju,"onUpdate:value":s[2]||(s[2]=e=>W.ju=e),onInput:s[3]||(s[3]=s=>e.GetTextNumber()),showCount:"",placeholder:"请输入拒绝原因","auto-size":{minRows:3,maxRows:5}},null,8,["maxlength","value"])])),_:1},8,["visible"])])}}},[["__scopeId","data-v-0b2ee369"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/siteBooking/appointmentRecord/index.vue"]]);export{Q as default};
