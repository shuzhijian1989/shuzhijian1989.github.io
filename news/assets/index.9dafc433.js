import"./vue.a2f518ee.js";import{u as e,a}from"./vue-router.907b547c.js";import{_ as s}from"./index.272083a4.js";import{c as t,a as i,s as o}from"./siteDetail.3ffd69d1.js";import{m as n,a as l,b as p,c as d,g as r}from"./siteBooking.8c7dbe73.js";import{S as m}from"./SearchForm.90e601d6.js";import{s as u,t as c}from"./signInSheet.1d637576.js";import{m as g}from"./ant-design-vue.db4d48e3.js";import{_ as y}from"./index.7061e8ea.js";import{r as b,Q as v,q as f,f as k,b8 as h,o as j,a as I,b as N,F as x,a8 as T,a9 as w,c as S,a3 as _,O as C,a2 as L,a4 as F,M as B,a7 as z,H as V,L as D,u as O,b5 as R,b4 as q}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./dayjs.49e29cb2.js";import"./siteImg.e530de90.js";import"./chooseSite.149fe6d3.js";import"./index.7c2c5596.js";import"./@fullcalendar.ad7c7755.js";import"./tslib.792e82ab.js";import"./preact.c7815627.js";import"./rrule.c06e606d.js";import"./tippy.js.395eb5fc.js";import"./@popperjs.19b6ba11.js";import"./uuid.73c2ed78.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const E={class:"warps"},M={key:0,class:"site_booking"},J=(e=>(R("data-v-399db0ad"),e=e(),q(),e))((()=>N("div",{class:"top"},"点击下方预约类型，即可进入预约：",-1))),U={class:"box"},A=["onClick"],Q={class:"text"},H={class:"name"},K={class:"num"},P={class:"tabs"},G={class:"search_form"},W={class:"table"},X=["onClick"],Y=["onClick"],Z=["onClick"],$={key:1,style:{color:"#ccc"},disabled:!0},ee={key:2},ae={key:0},se={key:1},te={class:"max"};var ie=y({__name:"index",setup(y){const R=b(),q=e(),ie=a(),oe=v({}),ne=f({showFlag:!1,showFlag1:!1,showFlag2:!1,onStatus:!1,isVisible:!1,visibleJ:!1,isOpen:!1,open:!0,close:!1,name:"",status:"",themeitem:{signIn:!1,bookingTime:"",sponsorName:"",signList:[],describe:"",siteInfo:{},she:"会议机，投影仪"},audits:{sponsorName:"",sponsorTime:"",approvalTimeStr:"",shenpis:[],refuseReason:""},appointType:[],appointTypes:[],type:0,bookingTable:[],bookingTableMy:[],statusList:[{statusName:"全部",status:null},{statusName:"已拒绝",status:0},{statusName:"审批中",status:1},{statusName:"已通过",status:2},{statusName:"已取消",status:3},{statusName:"已过期",status:4}],statusx:0,typeIndex:0,typeId:"",pagination:{pageNo:1,pageSize:10,total:0},spinLoad:!1,myBookDetailId:"",ju:"",maxNum:300,textNum:0}),le=()=>{ne.showFlag=!1,ne.showFlag1=!1},pe=()=>{const e={pageNo:1,pageSize:10};ne.spinLoad=!0,0===ne.type?n(e).then((e=>{const{list:a,total:s,pageNo:t,pageSize:i}=e.data;ne.bookingTable=a,ne.pagination.pageNo=t,ne.pagination.pageSize=i,ne.pagination.total=s,ne.spinLoad=!1})):l(e).then((e=>{const{list:a,total:s,pageNo:t,pageSize:i}=e.data;ne.bookingTableMy=a,ne.pagination.pageNo=t,ne.pagination.pageSize=i,ne.pagination.total=s,ne.spinLoad=!1})),ne.showFlag=!1,ne.showFlag2=!1},de=e=>{ne.myBookDetailId=e.id,0===ne.type?(ne.onStatus=!0,ne.status=""):ne.onStatus=!1,p({id:e.id}).then((e=>{const{data:a}=e;ne.name=a.name,ne.themeitem.signIn=a.signIn,ne.themeitem.bookingTime=a.bookingTime,ne.themeitem.sponsorName=a.sponsorName,ne.themeitem.signList=a.signList,ne.themeitem.describe=a.describe,ne.themeitem.siteInfo=a.siteInfo,ne.audits.shenpis=a.siteInfo.list,ne.audits.sponsorName=a.sponsorName,ne.audits.refuseReason=a.refuseReason,ne.audits.sponsorTime=a.sponsorTime,ne.audits.approvalTimeStr=a.approvalTimeStr,ne.status=a.status})),ne.isVisible=!0},re=()=>{ne.isVisible=!1},me=e=>{e?(ne.isOpen=!0,ne.open=!1,ne.close=!0):(ne.isOpen=!1,ne.open=!0,ne.close=!1)},ue=()=>{d({status:3,id:ne.myBookDetailId}).then((e=>{0===e.code&&(Ne(),ne.isVisible=!1,g.success(e.message))}))},ce=()=>{ne.isVisible=!1,ne.showFlag=!0,ne.showFlag2=!0,p({id:ne.myBookDetailId}).then((e=>{const{data:a}=e;oe.value=a}))},ge=()=>{ne.visibleJ=!0},ye=()=>{ne.ju="",ne.textNum=0},be=()=>{ne.ju.trim()?d({status:0,refuseReason:ne.ju,id:ne.myBookDetailId}).then((e=>{0===e.code&&(Ne(),ne.visibleJ=!1,ne.isVisible=!1,g.success(e.message))})):g.warning("请输入拒绝原因")},ve=()=>{d({status:2,id:ne.myBookDetailId}).then((e=>{0===e.code&&(Ne(),ne.isVisible=!1,g.success(e.message))}))},fe=()=>{0===ne.type?Ie():Ne()},ke=()=>{ne.pagination.pageNo=1,0===ne.type?Ie():Ne()},he=e=>{const{current:a,pageSize:s}=e;ne.pagination.pageNo=a,ne.pagination.pageSize=s,0===ne.type?Ie():Ne()},je=e=>{ne.pagination.pageNo=1,0===e.target.value?Ie():Ne()},Ie=(e="")=>{const a={},s=R.value.sear;a.pageNo=ne.pagination.pageNo,a.pageSize=ne.pagination.pageSize,a.name=s.name,a.startTime=s.time[0],a.endTime=s.time[1],a.siteName=s.siteName,a.siteTypeId=s.siteTypeId,a.buildingId=s.buildingId,a.siteBookingTypeId=e,ne.spinLoad=!0,n(a).then((e=>{const{list:a,total:s,pageNo:t,pageSize:i}=e.data;ne.bookingTable=a,ne.pagination.pageNo=t,ne.pagination.pageSize=i,ne.pagination.total=s,ne.spinLoad=!1})).finally((()=>{ne.spinLoad=!1}))},Ne=(e="",a=null)=>{const s={},t=R.value.sear;s.pageNo=ne.pagination.pageNo,s.pageSize=ne.pagination.pageSize,s.name=t.name,s.startTime=t.time[0],s.endTime=t.time[1],s.siteName=t.siteName,s.siteTypeId=t.siteTypeId,s.buildingId=t.buildingId,s.siteBookingTypeId=e,s.status=a,ne.spinLoad=!0,l(s).then((e=>{const{list:a,total:s,pageNo:t,pageSize:i}=e.data;ne.bookingTableMy=a,ne.pagination.pageNo=t,ne.pagination.pageSize=i,ne.pagination.total=s,ne.spinLoad=!1})).finally((()=>{ne.spinLoad=!1}))};return k((()=>{r().then((e=>{ne.appointType=e.data,ne.appointTypes=[{name:"全部",id:""}].concat(ne.appointType)})),Ie("")})),(e,a)=>{const n=h("a-radio-button"),l=h("a-radio-group"),p=h("caret-down-outlined"),d=h("a-menu-item"),r=h("a-menu"),g=h("a-dropdown"),y=h("a-badge"),b=h("a-textarea"),v=h("a-modal");return j(),I("div",E,[ne.showFlag?z("v-if",!0):(j(),I("div",M,[J,N("div",U,[(j(!0),I(x,null,T(ne.appointType,((e,a)=>(j(),I("div",{class:"item",key:a,onClick:a=>(e=>{ne.typeId=e.id,oe.value={},q.replace({query:{...ie.query,type:"true"}}),ne.showFlag=!0,ne.showFlag2=!0})(e)},[N("div",Q,[N("div",H,w(e.name),1),N("div",K,"当前预约: "+w(e.num)+"场",1)])],8,A)))),128))]),N("div",P,[S(l,{value:ne.type,"onUpdate:value":a[0]||(a[0]=e=>ne.type=e),onChange:je,"button-style":"solid"},{default:_((()=>[S(n,{class:"radio",value:0},{default:_((()=>[C("我参与的预约")])),_:1}),S(n,{class:"radio",value:1},{default:_((()=>[C("我的预约")])),_:1})])),_:1},8,["value"])]),N("div",G,[S(m,{ref_key:"searRef",ref:R,onQueryList:fe,onResetList:ke,showAudit:1==ne.type},null,8,["showAudit"])]),N("div",W,[S(s,{columns:0==ne.type?O(t):O(i),dataSource:0==ne.type?ne.bookingTable:ne.bookingTableMy,slots:["operation"],rowSelection:!1,totals:ne.pagination,spinLoad:ne.spinLoad,onOnSelectedRowKeys:he},{headerCell:_((({column:e})=>["siteBookingTypeName"===e.dataIndex?(j(),L(g,{key:0},{overlay:_((()=>[S(r,null,{default:_((()=>[(j(!0),I(x,null,T(ne.appointTypes,((e,a)=>(j(),L(d,{key:a,onClick:s=>((e,a)=>{ne.typeIndex=a,ne.typeId=e.id,ne.pagination.pageNo=1,0===ne.type?Ie(e.id):(ne.statusx=0,Ne(e.id))})(e,a)},{default:_((()=>[N("span",{class:F(ne.typeIndex===a?"actt":"")},w(e.name),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:_((()=>[N("a",{style:{color:"#000"},onClick:a[1]||(a[1]=B((()=>{}),["prevent"]))},[C(" 预约类型 "),S(p,{style:{color:"var(--primary-color)"}})])])),_:1})):z("v-if",!0),"status"===e.dataIndex&&1==ne.type?(j(),L(g,{key:1},{overlay:_((()=>[S(r,null,{default:_((()=>[(j(!0),I(x,null,T(ne.statusList,((e,a)=>(j(),L(d,{key:a,onClick:s=>((e,a)=>{ne.statusx=a,ne.typeIndex=0,Ne("",e.status)})(e,a)},{default:_((()=>[N("span",{class:F(ne.statusx===a?"acti":"")},w(e.statusName),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:_((()=>[V(N("a",{style:{color:"#000"},onClick:a[2]||(a[2]=B((()=>{}),["prevent"]))},[C(" 审核状态 "),S(p,{style:{color:"var(--primary-color)"}})],512),[[D,1==ne.type]])])),_:1})):z("v-if",!0)])),bodyCell:_((({column:e,record:a})=>["operation"===e.dataIndex&&0===ne.type?(j(),I("a",{key:0,onClick:e=>de(a),style:{color:"var(--primary-color)","margin-right":"10px"}},"查看",8,X)):z("v-if",!0),"operation"===e.dataIndex&&1===ne.type?(j(),I(x,{key:1},[N("a",{onClick:e=>de(a),style:{color:"var(--primary-color)","margin-right":"10px"}},"详情",8,Y),2===a.status&&a.signIn?(j(),I("a",{key:0,onClick:e=>{return s=a,q.replace({query:{...ie.query,type:"true",siteBookingId:s.id}}),window.localStorage.setItem("_siteBookingId",s.id),ne.showFlag=!0,void(ne.showFlag1=!0);var s},style:{color:"var(--primary-color)"}},"签到表",8,Z)):(j(),I("a",$,"签到表"))],64)):z("v-if",!0),"siteBookingTypeName"===e.dataIndex?(j(),I("span",ee,w(a.siteBookingTypeName?a.siteBookingTypeName:"-"),1)):z("v-if",!0),"signIn"===e.dataIndex?(j(),I(x,{key:3},[a.signIn?(j(),I("span",ae,"需签到")):(j(),I("span",se,"无需签到"))],64)):z("v-if",!0),"status"===e.dataIndex?(j(),I(x,{key:4},[z(" // 0.拒绝、1.审批中、2.已通过、3.已取消、4.已过期 "),0===a.status?(j(),L(y,{key:0,status:"error",text:"已拒绝"})):z("v-if",!0),1===a.status?(j(),L(y,{key:1,status:"warning",text:"审批中"})):z("v-if",!0),2===a.status?(j(),L(y,{key:2,status:"success",text:"已通过"})):z("v-if",!0),3===a.status?(j(),L(y,{key:3,status:"default",text:"已取消"})):z("v-if",!0),4===a.status?(j(),L(y,{key:4,status:"default",style:{color:"#ccc"},text:"已过期"})):z("v-if",!0)],64)):z("v-if",!0)])),_:1},8,["columns","dataSource","totals","spinLoad"])])])),z(" 签到表 "),ne.showFlag1?(j(),L(u,{key:1,onShowViews:le,class:F(ne.showFlag1?"top01":"")},null,8,["class"])):z("v-if",!0),z(" 预约申请 "),ne.showFlag2?(j(),L(c,{key:2,onShowView:pe,bookDetail:oe.value,typeId:ne.typeId,class:F(ne.showFlag2?"top02":"")},null,8,["bookDetail","typeId","class"])):z("v-if",!0),z(" 预约详情 "),S(o,{onEmithandleCancel:re,onOpened:me,onEmitCancelBook:ue,onEmitReEdit:ce,onEmitRefuse:ge,onEmitPass:ve,title:"查看详情",onStatus:ne.onStatus,nobtn:!1,open:ne.open,close:ne.close,isOpen:ne.isOpen,audits:ne.audits,isVisible:ne.isVisible,themeitem:ne.themeitem,status:Number(ne.status),name:ne.name},null,8,["onStatus","open","close","isOpen","audits","isVisible","themeitem","status","name"]),z(" 拒绝原因弹框 "),S(v,{visible:ne.visibleJ,"onUpdate:visible":a[5]||(a[5]=e=>ne.visibleJ=e),title:"拒绝原因",onOk:be,onCancel:ye},{default:_((()=>[S(b,{maxlength:ne.maxNum,value:ne.ju,"onUpdate:value":a[3]||(a[3]=e=>ne.ju=e),onInput:a[4]||(a[4]=e=>{ne.textNum=ne.ju.length}),placeholder:"请输入拒绝原因",style:{height:"120px","overflow-y":"scroll"}},null,8,["maxlength","value"]),N("div",te,w(ne.textNum)+"/"+w(ne.maxNum),1)])),_:1},8,["visible"])])}}},[["__scopeId","data-v-399db0ad"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/siteBooking/siteBook/index.vue"]]);export{ie as default};
