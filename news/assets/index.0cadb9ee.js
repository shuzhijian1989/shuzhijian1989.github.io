import"./vue.a2f518ee.js";import{D as e}from"./index.1cbb3529.js";import{_ as t}from"./index.272083a4.js";import{u as s}from"./vue-router.907b547c.js";import{_ as a,u as i}from"./index.7061e8ea.js";import{S as l}from"./SetStudent.d76bc447.js";import{g as o}from"./FilterDropdown.5a779a00.js";import{g as r,p as d,a as n,b as c}from"./historicalUser.5cdfb7d4.js";import{e as p,r as u,q as m,f,b8 as h,I as y,o as g,a as v,a7 as j,H as b,L as x,b as S,c as I,a3 as w,a2 as _,aK as N,O as k,a9 as D,b5 as F,b4 as K}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./element-plus.8ba44712.js";import"./@vueuse.66569c4a.js";import"./@element-plus.8b57b6bd.js";const E={class:"studentDiv sutdud"},T={class:"history_student"},z={class:"left"},C={class:"right"},L=(e=>(F("data-v-b768573e"),e=e(),K(),e))((()=>S("p",{class:"right_text"},"历史成员列表",-1))),U={key:0,class:"editable-row-operations"},q=["onClick"],P={class:"student-details"},M={class:"details_title"},O={class:"history_student_details"};var $=a(p({__name:"index",setup(a){const p=s(),F=i(),{roll_status_no_id:K,roll_status_no_filters:$}=F.state.selectSource.dictionary,A=u(!1),H=m({yearId:"",rollId:"",studentDetail:{},studentStatusTree:[],defaultExpand:[],selectedKeys:[],searchName:"",status:"",classesName:"",studentName:"",flag:!0,isFacultyForm:!0,dataSource:[],pagination:{pageNo:1,pageSize:10,total:0},fieldNames:{children:"children",title:"name",key:"ids"}}),R=u([{title:"姓名",dataIndex:"name",key:"id",width:150,ellipsis:!0,showSorterTooltip:!0},{title:"班级",dataIndex:"className",key:"classesName",ellipsis:!0,showSorterTooltip:!0,filters:[{text:"全部",value:""},...$],pathColor:!1,filterMultiple:!1,filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",o(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"},{title:"学号",dataIndex:"studentNo",key:"id",ellipsis:!0,showSorterTooltip:!0},{title:"入学时间",dataIndex:"admissionDate",key:"id",ellipsis:!0,showSorterTooltip:!0},{title:"学籍状态",dataIndex:"status",key:"status",ellipsis:!0,filters:[{text:"全部",value:""},...$],pathColor:!1,filterMultiple:!1,showSorterTooltip:!0,filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",o(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"},{title:"离校时间",dataIndex:"leaveFinishDate",key:"id",ellipsis:!0,showSorterTooltip:!0},{title:"离校原因",dataIndex:"leaveCause",key:"id",ellipsis:!0,showSorterTooltip:!0},{title:"操作",dataIndex:"operation",key:"id",align:"left",width:"110px"}]),B=e=>{if(!e.includes("_"))return;H.pagination.pageNo=1,H.pagination.pageSize=10,H.selectedKeys=[e];const t=e.split("_");H.yearId=t[0],H.rollId=t[1],X(),W()},G=e=>{if(void 0===e)return;const{status:t,classesName:s,pageSize:a,current:i}=e;t&&(H.status=t[0]+""),s&&(H.classesName=s[0]+""),H.pagination.pageNo=i,H.pagination.pageSize=a,W()},J=()=>{H.isFacultyForm=!0},Q=e=>{r({id:e}).then((e=>{const{data:t}=e;H.studentDetail=t}))},V=()=>{H.pagination.pageNo=1,H.pagination.pageSize=10,W()},W=()=>{const{searchName:e,status:t,classesName:s}=H,{rollId:a,yearId:i}=H,l={status:t,classesName:s,yearId:i,rollId:a,name:e,statusList:K,...H.pagination};A.value=!0,d(l).then((e=>{const{pageNo:t,pageSize:s,total:a,list:i}=e.data;H.pagination.pageNo=t,H.pagination.pageSize=s,H.pagination.total=a,A.value=!1,H.dataSource=i.map((e=>(e.status&&(e.status=`${F.state.selectSource.dictionary[`roll_status_no${e.status}`]}`),e)))})).catch((()=>{A.value=!1}))},X=()=>{const{rollId:e,yearId:t}=H;n({yearId:t,rollId:e,statusList:K}).then((e=>{const{data:t}=e;let s=t.map((e=>({text:e,value:e})));R.value&&R.value.forEach((e=>{"className"===e.dataIndex&&(s=[{text:"全部",value:""},...s],e.filters=s)}))}))};return f((async()=>{await(async()=>{const e={statusList:K};await c(e).then((e=>{const{data:t}=e;let s="",a="";t.length&&(t.forEach((e=>{e.ids=e.id,e.children&&e.children.length&&e.children.forEach((t=>{t.ids=t.id+"_"+e.id}))})),a=t[0].ids,s=t[0].children[0].id,p.push({query:{yearId:s,rollId:a}}),H.defaultExpand=[t[0].id,t[0].children[0].ids],H.selectedKeys=[t[0].children[0].ids],H.yearId=s,H.rollId=t[0].id),H.studentStatusTree=t}))})(),X(),W()})),(s,a)=>{const i=h("a-input-search"),o=h("a-tooltip"),r=y("auth");return g(),v("div",E,[j(" 学生表格页面 "),b(S("div",T,[S("div",z,[I(e,{ref:"dempTree",treeData:H.studentStatusTree,defaultExpand:H.defaultExpand,defaultExpandAll:!0,selectedKeys:H.selectedKeys,fieldNames:H.fieldNames,onEmitSelect:B},null,8,["treeData","defaultExpand","selectedKeys","fieldNames"])]),S("div",C,[I(t,{class:"worker-table",columns:R.value,dataSource:H.dataSource,totals:H.pagination,rowSelection:!1,spinLoad:A.value,onOnSelectedRowKeys:G},{handleItem:w((()=>[L,I(i,{value:H.searchName,"onUpdate:value":a[0]||(a[0]=e=>H.searchName=e),placeholder:"请输入学生姓名搜索",allowClear:"",style:{width:"300px","margin-bottom":"15px"},onSearch:V,onPressEnter:V},null,8,["value"])])),bodyCell:w((({column:e,text:t,record:s})=>["operation"===e.dataIndex?b((g(),v("div",U,[S("a",{onClick:e=>(Q(s.id),void(H.isFacultyForm=!1))},"查看",8,q)])),[[r,"look"]]):(g(),_(o,{key:1,placement:"topLeft"},N({default:w((()=>[k(" "+D(t),1)])),_:2},[(null==t?void 0:t.length)>15?{name:"title",fn:w((()=>[k(D(t),1)])),key:"0"}:void 0]),1024))])),_:1},8,["columns","dataSource","totals","spinLoad"])])],512),[[x,H.isFacultyForm]]),j(" 学生详情页面 "),b(S("div",P,[S("div",M,[S("p",null,[b(S("i",{class:"iconfont icon-xingzhuangjiehe19",onClick:J},null,512),[[r,"look"]]),k(" 查看学生 ")])]),S("div",O,[I(l,{studentDetailPrarms:H.studentDetail},null,8,["studentDetailPrarms"])])],512),[[x,!H.isFacultyForm]])])}}}),[["__scopeId","data-v-b768573e"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/historicalUser/components/eltern/index.vue"]]);export{$ as default};
