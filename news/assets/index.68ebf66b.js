import{_ as e,u as t,p as a,L as l,n as s}from"./index.7061e8ea.js";import"./vue.a2f518ee.js";import{a as n,u as o}from"./vue-router.907b547c.js";import{D as i}from"./index.1cbb3529.js";import{_ as r}from"./index.272083a4.js";import{d}from"./dayjs.49e29cb2.js";import{c as u,a as c}from"./toolsValidate.abcc48cc.js";import{m as p,M as m}from"./ant-design-vue.db4d48e3.js";import{C as h}from"./index.2069fba3.js";import{g as v,b as y,a as f,c as g,d as b,u as k,e as _,f as S,h as w,i as C,j as F,k as x,l as T,m as I,n as L,r as N,o as U,p as j,q as D,t as V,v as E,w as O,x as R,s as P,y as q,z as M,A as z}from"./schoolRoll.370ea454.js";import{Q as $,x as K,q as A,y as Y,w as Q,f as J,n as B,b8 as H,o as G,a as W,c as X,a3 as Z,a2 as ee,b as te,a9 as ae,a7 as le,F as se,a8 as ne,u as oe,a4 as ie,O as re,H as de,L as ue,M as ce,R as pe,b5 as me,b4 as he,e as ve,a5 as ye,m as fe,t as ge,z as be,I as ke,aK as _e,a6 as Se}from"./@vue.919ff404.js";import{E as we,f as Ce}from"./@ant-design.2e172c39.js";import{S as Fe}from"./SetStudent.d76bc447.js";import{I as xe}from"./newindex.34397320.js";import{g as Te}from"./subjectInformation.1a2fd676.js";import{g as Ie}from"./FilterDropdown.5a779a00.js";import{I as Le}from"./index.164d91f7.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./@babel.6d5f88cb.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";import"./cropperjs.fe6d04b8.js";import"./element-plus.8ba44712.js";import"./@vueuse.66569c4a.js";import"./@element-plus.8b57b6bd.js";import"./qrcode.f5521435.js";import"./encode-utf8.c8acd0c0.js";import"./dijkstrajs.9287da7c.js";/* empty css                                                          */import"./workers.a8ab8099.js";const Ne={children:"children",title:"showName",key:"id"},Ue=[{label:"是",value:1},{label:"否",value:0}],je=[{label:"男",value:1},{label:"女",value:0}];const De={key:1},Ve={class:"caption"},Ee={class:"upload-box"},Oe={key:0,class:"no-face"},Re=["src"],Pe={key:0,class:"tip"},qe={class:"upload-isswitch"},Me=(e=>(me("data-v-2005cf6e"),e=e(),he(),e))((()=>te("p",{class:"help",style:{"margin-top":"5px"}}," 只支持：PNG、JPG格式 ",-1))),ze={class:"caption"},$e={class:"caption"},Ke={style:{"text-align":"right"}};var Ae=e({__name:"StudentForm",props:{studentDetailPrarms:{type:Object,default:()=>{}},studentTitle:{type:String,default:"添加学生"},isHader:{type:Boolean,default:!1}},emits:["smitStudentForm"],setup(e,{emit:l}){const s=e,n=$(!1),o=K("routeQuerys")(),i=t(),{political_status:r,accommodation:m,roll_status:_,roll_status_yes:S,health_status:w,blood_type:C,household_type:F,nation:x,id_type:T,relations:I,country:L,student_education_status:N,student_academic_system_status:U,student_second_degree_status:j}=i.state.selectSource.dictionary,D=A({rowCol:{gutter:24,span:8},activeTabs:"studentInformation",isHistory:!1,multipleTrue:!1,loading:!1,visibles:!1,isExpandCollapse:!1,checkedList:[],selectMode:"depa",selectTabs:[{tab:"班级",key:2,checked:!0}],pagination:{pageNo:1,pageSize:10},hometownFieldNames:{label:"name",value:"id",children:"area"},studentForm:{id:"",name:"",isOpen:0,gender:null,admissionDate:"",className:"",classesId:"",studentCode:"",studentNo:"",phone:"",icCardNo:"",accommodation:null,isChild:null,email:"",idType:null,status:null,idCard:"",nation:null,politicalStatus:null,birthday:null,birthPlace:"",nativePlaces:null,isFlow:null,isStay:null,householdType:null,address:"",bloodType:null,healthStatus:null,personalIllness:"",preparationCategory:null,country:null,avatar:"",faceImg:"",householdAddress:"",specialty:"",remarks:"",education:null,academicSystem:null,secondDegree:null,elterns:[]},formItems:["basic","expand","eltern"],basic:{title:""},expand:{title:""},eltern:{title:""}}),V=(e,t)=>{if(t){const e=/^[0]+/;t=t.replace(e,""),D.studentForm.icCardNo=u(t)}return Promise.resolve()},E=(e,t)=>e.required&&!t?Promise.reject(new Error("请输入!")):(D.studentForm[e.fullField]=u(t),Promise.resolve()),O=(e,t)=>{const{required:a}=e;return a&&""===t?Promise.reject(new Error("请输入手机号码!")):t&&!c(t)?Promise.reject(new Error("手机号码格式不正确!")):Promise.resolve()},R=e=>Y((()=>pe(i.state.base.commentJsonKeys[e]))),P=Y((()=>e=>e&&d(e).unix()>d().unix())),q=({base64:e,file:t})=>{D.studentForm.avatar=e;const a=new FormData;a.append("file",t),v(a).then((e=>{const{data:t}=e;t.forEach((e=>{D.studentForm.avatar=e.url}))}))},M=()=>{l("smitStudentForm",!0),n.value.resetFields()},z=e=>{if("depa"===D.selectMode){const{id:t,name:a,showName:l}=e[0];D.studentForm.className=l||a,D.studentForm.classesId=t}else D.studentForm.elterns=[...D.studentForm.elterns,...e]},me=(e,t)=>{const a=new RegExp("[`~!@#$^&%*()=|{}':;',\\[\\].<>/?~！@#￥%……&*（）——|{}【】‘；：”“'。，、？]");return""===t?Promise.reject(new Error("请输入姓名!")):t&&a.test(t)?Promise.reject(new Error("请勿输入特殊字符!")):Promise.resolve()},he=()=>{D.studentForm.elterns.length>I.length-1?p.warning(`家长信息不能超过${I.length}个！`):D.studentForm.elterns.push({name:"",relations:null,isEltern:null,isSingle:null,phone:"",idType:null,idCard:""})},ve=()=>{const e=JSON.parse(JSON.stringify(D.studentForm));void 0===e.gender&&(e.gender=null);let t=g;e.id&&("parentInformation"===D.activeTabs&&e.elterns.length?t=b:(delete e.elterns,t=k)),n.value.validate().then((()=>{D.loading=!0,t(e).then((t=>{p.success(t.message);const{deptId:a,type:s}=o,n={id:a,type:s,statusList:i.state.selectSource.dictionary.roll_status_yes_id,...D.pagination};D.loading=!1,e.id?"parentInformation"===D.activeTabs&&l("emitStudentDetails",""):(i.dispatch("schoolRollManagement/getStudentListInfo",n),l("smitStudentForm",!0))})).catch((()=>{D.loading=!1}))}))};return Q((()=>s.studentDetailPrarms),(e=>{D.studentForm=e})),Q((()=>o.title),(e=>{const{rollValue:t,title:a,deptId:l}=o;D.studentForm.className="","classes"===t&&(D.studentForm.classesId=l,D.studentForm.className=a,D.checkedList=[{id:l,name:a,_checked:!0}])})),J((()=>{const e=R("INIT_STUDENT_TABLE_LIST").value||[];B((()=>{null==e||e.forEach((e=>{D[e.typeKey][`${e.key}Show`]=!0,e.typeKey&&(D[e.typeKey].title=e.typeName,D[e.typeKey][`${e.key}Rqd`]=e.default)}));const{rollValue:t,title:a,deptId:l}=o;D.studentForm.className="","classes"===t&&(D.studentForm.className=a,D.studentForm.classesId=l,D.checkedList=[{id:l,name:a,_checked:!0}])})),(async()=>{const e=await f();D.threeLevelLinkageList=e.data||[]})()})),(t,l)=>{const s=H("a-tab-pane"),o=H("a-tabs"),i=H("a-layout-header"),d=H("a-col"),u=H("a-row"),c=H("a-input"),p=H("a-form-item"),v=H("a-select"),f=H("a-date-picker"),g=H("a-switch"),b=H("a-cascader"),k=H("a-textarea"),$=H("up-outlined"),K=H("down-outlined"),A=H("a-button"),Y=H("a-divider"),Q=H("plus-outlined"),J=H("a-form"),B=H("a-layout-content"),pe=H("a-layout-footer"),ye=H("a-layout"),fe=a;return G(),W(se,null,[X(ye,{class:"reset-layout layout-header-radius"},{default:Z((()=>[e.isHader?le("v-if",!0):(G(),ee(i,{key:0,class:"reset-layout-header layout-header-radius"},{default:Z((()=>[te("i",{class:"iconfont icon-xingzhuangjiehe19",onClick:M}),D.studentForm.id?(G(),ee(o,{key:0,activeKey:D.activeTabs,"onUpdate:activeKey":l[0]||(l[0]=e=>D.activeTabs=e),class:"reset-layout-header-tabs"},{default:Z((()=>[X(s,{key:"studentInformation",tab:"学生信息"}),X(s,{key:"parentInformation",tab:"家长信息","force-render":""})])),_:1},8,["activeKey"])):(G(),W("span",De,ae(e.studentTitle),1))])),_:1})),X(B,{class:"reset-layout-content"},{default:Z((()=>[X(J,{class:"ant-advanced-search-form",layout:"vertical",ref_key:"studentFormRef",ref:n,model:D.studentForm},{default:Z((()=>[(G(!0),W(se,null,ne(D.formItems,((e,t)=>(G(),W(se,{key:t},[!D.studentForm.id||"studentInformation"==D.activeTabs&&D.studentForm.id?(G(),W(se,{key:0},["basic"===e&&D[e].title?(G(),W(se,{key:0},[X(u,{gutter:D.rowCol.gutter},{default:Z((()=>[X(d,{span:D.rowCol.gutter},{default:Z((()=>[te("h3",Ve,ae(D[e].title),1)])),_:2},1032,["span"])])),_:2},1032,["gutter"]),X(u,{gutter:D.rowCol.gutter},{default:Z((()=>[D[e].nameShow?(G(),ee(d,{key:0,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"姓名：",name:"name",rules:{required:D[e].nameRqd,validator:me}},{default:Z((()=>[X(c,{value:D.studentForm.name,"onUpdate:value":l[1]||(l[1]=e=>D.studentForm.name=e),valueModifiers:{trim:!0},maxlength:20,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].genderShow?(G(),ee(d,{key:1,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"gender",label:"性别：",rules:{required:D[e].genderRqd,message:"请选择！",trigger:"change"}},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.gender,"onUpdate:value":l[2]||(l[2]=e=>D.studentForm.gender=e),options:oe(je),placeholder:"请选择"},null,8,["value","options"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].admissionDateShow?(G(),ee(d,{key:2,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"admissionDate",label:"入学日期：",rules:{required:D[e].admissionDateRqd,message:"请选择！",trigger:["blur","change"]}},{default:Z((()=>[X(f,{allowClear:"",value:D.studentForm.admissionDate,"onUpdate:value":l[3]||(l[3]=e=>D.studentForm.admissionDate=e),"value-format":"YYYY-MM-DD",style:{width:"100%"},placeholder:"请选择"},null,8,["value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].classNameShow?(G(),ee(d,{key:3,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"className",label:"班级：",rules:{required:D[e].classNameRqd,message:"请选择！",trigger:["blur","change"]}},{default:Z((()=>[X(c,{onClick:l[4]||(l[4]=e=>(e=>{const t=[];R("INIT_ROLL_LIST").value.forEach(((e,a)=>"classes"!==e.key&&t.push(e.level))),D.selectTabs=[{tab:"班级",key:2,checked:!0,disabled:t}],D.selectMode="depa",D.multipleTrue=!1,D.visibles=!0,"clazz"!==e&&(D.selectTabs=[{tab:"学生家长",key:2,checked:!0}],D.selectMode="personnel",D.multipleTrue=!0)})("clazz")),disabled:!!D.studentForm.id,value:D.studentForm.className,"onUpdate:value":l[5]||(l[5]=e=>D.studentForm.className=e),valueModifiers:{trim:!0},placeholder:"请选择","allow-clear":""},null,8,["disabled","value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].studentCodeShow?(G(),ee(d,{key:4,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"studentCode",label:"学籍号：",rules:{required:D[e].studentCodeRqd,validator:E,trigger:"blur"}},{default:Z((()=>[X(c,{value:D.studentForm.studentCode,"onUpdate:value":l[6]||(l[6]=e=>D.studentForm.studentCode=e),valueModifiers:{trim:!0},maxlength:30,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].statusShow?(G(),ee(d,{key:5,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"status",label:"学籍状态：",rules:{required:D[e].statusRqd,message:"请选择！",trigger:"blur"}},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.status,"onUpdate:value":l[7]||(l[7]=e=>D.studentForm.status=e),options:D.studentForm.id?oe(_):oe(S),placeholder:"请选择"},null,8,["value","options"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].studentNoShow?(G(),ee(d,{key:6,span:D.rowCol.span,class:"posit-reltv"},{default:Z((()=>[X(p,{name:"studentNo",label:"学号：",rules:{required:D[e].studentNoRqd,validator:E,trigger:"blur"}},{default:Z((()=>[X(c,{value:D.studentForm.studentNo,"onUpdate:value":l[8]||(l[8]=e=>D.studentForm.studentNo=e),valueModifiers:{trim:!0},placeholder:"请输入",maxlength:30,"allow-clear":""},null,8,["value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].phoneShow?(G(),ee(d,{key:7,span:D.rowCol.span,class:"posit-reltv"},{default:Z((()=>[X(p,{label:"学生手机号码：",name:"phone",rules:{required:D[e].phoneRqd,validator:O,trigger:["blur","change"]}},{default:Z((()=>[X(c,{value:D.studentForm.phone,"onUpdate:value":l[9]||(l[9]=e=>D.studentForm.phone=e),valueModifiers:{trim:!0},disabled:D[e].phoneRqd&&!!D.studentForm.id,maxlength:11,placeholder:"请输入","allow-clear":""},null,8,["value","disabled"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].icCardNoShow?(G(),ee(d,{key:8,span:D.rowCol.span,class:"posit-reltv"},{default:Z((()=>[X(p,{label:"卡号：",name:"icCardNo",rules:{required:D[e].icCardNoRqd,validator:V,trigger:"blur"}},{default:Z((()=>[X(c,{maxlength:20,value:D.studentForm.icCardNo,"onUpdate:value":l[10]||(l[10]=e=>D.studentForm.icCardNo=e),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),le(" 大学版 "),D[e].educationShow?(G(),ee(d,{key:9,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"education",label:"学历：",rules:{required:D[e].educationRqd,message:"请选择",trigger:["blur","change"]}},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.education,"onUpdate:value":l[11]||(l[11]=e=>D.studentForm.education=e),options:oe(N),placeholder:"请选择"},null,8,["value","options"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].academicSystemShow?(G(),ee(d,{key:10,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"academicSystem",label:"学制：",rules:{required:D[e].academicSystemRqd,message:"请选择",trigger:["blur","change"]}},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.academicSystem,"onUpdate:value":l[12]||(l[12]=e=>D.studentForm.academicSystem=e),options:oe(U),placeholder:"请选择"},null,8,["value","options"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].secondDegreeShow?(G(),ee(d,{key:11,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"secondDegree",label:"第二学位：",rules:{required:D[e].secondDegreeRqd,message:"请选择",trigger:["blur","change"]}},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.secondDegree,"onUpdate:value":l[13]||(l[13]=e=>D.studentForm.secondDegree=e),options:oe(j),placeholder:"请选择"},null,8,["value","options"])])),_:2},1032,["rules"])])),_:2},1032,["span"])):le("v-if",!0),X(d,{span:D.rowCol.gutter,class:"posit-reltv"},{default:Z((()=>[X(p,{label:"头像：",name:"avatar"},{default:Z((()=>[te("div",Ee,[D.studentForm.isOpen?(G(),W("div",Oe,[te("img",{class:ie(["ant-image",{active:!D.studentForm.faceImg}]),src:D.studentForm.faceImg||"/image/defal_user.png"},null,10,Re),D.studentForm.faceImg?le("v-if",!0):(G(),W("span",Pe,[X(oe(we),{style:{color:"var(\r\n                                                                --warning-color\r\n                                                            )"}}),re(" 暂无人脸 ")]))])):(G(),ee(h,{key:1,value:D.studentForm.avatar,"onUpdate:value":l[14]||(l[14]=e=>D.studentForm.avatar=e),onChange:q,minCropBoxWidth:200,minCropBoxHeight:200},null,8,["value"])),te("span",qe,[X(g,{checked:D.studentForm.isOpen,"onUpdate:checked":l[15]||(l[15]=e=>D.studentForm.isOpen=e),checkedValue:1,unCheckedValue:0,"checked-children":"开","un-checked-children":"关"},null,8,["checked"]),re(" 使用人脸库照片 ")])]),Me])),_:1})])),_:1},8,["span"])])),_:2},1032,["gutter"])],64)):le("v-if",!0),le(" 学生扩展信息 "),"expand"===e?(G(),W(se,{key:1},[X(u,{gutter:D.rowCol.gutter},{default:Z((()=>[X(d,{span:D.rowCol.gutter},{default:Z((()=>[te("h3",ze,ae(D[e].title),1)])),_:2},1032,["span"])])),_:2},1032,["gutter"]),de(X(u,{gutter:D.rowCol.gutter},{default:Z((()=>[D[e].accommodationShow?(G(),ee(d,{key:0,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"住宿方式：",name:"accommodation"},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.accommodation,"onUpdate:value":l[16]||(l[16]=e=>D.studentForm.accommodation=e),options:oe(m),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].isChildShow?(G(),ee(d,{key:1,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"isChild",label:"是否独生子女："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.isChild,"onUpdate:value":l[17]||(l[17]=e=>D.studentForm.isChild=e),options:oe(Ue),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].emailShow?(G(),ee(d,{key:2,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"email",label:"电子信箱："},{default:Z((()=>[X(c,{value:D.studentForm.email,"onUpdate:value":l[18]||(l[18]=e=>D.studentForm.email=e),valueModifiers:{trim:!0},maxlength:50,"allow-clear":"",placeholder:"请输入"},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].idTypeShow?(G(),ee(d,{key:3,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"idType",label:"证件类型："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.idType,"onUpdate:value":l[19]||(l[19]=e=>D.studentForm.idType=e),options:oe(T),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].idCardShow?(G(),ee(d,{key:4,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"idCard",label:"证件号码："},{default:Z((()=>[X(c,{maxlength:19,value:D.studentForm.idCard,"onUpdate:value":l[20]||(l[20]=e=>D.studentForm.idCard=e),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].nationShow?(G(),ee(d,{key:5,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"nation",label:"民族："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.nation,"onUpdate:value":l[21]||(l[21]=e=>D.studentForm.nation=e),options:oe(x),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].politicalStatusShow?(G(),ee(d,{key:6,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"politicalStatus",label:"政治面貌："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.politicalStatus,"onUpdate:value":l[22]||(l[22]=e=>D.studentForm.politicalStatus=e),options:oe(r),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].birthdayShow?(G(),ee(d,{key:7,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"birthday",label:"出生日期："},{default:Z((()=>[X(f,{"allow-clear":"",disabledDate:P.value,value:D.studentForm.birthday,"onUpdate:value":l[23]||(l[23]=e=>D.studentForm.birthday=e),"value-format":"YYYY-MM-DD",style:{width:"100%"},placeholder:"请选择"},null,8,["disabledDate","value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].birthPlaceShow?(G(),ee(d,{key:8,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"birthPlace",label:"出生地："},{default:Z((()=>[X(c,{value:D.studentForm.birthPlace,"onUpdate:value":l[24]||(l[24]=e=>D.studentForm.birthPlace=e),valueModifiers:{trim:!0},maxlength:50,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].countryShow?(G(),ee(d,{key:9,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"country",label:"国籍："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.country,"onUpdate:value":l[25]||(l[25]=e=>D.studentForm.country=e),options:oe(L),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].nativePlacesShow?(G(),ee(d,{key:10,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"nativePlaces",label:"籍贯："},{default:Z((()=>[X(b,{class:"form-select",fieldNames:D.hometownFieldNames,value:D.studentForm.nativePlaces,"onUpdate:value":l[26]||(l[26]=e=>D.studentForm.nativePlaces=e),options:D.threeLevelLinkageList,placeholder:"请选择"},null,8,["fieldNames","value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].isFlowShow?(G(),ee(d,{key:11,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"isFlow",label:"否流动人口："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.isFlow,"onUpdate:value":l[27]||(l[27]=e=>D.studentForm.isFlow=e),options:oe(Ue),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].householdTypeShow?(G(),ee(d,{key:12,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"householdType",label:"户口类别："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.householdType,"onUpdate:value":l[28]||(l[28]=e=>D.studentForm.householdType=e),options:oe(F),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].householdAddressShow?(G(),ee(d,{key:13,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"householdAddress",label:"户口所在地："},{default:Z((()=>[X(c,{value:D.studentForm.householdAddress,"onUpdate:value":l[29]||(l[29]=e=>D.studentForm.householdAddress=e),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].bloodTypeShow?(G(),ee(d,{key:14,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"bloodType",label:"血型："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.bloodType,"onUpdate:value":l[30]||(l[30]=e=>D.studentForm.bloodType=e),options:oe(C),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].healthStatusShow?(G(),ee(d,{key:15,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"healthStatus",label:"健康状态："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.healthStatus,"onUpdate:value":l[31]||(l[31]=e=>D.studentForm.healthStatus=e),options:oe(w),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].addressShow?(G(),ee(d,{key:16,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"address",label:"家庭住址："},{default:Z((()=>[X(c,{value:D.studentForm.address,"onUpdate:value":l[32]||(l[32]=e=>D.studentForm.address=e),valueModifiers:{trim:!0},maxlength:100,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].isStayShow?(G(),ee(d,{key:17,span:D.rowCol.span},{default:Z((()=>[X(p,{name:"isStay",label:"是否留守儿童："},{default:Z((()=>[X(v,{"allow-clear":"",value:D.studentForm.isStay,"onUpdate:value":l[33]||(l[33]=e=>D.studentForm.isStay=e),options:oe(Ue),placeholder:"请选择"},null,8,["value","options"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].personalIllnessShow?(G(),ee(d,{key:18,span:D.rowCol.gutter},{default:Z((()=>[X(p,{name:"personalIllness",label:"个人疾病情况："},{default:Z((()=>[X(c,{value:D.studentForm.personalIllness,"onUpdate:value":l[34]||(l[34]=e=>D.studentForm.personalIllness=e),valueModifiers:{trim:!0},maxlength:500,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].specialtyShow?(G(),ee(d,{key:19,span:D.rowCol.gutter},{default:Z((()=>[X(p,{name:"specialty",label:"个人特长："},{default:Z((()=>[X(c,{value:D.studentForm.specialty,"onUpdate:value":l[35]||(l[35]=e=>D.studentForm.specialty=e),valueModifiers:{trim:!0},maxlength:500,placeholder:"请输入","allow-clear":""},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0),D[e].remarksShow?(G(),ee(d,{key:20,span:D.rowCol.gutter},{default:Z((()=>[X(p,{name:"remarks",label:"备注："},{default:Z((()=>[X(k,{maxlength:500,rows:4,showCount:!0,value:D.studentForm.remarks,"onUpdate:value":l[36]||(l[36]=e=>D.studentForm.remarks=e),valueModifiers:{trim:!0},placeholder:"请输入"},null,8,["value"])])),_:1})])),_:1},8,["span"])):le("v-if",!0)])),_:2},1032,["gutter"]),[[ue,D.isExpandCollapse]]),le(" 更多 "),"expand"===e&&D[e].title?(G(),ee(u,{key:0,gutter:D.rowCol.gutter},{default:Z((()=>[X(d,{span:D.rowCol.gutter},{default:Z((()=>[X(A,{type:"link",onClick:l[37]||(l[37]=e=>D.isExpandCollapse=!D.isExpandCollapse),class:"isExpandCollapse"},{default:Z((()=>[re(ae(D.isExpandCollapse?"收起":"展开更多")+" ",1),de(X($,{class:"left-outlined"},null,512),[[ue,D.isExpandCollapse]]),de(X(K,{class:"left-outlined"},null,512),[[ue,!D.isExpandCollapse]])])),_:1})])),_:1},8,["span"])])),_:1},8,["gutter"])):le("v-if",!0)],64)):le("v-if",!0)],64)):le("v-if",!0),le(" 家长 "),!D.studentForm.id||"parentInformation"==D.activeTabs&&D.studentForm.id?(G(),W(se,{key:1},["eltern"===e&&D[e].title?(G(),W(se,{key:0},[X(u,{gutter:D.rowCol.gutter},{default:Z((()=>[X(d,{span:D.rowCol.gutter},{default:Z((()=>[te("h3",$e,ae(D[e].title),1)])),_:2},1032,["span"])])),_:2},1032,["gutter"]),D.studentForm.elterns.length?(G(),ee(u,{key:0,gutter:D.rowCol.gutter},{default:Z((()=>[(G(!0),W(se,null,ne(D.studentForm.elterns,((t,a)=>(G(),W(se,{key:a},[X(d,{span:D.rowCol.gutter},{default:Z((()=>[te("p",Ke,[X(A,{type:"link",danger:"",onClick:e=>((e,t)=>{e?y({ids:[e]}).then((e=>{D.studentForm.elterns.splice(t,1)})):D.studentForm.elterns.splice(t,1)})(t.id,a)},{default:Z((()=>[re(" 删除家长信息 ")])),_:2},1032,["onClick"])])])),_:2},1032,["span"]),D[e].elternsNameShow?(G(),ee(d,{key:0,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"家长姓名：",name:["elterns",a,"name"],rules:{required:D[e].elternsNameRqd,message:"请输入！",trigger:"change"}},{default:Z((()=>[X(c,{value:t.name,"onUpdate:value":e=>t.name=e,valueModifiers:{trim:!0},maxlength:20,placeholder:"请输入","allow-clear":""},null,8,["value","onUpdate:value"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsIsElternShow?(G(),ee(d,{key:1,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"是否监护人：",name:["elterns",a,"isEltern"],rules:{required:D[e].elternsIsElternRqd,trigger:"change",message:"请选择！"}},{default:Z((()=>[X(v,{"allow-clear":"",value:t.isEltern,"onUpdate:value":e=>t.isEltern=e,options:oe(Ue),placeholder:"请选择"},null,8,["value","onUpdate:value","options"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsIsSingleShow?(G(),ee(d,{key:2,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"是否单亲监护：",name:["elterns",a,"isSingle"],rules:{required:D[e].elternsIsSingleRqd,trigger:"change",message:"请选择！"}},{default:Z((()=>[X(v,{"allow-clear":"",value:t.isSingle,"onUpdate:value":e=>t.isSingle=e,options:oe(Ue),placeholder:"请选择"},null,8,["value","onUpdate:value","options"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsPhoneShow?(G(),ee(d,{key:3,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"手机号：",name:["elterns",a,"phone"],rules:{required:D[e].elternsPhoneRqd,trigger:"change",validator:O}},{default:Z((()=>[X(c,{disabled:t.id&&!!t.phone,value:t.phone,"onUpdate:value":e=>t.phone=e,valueModifiers:{trim:!0},maxlength:11,placeholder:"请输入","allow-clear":""},null,8,["disabled","value","onUpdate:value"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsIdTypeShow?(G(),ee(d,{key:4,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"证件类型：",name:["elterns",a,"idType"],rules:{required:D[e].elternsIdTypeRqd,message:"请选择！"}},{default:Z((()=>[X(v,{"allow-clear":"",value:t.idType,"onUpdate:value":e=>t.idType=e,options:oe(T),placeholder:"请选择"},null,8,["value","onUpdate:value","options"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsIdCardShow?(G(),ee(d,{key:5,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"证件号码：",name:["elterns",a,"idCard"],rules:{required:D[e].elternsIdCardRqd,message:"请输入！"}},{default:Z((()=>[X(c,{value:t.idCard,"onUpdate:value":e=>t.idCard=e,placeholder:"请输入","allow-clear":""},null,8,["value","onUpdate:value"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D[e].elternsRelationsShow?(G(),ee(d,{key:6,span:D.rowCol.span},{default:Z((()=>[X(p,{label:"家庭关系：",name:["elterns",a,"relations"],rules:{required:D[e].elternsRelationsRqd,message:"请选择！"}},{default:Z((()=>[X(v,{"allow-clear":"",value:t.relations,"onUpdate:value":e=>t.relations=e,options:oe(I),placeholder:"请选择"},null,8,["value","onUpdate:value","options"])])),_:2},1032,["name","rules"])])),_:2},1032,["span"])):le("v-if",!0),D.studentForm.elterns.length-1!==a?(G(),ee(Y,{key:7})):le("v-if",!0)],64)))),128))])),_:2},1032,["gutter"])):le("v-if",!0),X(d,{span:D.rowCol.gutter,style:{"text-align":"left","margin-bottom":"16px",display:"flex"}},{default:Z((()=>[X(A,{class:"btn-background-ghost",type:"primary",ghost:"",onClick:he},{icon:Z((()=>[X(Q)])),default:Z((()=>[re(" 添加家长 ")])),_:1})])),_:1},8,["span"])],64)):le("v-if",!0)],64)):le("v-if",!0)],64)))),128))])),_:1},8,["model"])])),_:1}),D.isHistory?le("v-if",!0):(G(),ee(pe,{key:1,class:"reset-layout-footer"},{default:Z((()=>[X(A,{type:"primary",loading:D.loading,onClick:ce(ve,["prevent"])},{default:Z((()=>[re("提交")])),_:1},8,["loading","onClick"])])),_:1}))])),_:1}),X(fe,{visible:D.visibles,"onUpdate:visible":l[38]||(l[38]=e=>D.visibles=e),multiple:D.multipleTrue,tabs:D.selectTabs,mode:D.selectMode,checked:D.checkedList,"onUpdate:checked":l[39]||(l[39]=e=>D.checkedList=e),onHandleOk:z},null,8,["visible","multiple","tabs","mode","checked"])],64)}}},[["__scopeId","data-v-2005cf6e"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/StudentForm.vue"]]);const Ye=e=>(me("data-v-2f12c2f1"),e=e(),he(),e),Qe=Ye((()=>te("h1",null,"一步创建班级架构",-1))),Je={class:"campus"},Be={key:1,class:"period"},He={class:"period_item_stage"},Ge={key:2,class:"period_item_grade"},We={class:"grade_item"},Xe=Ye((()=>te("span",{class:"item-txts"},"请选择年级数量：",-1))),Ze={key:0,class:"period_item_clazz"},et={style:{display:"none"}},tt={class:"item-txt"},at={class:"footer"},lt={class:"heander_content_footer"},st={class:"content_footer-time"},nt=Ye((()=>te("span",{class:"switchs"},"自动升学",-1))),ot=Ye((()=>te("p",{class:"help"}," 注：启用自动升学后，各个年级将在当天自动升班。 ",-1)));var it=e(ve({__name:"SchoolRollTemplate",emits:["emitRefresh"],setup(e,{emit:a}){const l=$(),s=$(!1),n=t(),o=A({loading:!1,initialTemplate:{schoolName:"",gradeNum:0},periodList:[],time:d().format("MM-DD"),entranceData:"",multiCampus:!1,rollList:[{periodList:[],campusName:"",gradeNum:0,list:[{gradeOption:[],clazzOption:{},gradeList:[{name:"",num:5}],name:"学段",periodValue:null,gradeValue:0,gradeSwitchList:null,numList:[]}]}],campusValue:""}),i=(e,t)=>e.required&&!t?Promise.reject("校区不能为空"):Promise.resolve(),r=(e,t)=>t?Promise.resolve():Promise.reject("学段不能为空"),u=()=>{const e=o.periodList.map((e=>({...e,disabled:!1})));o.rollList.push({periodList:e,campusName:"",gradeNum:0,list:[{gradeOption:[],clazzOption:{},gradeList:[{name:"",num:5}],name:"学段",periodValue:null,gradeValue:0,gradeSwitchList:null,numList:[]}]})},c=()=>{const e=document.getElementsByClassName("ant-picker-header-super-prev-btn"),t=document.getElementsByClassName("ant-picker-header-super-next-btn");document.getElementsByClassName("ant-picker-year-btn")[0].style.display="none",e[0].style.display="none",t[0].style.display="none"},h=Y((()=>(e,t,a)=>e.gradeList[a].name=t)),v=Y((()=>n.state.user.currentSchool)),y=Y((()=>e=>{const{list:t}=e;return!t[t.length-1].periodValue})),f=()=>{const{rollList:e,entranceData:t}=o;l.value.validate().then((()=>{const l=pe(v.value),s={rollList:e,entranceData:t};o.loading=!0,_(s).then((e=>{n.commit("user/setCurrentSchool",{...l,isInit:!0}),a("emitRefresh"),p.success(e.message)})).finally((()=>o.loading=!1))}))};Q((()=>s.value),(e=>{o.entranceData=e?o.time:""}));const g=e=>{const{gradeValue:t}=e,a=[];for(let l=0;l<t;l++)a.push(Object.assign({},{name:e.clazzOption[t][l],num:5}));e.gradeList=a};return J((()=>{S().then((({data:e})=>{o.initialTemplate=e,o.periodList=e.list,o.multiCampus=e.isShowCampus,o.rollList[0].periodList=o.periodList}))})),(e,t)=>{const a=H("delete-filled"),n=H("a-input"),d=H("a-form-item"),p=H("a-select"),v=H("a-checkbox"),b=H("a-select-option"),k=H("labe"),_=H("plus-outlined"),S=H("a-button"),w=H("a-form"),C=H("a-switch"),F=H("a-date-picker"),x=H("a-layout-content"),T=H("a-layout"),I=H("a-layout-footer");return G(),ee(T,{class:"demp_tree_initial"},{default:Z((()=>[X(T,{class:"demp_tree_initial_heander layout-header-radius"},{default:Z((()=>[X(x,{class:"initial_heander_content"},{default:Z((()=>[Qe,le(" new "),X(w,{ref_key:"rollRef",ref:l,model:o},{default:Z((()=>[(G(!0),W(se,null,ne(o.rollList,((e,t)=>{var l;return G(),W("div",{class:"heander_contents",key:t},[o.rollList.length>1?(G(),ee(a,{key:0,class:"delet_campus",onClick:e=>{return a=t,void m.confirm({title:"提示",icon:X(Ce),content:"请确认删除该校区吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk(){o.rollList.splice(a,1)}});var a}},null,8,["onClick"])):le("v-if",!0),te("div",Je,[(G(),ee(d,{colon:o.multiCampus,label:o.multiCampus?"校区名称：":o.initialTemplate.schoolName,key:t,name:["rollList",t,"campusName"],rules:[{required:o.multiCampus,validator:i}]},{default:Z((()=>[o.multiCampus?(G(),ee(n,{key:0,style:{width:"100%"},placeholder:"请输入",showCount:"",maxlength:20,value:e.campusName,"onUpdate:value":t=>e.campusName=t},null,8,["value","onUpdate:value"])):le("v-if",!0)])),_:2},1032,["colon","label","name","rules"]))]),(null==(l=e.list)?void 0:l.length)?(G(),W("div",Be,[(G(!0),W(se,null,ne(e.list,((l,s)=>{var n;return G(),W("div",{class:"period_item",key:s},[(null==(n=e.list)?void 0:n.length)>1?(G(),ee(a,{key:0,class:"delet_campus period_delet",onClick:e=>((e,t)=>{m.confirm({title:"提示",icon:X(Ce),content:"请确认删除该学段吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk(){const{list:a,periodList:l}=o.rollList[e];l.forEach((e=>{e.id==a[t].periodValue&&(e.disabled=!1)})),o.rollList[e].list.splice(t,1)}})})(t,s)},null,8,["onClick"])):le("v-if",!0),te("div",He,[(G(),ee(d,{label:"学段：",key:t,name:["rollList",t,"list",s,"periodValue"],rules:[{required:!0,validator:r}]},{default:Z((()=>[X(p,{value:l.periodValue,"onUpdate:value":e=>l.periodValue=e,style:{width:"100%"},placeholder:"请选择",disabled:e.list.length-1!==s,fieldNames:{label:"name",value:"id"},options:e.periodList,onChange:t=>((e,t,a)=>{let l={numList:[],gradeList:{},gradeSwitchList:{},defaultNum:0,id:"",name:""};a.periodList.forEach((t=>{t.id===e&&(l=t)})),t.rollId=l.id,t.checked=!1,t.academicsName=l.name,t.gradeOption=l.numList,t.gradeSwitchList=l.gradeSwitchList,t.clazzOption=l.gradeList,t.gradeValue=l.defaultNum,g(t)})(t,l,e)},null,8,["value","onUpdate:value","disabled","options","onChange"])])),_:2},1032,["name","rules"]))]),l.gradeSwitchList&&l.gradeValue?(G(),ee(v,{key:1,class:"grade-alias",checked:l.checked,"onUpdate:checked":e=>l.checked=e},{default:Z((()=>[re("按七、八、九年级命名")])),_:2},1032,["checked","onUpdate:checked"])):le("v-if",!0),l.periodValue?(G(),W("div",Ge,[te("div",We,[X(k,null,{default:Z((()=>[Xe,X(p,{size:"default",value:l.gradeValue,"onUpdate:value":e=>l.gradeValue=e,onChange:e=>g(l)},{default:Z((()=>[(G(!0),W(se,null,ne(l.gradeOption,((e,t)=>(G(),ee(b,{key:t,value:e},{default:Z((()=>[re(ae(e),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value","onChange"]),re(" 个年级 ")])),_:2},1024)]),l.gradeValue?(G(),W("div",Ze,[(G(!0),W(se,null,ne(l[l.checked?"gradeSwitchList":"clazzOption"][l.gradeValue],((e,t)=>(G(),W("div",{class:"clazz_item",key:t},[X(k,null,{default:Z((()=>[te("span",et,ae(h.value(l,e,t)),1),te("span",tt,ae(e)+"：",1),X(p,{size:"default",value:l.gradeList[t].num,"onUpdate:value":e=>l.gradeList[t].num=e},{default:Z((()=>[(G(!0),W(se,null,ne(o.initialTemplate.gradeNum,(e=>(G(),ee(b,{key:e,value:e},{default:Z((()=>[re(ae(e),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value"]),re(" 个班级 ")])),_:2},1024)])))),128))])):le("v-if",!0)])):le("v-if",!0)])})),128)),te("div",at,[X(S,{class:"period_addcampus",type:"text",ghost:"",disabled:y.value(e),onClick:e=>(e=>{const{list:t,periodList:a}=o.rollList[e];t.forEach((e=>{e.periodValue&&a.forEach((t=>{t.id==e.periodValue&&(t.disabled=!0)}))})),o.rollList[e].list.push({gradeOption:[],clazzOption:{},gradeList:[{name:"",num:5}],name:"学段",periodValue:null,gradeValue:0,gradeSwitchList:null,numList:[]})})(t)},{icon:Z((()=>[X(_)])),default:Z((()=>[re(" 添加学段 ")])),_:2},1032,["disabled","onClick"])])])):le("v-if",!0)])})),128))])),_:1},8,["model"]),o.multiCampus?(G(),ee(S,{key:0,class:"addcampus",type:"primary",ghost:"",onClick:u},{icon:Z((()=>[X(_)])),default:Z((()=>[re(" 添加校区 ")])),_:1})):le("v-if",!0),te("div",lt,[te("div",st,[X(C,{checked:s.value,"onUpdate:checked":t[0]||(t[0]=e=>s.value=e),"checked-children":"开","un-checked-children":"关"},null,8,["checked"]),nt,le(' v-model:value="initialFormState.entranceData" '),s.value?(G(),ee(F,{key:0,class:"entrance-data",value:o.entranceData,"onUpdate:value":t[1]||(t[1]=e=>o.entranceData=e),"value-format":"MM-DD",format:"MM-DD",placeholder:"请选择自动升学日期",style:{width:"300px"},onClick:c},null,8,["value"])):le("v-if",!0)]),ot])])),_:1})])),_:1}),X(I,{class:"demp_tree_initial_footer"},{default:Z((()=>[X(S,{loading:o.loading,type:"primary",onClick:f},{default:Z((()=>[re("完成 ")])),_:1},8,["loading"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-2f12c2f1"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/SchoolRollTemplate.vue"]]);const rt=e=>(me("data-v-6695ae1a"),e=e(),he(),e),dt={class:"help"},ut={class:"example"},ct={class:"example-item"},pt=rt((()=>te("p",null,"升学前",-1))),mt={class:"clazz"},ht={style:{"padding-top":"46px"}},vt={class:"example-item"},yt=rt((()=>te("p",null,"升学后",-1))),ft={class:"clazz"},gt={class:"help"};var bt=e(ve({__name:"Study",setup(e,{expose:a}){const l=K("routeQuerys")(),s=t(),n=$(!1),o=$(),i=A({studyForm:{open:1,date:"2022-01-15",id:"",status:0,successDate:""},pagination:{pageNo:1,pageSize:10},examplesFurtherStudies:[{name:"高一2021级",children:[{name:"高一1班"},{name:"高一2班"}]},{name:"高二2020级",children:[{name:"高二1班"},{name:"高二2班"}]},{name:"高三2019级",children:[{name:"高三1班"},{name:"高三2班"}]}],examplesFurtherStudiess:[{name:"高二2021级",children:[{name:"高二1班"},{name:"高二2班"}]},{name:"高三2020级",children:[{name:"高三1班"},{name:"高三2班"}]},{state:!0,name:"高三2019级（已毕业）",children:[{name:""},{name:""}]}]}),r=()=>{o.value.validateFields().then((()=>{m.confirm({title:"升学提示",content:"升学后数据无法回退，请谨慎操作！",okType:"danger",okText:"确定",cancelText:"取消",onOk(){i.studyForm.open||(i.studyForm.date="",i.studyForm.open=0),i.studyForm.open&&!i.studyForm.date||w(i.studyForm).then((e=>{if(p[e.code?"error":"success"](e.message),!e.code){n.value=!1;const{deptId:e,type:t}=l,a={...i.pagination,id:e,type:t,statusList:s.state.selectSource.dictionary.roll_status_yes_id};s.dispatch("schoolRollManagement/getStudentListInfo",a)}}))}})}))},d=(e,t)=>i.studyForm.open&&!t?Promise.reject("请选择设置自动升学日期！"):Promise.resolve(),u=()=>{const e=document.getElementsByClassName("ant-picker-header-super-prev-btn"),t=document.getElementsByClassName("ant-picker-header-super-next-btn");document.getElementsByClassName("ant-picker-year-btn")[0].style.display="none",e[0].style.display="none",t[0].style.display="none"};return a({studyVisible:n,getStudentStudyCheck:()=>{C().then((e=>{const{data:t}=e;i.studyForm=t}))}}),(e,t)=>{const a=H("a-switch"),l=H("a-date-picker"),s=H("exclamation-circle-filled"),c=H("a-form-item"),p=H("double-right-outlined"),m=H("a-form"),h=H("a-modal");return G(),ee(h,{visible:n.value,"onUpdate:visible":t[2]||(t[2]=e=>n.value=e),title:"升学",onOk:r},{default:Z((()=>[X(m,{class:"study-form",ref_key:"studyRef",ref:o,model:i.studyForm,layout:"vertical"},{default:Z((()=>[X(c,{label:"设置自动升学日期",name:"date",rules:{required:!0,validator:d,trigger:["change","blur"]}},{default:Z((()=>[X(a,{class:"study-switch","checked-children":"开","un-checked-children":"关",checkedValue:1,unCheckedValue:0,checked:i.studyForm.open,"onUpdate:checked":t[0]||(t[0]=e=>i.studyForm.open=e)},null,8,["checked"]),i.studyForm.open?(G(),ee(l,{key:0,style:{width:"100%","margin-bottom":"12px"},"value-format":"MM-DD",format:"MM-DD",value:i.studyForm.date,"onUpdate:value":t[1]||(t[1]=e=>i.studyForm.date=e),onClick:u},null,8,["value"])):le("v-if",!0),le(' :disabled-date="disabledDate"\r\n                        :disabled-time="disabledRangeTime" '),te("p",dt,[X(s),re(" 今年"+ae(i.studyForm.successDate?i.studyForm.successDate:"尚未")+"完成升班 ",1)])])),_:1},8,["rules"]),X(c,{label:"升学示例",name:"name"},{default:Z((()=>[te("div",ut,[te("div",ct,[pt,te("ul",null,[(G(!0),W(se,null,ne(i.examplesFurtherStudies,((e,t)=>(G(),W("li",{key:t},[te("span",null,ae(e.name),1),te("span",mt,[(G(!0),W(se,null,ne(e.children,((e,t)=>(G(),W("div",{key:t},ae(e.name),1)))),128))])])))),128))])]),te("div",ht,[(G(!0),W(se,null,ne(i.examplesFurtherStudies,((e,t)=>(G(),ee(p,{class:"double-icon",style:{width:"100px"},key:t})))),128))]),te("div",vt,[yt,te("ul",null,[(G(!0),W(se,null,ne(i.examplesFurtherStudiess,((e,t)=>(G(),W("li",{key:t,style:ye({height:e.state?"81px":""})},[te("span",null,ae(e.name),1),te("span",ft,[(G(!0),W(se,null,ne(e.children,((e,t)=>(G(),W("div",{key:t},ae(e.name),1)))),128))])],4)))),128))])])]),te("p",gt,[X(s,{style:{color:"#faad14"}}),re("每年仅支持1次升学，若成功升学后再修改日期，当年不再生效 ")])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])}}}),[["__scopeId","data-v-6695ae1a"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/Study.vue"]]);const kt={class:"help",style:{"white-space":"initial","margin-top":"10px"}};var _t=e(ve({__name:"Retirement",props:{selectedrowkeys:Array},setup(e,{expose:a}){const l=e,s=K("routeQuerys")(),{proxy:n}=fe(),o=$(),i=t(),r=$({pageNo:1,pageSize:10}),d=$(!1),u=A({status:2,extend:{leaveSchoolDate:"",cause:""},studentIds:[]}),c=()=>{o.value.validate().then((()=>{n.$confirm({title:"提示",icon:X(we),content:"确定要变更学籍状态？",okType:"danger",okText:"确定",cancelText:"取消",onOk(){l.selectedrowkeys.length&&(u.studentIds=l.selectedrowkeys),F(u).then((e=>{const{code:t,message:a}=e;n.$message[t?"error":"success"](a),d.value=!1;const{deptId:l,type:o}=s,u={...r.value,id:l,type:o,statusList:i.state.selectSource.dictionary.roll_status_yes_id};i.dispatch("schoolRollManagement/getStudentListInfo",u)}))}})}))};return a({retirementVisible:d}),Q((()=>d.value),(e=>{e&&(u.extend.leaveSchoolDate="",u.extend.cause="")})),(e,t)=>{const a=H("a-radio"),l=H("a-radio-group"),s=H("a-form-item"),n=H("a-date-picker"),i=H("a-textarea"),r=H("a-form"),p=H("a-modal");return G(),ee(p,{visible:d.value,"onUpdate:visible":t[3]||(t[3]=e=>d.value=e),title:"退休学",onOk:c,maskClosable:!1},{default:Z((()=>[X(r,{class:"study-form",layout:"vertical",ref_key:"studentFormRef",ref:o,model:u},{default:Z((()=>[X(s,{label:"类型：",name:"status",rules:{required:!0,message:"请选择类型！"}},{default:Z((()=>[X(l,{value:u.status,"onUpdate:value":t[0]||(t[0]=e=>u.status=e),name:"radioGroup"},{default:Z((()=>[X(a,{value:2},{default:Z((()=>[re("休学")])),_:1}),X(a,{value:3},{default:Z((()=>[re("退学")])),_:1}),X(a,{value:14},{default:Z((()=>[re("开除")])),_:1})])),_:1},8,["value"])])),_:1}),X(s,{label:"设置离校日期：",name:["extend","leaveSchoolDate"],rules:{required:!0,message:"请选择离校日期！"}},{default:Z((()=>[X(n,{style:{width:"100%"},"value-format":"YYYY-MM-DD",placeholder:"请输入离校日期",value:u.extend.leaveSchoolDate,"onUpdate:value":t[1]||(t[1]=e=>u.extend.leaveSchoolDate=e)},null,8,["value"])])),_:1}),X(s,{label:"退休学原因：",name:"cause"},{default:Z((()=>[X(i,{maxlength:200,showCount:!0,rows:3,value:u.extend.cause,"onUpdate:value":t[2]||(t[2]=e=>u.extend.cause=e),placeholder:"请输入退休学原因!"},null,8,["value"]),te("p",kt,[X(oe(we)),re("设置退学和开除的学生和家长状态将被锁定，无法继续使用智慧校园，所有信息和数据都会留存，请在【历史成员】管理中查看处理。休学的学生和家长仍可继续使用。 ")])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])}}}),[["__scopeId","data-v-0f60943f"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/Retirement.vue"]]);const St={class:"help",style:{"white-space":"initial","margin-top":"10px"}};var wt=e(ve({__name:"Transfer",props:{selectedrowkeys:Array},setup(e,{expose:a}){const l=e,s=K("routeQuerys")(),n=$(),{proxy:o}=fe(),i=t(),r=$(!1),d=$({pageNo:1,pageSize:10}),u=A({status:"10",extend:{leaveSchoolDate:"",cause:"",name:""},studentIds:[]}),c=()=>{n.value.resetFields()},p=()=>{var e;(null==(e=l.selectedrowkeys)?void 0:e.length)&&(u.studentIds=l.selectedrowkeys),n.value.validate().then((()=>{x(u).then((e=>{const{code:t,message:a}=e;if(o.$message[t?"error":"success"](a),!t){n.value.resetFields(),r.value=!1;const{deptId:e,type:t}=s,a={...d.value,id:e,type:t,statusList:i.state.selectSource.dictionary.roll_status_yes_id};i.dispatch("schoolRollManagement/getStudentListInfo",a)}}))}))};return a({transferVisible:r}),(e,t)=>{const a=H("a-textarea"),l=H("a-form-item"),s=H("a-date-picker"),o=H("exclamation-circle-filled"),i=H("a-form"),d=H("a-modal");return G(),ee(d,{visible:r.value,"onUpdate:visible":t[3]||(t[3]=e=>r.value=e),title:"转学",onOk:p,onCancel:c},{default:Z((()=>[X(i,{class:"study-form",model:u,ref_key:"transferFormRef",ref:n,layout:"vertical"},{default:Z((()=>[X(l,{label:"转学原因：",name:["extend","cause"],rules:[{required:!0,message:"请填写转学原因!"}]},{default:Z((()=>[X(a,{maxlength:200,showCount:!0,rows:3,value:u.extend.cause,"onUpdate:value":t[0]||(t[0]=e=>u.extend.cause=e),placeholder:"请填写转学原因!"},null,8,["value"])])),_:1}),X(l,{label:"设置离校日期：",name:["extend","leaveSchoolDate"],rules:[{required:!0,message:"请选择离校日期！!"}]},{default:Z((()=>[X(s,{style:{width:"100%"},"value-format":"YYYY-MM-DD",value:u.extend.leaveSchoolDate,"onUpdate:value":t[1]||(t[1]=e=>u.extend.leaveSchoolDate=e)},null,8,["value"])])),_:1}),X(l,{label:"接受学校：",name:["extend","name"]},{default:Z((()=>[X(a,{maxlength:50,showCount:!0,rows:2,value:u.extend.name,"onUpdate:value":t[2]||(t[2]=e=>u.extend.name=e),placeholder:"请填写转接受学校!"},null,8,["value"]),te("p",St,[X(o),re("转学后学生和家长状态将被锁定，无法继续使用智慧校园，所有信息和数据都会留存，请在【历史成员】管理中查看处理。 ")])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])}}}),[["__scopeId","data-v-b31bd29e"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/Transfer.vue"]]);const Ct={class:"teach-item"};var Ft=e({__name:"SetupPersonCharge",props:{studentParams:{default:()=>{}},setupVisible:{type:Boolean,default:!1}},emits:["update:setupVisible"],setup(e,{emit:l}){const s=e,n=K("routeQuerys")(),o=t(),i=$(),r=$(),d=A({times:null,visible:!1,loading:!1,selectVisible:!1,multiple:!1,tabs:[{tab:"教职工",key:1,checked:!0}],checkedList:[],teachListId:0,studentForm:{leaderName:"",leader:"",id:"",userIds:[],type:"",teachList:[]},sujectOptions:[],pagination:{pageNo:1,pageSize:10}}),u=e=>{const{deptId:t}=n;d.studentForm.leader="",d.studentForm.leaderName="",d.studentForm.id=t;let a=[],l=[];d.studentForm.userIds=[],null==e||e.forEach((e=>{d.studentForm.userIds.push(e.userId||e.id),a.push(e.id),l.push(e.name)})),a.length&&(a=a.toString(),l=l.toString(),"teacher"===s.studentParams.roleKey?(d.studentForm.teachList[d.teachListId].leader=a,d.studentForm.teachList[d.teachListId].leaderName=l,i.value.validateFields()):(d.studentForm.leader=a,d.studentForm.leaderName=l),i.value.validateFields()),d.selectVisible=!1},c=()=>{const e=JSON.parse(JSON.stringify(d.studentForm));e.type=s.studentParams.roleKey;const{deptId:t,type:a}=n;e.id=t,e.rollType=a,i.value.validate().then((()=>{T(e).then((e=>{i.value.resetFields(),p.success(e.message),d.visible=!1;const l={...d.pagination,id:t,type:a,statusList:o.state.selectSource.dictionary.roll_status_yes_id};d.studentForm.teachList=[],o.dispatch("schoolRollManagement/getStudentListInfo",l),d.selectVisible=!1,m()}))}))},m=()=>{l("update:setupVisible",!1)},h=(e,t,a)=>{a||(d.studentForm.teachList[t].leaderIds=[]),Te({subjectId:e.subjectId}).then((e=>{d.studentForm.teachList[t].leaderList=e.data}))},v=()=>{d.studentForm.teachList.length>50||(d.studentForm.teachList.push({leader:"",subjectId:void 0}),r.value.scrollTop=r.value.offsetHeight+54*d.studentForm.teachList.length)},y=(e,t)=>t.label.indexOf(e)>=0,f=(e,t)=>t.name.indexOf(e)>=0;return Q((()=>s.setupVisible),(e=>{if(d.visible=e,e){const{leaders:e,teachers:t}=s.studentParams;if(d.checkedList=[],d.studentForm.userIds=[],d.studentForm.leader="",d.studentForm.leaderName="",e.length){const t=[],a=[],l=[];e.forEach((e=>{l.push(e.id),t.push(e.id),a.push(e.name)})),d.studentForm.userIds=l,d.studentForm.leader=t.toString(),d.studentForm.leaderName=a.toString(),d.checkedList=e}t.length?t.forEach(((e,t)=>{d.studentForm.teachList[t]={...e}})):d.studentForm.teachList=[{subjectId:null,leader:"",leaderName:""}]}})),J((()=>{I({pageNo:1,pageSize:999}).then((e=>{const{list:t}=e.data;d.sujectOptions=t}))})),(t,l)=>{const n=H("a-select"),o=H("a-form-item"),p=H("close-outlined"),g=H("a-button"),b=H("a-input"),k=H("a-form"),_=H("a-modal"),S=a;return G(),W(se,null,[X(_,{visible:d.visible,"onUpdate:visible":l[2]||(l[2]=e=>d.visible=e),title:"设置",maskClosable:!1,"confirm-loading":d.loading,onOk:c,onCancel:m},{default:Z((()=>[le(" roleKey "),X(k,{class:"study-form",model:d.studentForm,ref_key:"studentFormRef",ref:i,layout:"vertical"},{default:Z((()=>[le(' 任课老师   v-if="studentParams.roleKey"'),"teacher"===e.studentParams.roleKey?(G(),W("div",{key:0,class:"yd-modal",ref_key:"teachItemScrollTop",ref:r},[(G(!0),W(se,null,ne(d.studentForm.teachList,((e,t)=>(G(),W("div",{key:t},[te("div",Ct,[X(o,{label:t?"":"任课科目",name:["teachList",t,"subjectId"],rules:{required:!0,message:"请选择任课科目!"}},{default:Z((()=>[X(n,{value:e.subjectId,"onUpdate:value":t=>e.subjectId=t,style:{margin:"0 10px",width:"200px"},placeholder:"请选择任课科目","show-search":"",maxTagCount:2,options:d.sujectOptions,"filter-option":y,fieldNames:{label:"name",value:"id"},onChange:a=>h(e,t)},null,8,["value","onUpdate:value","options","onChange"])])),_:2},1032,["label","name"]),X(o,{label:t?"":"任课教师：",name:["teachList",t,"leaderIds"],rules:{required:!0,message:"请选择任课教师!"}},{default:Z((()=>[X(n,{mode:"multiple",value:e.leaderIds,"onUpdate:value":t=>e.leaderIds=t,style:{margin:"0 10px",width:"200px"},placeholder:"请选择任课教师","show-search":"",maxTagCount:2,"field-names":{label:"name",value:"id",options:"children"},"filter-option":f,options:e.leaderList,onClick:a=>((e,t)=>{const{subjectId:a}=e;a&&(clearTimeout(d.times),d.times=setTimeout((()=>{h(e,t,!0)}),1e3))})(e,t)},null,8,["value","onUpdate:value","options","onClick"])])),_:2},1032,["label","name"]),X(o,{class:ie(["form-close",{"form-item-control":!t}])},{default:Z((()=>[de(X(p,{class:"teacher-close",onClick:e=>(e=>{d.studentForm.teachList.length<2||d.studentForm.teachList.splice(e,1)})(t)},null,8,["onClick"]),[[ue,d.studentForm.teachList.length>1]])])),_:2},1032,["class"])])])))),128)),X(g,{class:"teacher-close button-link",type:"link",onClick:v},{default:Z((()=>[re("添加任课教师")])),_:1})],512)):(G(),W(se,{key:1},[le(" v-else "),X(o,{label:e.studentParams.label,name:"leaderName",rules:{required:!0,message:"请选择负责人!",trigger:"change"}},{default:Z((()=>[X(b,{readonly:"",onClick:l[0]||(l[0]=e=>(e=>{d.selectVisible=!0;const{roleKey:t}=s.studentParams;d.multiple="principal"!==t})()),value:d.studentForm.leaderName,"onUpdate:value":l[1]||(l[1]=e=>d.studentForm.leaderName=e),placeholder:"请选择!"},null,8,["value"])])),_:1},8,["label"])],2112))])),_:1},8,["model"])])),_:1},8,["visible","confirm-loading"]),X(S,{visible:d.selectVisible,"onUpdate:visible":l[3]||(l[3]=e=>d.selectVisible=e),tabs:d.tabs,multiple:d.multiple,mode:"personnel",checked:d.checkedList,"onUpdate:checked":l[4]||(l[4]=e=>d.checkedList=e),onHandleOk:u},null,8,["visible","tabs","multiple","checked"])],64)}}},[["__scopeId","data-v-c9ca89a0"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/SetupPersonCharge.vue"]]);var xt=e(ve({__name:"StudentStatusForm",props:{statusForm:{type:Object,default:()=>{}},Visible:{type:Boolean,default:!1},rolllists:{type:Object,default:()=>{}},initRollKey:{type:Object,default:()=>{}}},emits:["update:Visible"],setup(e,{emit:a}){const l=e,s=n(),i=o(),r=$(),u=t(),c=$(!1),m=$(!1),h=$([]),v=$([]),y=A({studentStatus:{children:[],title:"",name:"",key:"",isEdit:!1,isAdd:!1,isJunior:!1,ttype:0,id:"",pid:"",type:"",isShowYear:!1}}),f=A({year:null,name:null,alias:"",level:0,leader:"",num:null,style:0,show:0,type:0,id:"",pid:""});for(let t=1;t<=50;t++)v.value.push({label:t,value:t});const g=e=>{const t=d().add(5,"year"),a=d().subtract(15,"year");return e>t||e<a},b=e=>{if(["campus","school"].includes(y.studentStatus.key))h.value.forEach((t=>{t.value==e&&(f.name=t.label,f.level=t.value)}));else{const{label:t,year:a}=h.value[e];f.level=parseInt(e)+1,f.name=t,f.year=a}},k=()=>{a("update:Visible",!1)},_=K("routeQuerys")(),S=()=>{r.value.validate().then((()=>{const e=JSON.parse(JSON.stringify(f));let t=j;y.studentStatus.isEdit||(e.id="",t=D),m.value=!0,t(e).then((e=>{m.value=!1,p.success(e.message),c.value=!1,u.dispatch("base/getSchoolRollTree"),y.studentStatus.isEdit&&i.push({query:{...s.query,..._,title:y.studentStatus.name}})})).catch((()=>{m.value=!1})).finally((()=>{k()}))})).catch((()=>{m.value=!1}))},w=()=>{const{type:e,id:t}=l.statusForm;L({id:t,type:e}).then((({data:e})=>{const{name:t,yearName:a,id:l}=e;y.studentStatus.isEdit?(f.name=t,f.year=a):(f.pid=l,f.name=null)}))},C=e=>{U(e).then((t=>{const{data:a}=t;let l=a.gradeList;e.type&&(l=a.gradeDates),h.value=l.map(((t,a)=>({label:e.type?t.gradeName:t,year:t.year||"",value:`${a}`})))}))};return Q((()=>l.Visible),(e=>{c.value=e;const{statusForm:t,rolllists:a,initRollKey:s}=l;if(e){y.studentStatus.key="";const{id:e,pid:l,name:n,type:o,rollValue:i}=t;y.studentStatus.isShowYear=!1,f.type=o,y.studentStatus.isEdit=!1;const r=s[i].label;if("isAdd"===t.activationType){let t=o;f.pid=e,o+1&&(t=o+1),"school"===i&&a[o].menuPath.includes("addSection")&&(t=o+2),y.studentStatus.isShowYear="grade"===a[t].key;const{label:l,key:n}=a[t];if(y.studentStatus.title=`添加${l||""}`,y.studentStatus.name=l,f.id="",f.year=null,"academics"===n||"school"===n){y.studentStatus.key=i,f.num=null;(e=>{N(e).then((({data:e})=>{h.value=e}))})({rollId:e})}if("grade"===n){y.studentStatus.key=i,f.num=null;const t={pid:e,type:s[n].level};C(t)}if("classes"===n){C({pid:e}),w()}f.name=null,f.type=s[n].level}else y.studentStatus.isEdit=!0,y.studentStatus.title=`编辑${r||""}`,y.studentStatus.name=r,f.name=n,f.id=e,f.pid=l,"grade"===i&&(w(),y.studentStatus.isShowYear=!0)}})),(e,t)=>{const a=H("a-input"),l=H("a-form-item"),s=H("a-checkbox"),n=H("a-select"),o=H("a-date-picker"),i=H("a-form"),d=H("a-modal");return G(),ee(d,{visible:c.value,"onUpdate:visible":t[6]||(t[6]=e=>c.value=e),title:y.studentStatus.title,maskClosable:!1,"confirm-loading":m.value,onCancel:k,onOk:S},{default:Z((()=>[X(i,{class:"study-form",model:f,ref_key:"studentStatusFormRef",ref:r,layout:"vertical"},{default:Z((()=>[y.studentStatus.isEdit?(G(),W(se,{key:0},[le(" 编辑 "),X(l,{label:`${y.studentStatus.name}名称：`,name:"name",rules:{required:!0,message:"请选择!",trigger:"change"}},{default:Z((()=>[X(a,{"show-count":"",maxlength:20,value:f.name,"onUpdate:value":t[0]||(t[0]=e=>f.name=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["label"]),3==f.type&&y.studentStatus.isJunior?(G(),ee(l,{key:0,name:"style"},{default:Z((()=>[X(s,{checked:f.style,"onUpdate:checked":t[1]||(t[1]=e=>f.style=e)},{default:Z((()=>[re("按七、八、九年级命名")])),_:1},8,["checked"])])),_:1})):le("v-if",!0)],64)):(G(),W(se,{key:1},[le(" 添加 "),X(l,{label:`${y.studentStatus.name}名称：`,name:"name",rules:{required:!0,message:`请选择${y.studentStatus.name}`,trigger:"change"}},{default:Z((()=>{var e;return[(null==(e=y.studentStatus)?void 0:e.key)?(G(),ee(n,{key:0,value:f.name,"onUpdate:value":t[2]||(t[2]=e=>f.name=e),style:{width:"100%"},placeholder:"请选择",options:h.value,onChange:b},null,8,["value","options"])):(G(),ee(a,{key:1,"show-count":"",maxlength:20,value:f.name,"onUpdate:value":t[3]||(t[3]=e=>f.name=e),placeholder:"请输入"},null,8,["value"]))]})),_:1},8,["label","rules"]),"academics"===y.studentStatus.key?(G(),ee(l,{key:0,label:"班级数量：",name:"num"},{default:Z((()=>[X(n,{value:f.num,"onUpdate:value":t[4]||(t[4]=e=>f.num=e),style:{width:"100%"},placeholder:"请选择",options:v.value},null,8,["value","options"])])),_:1})):le("v-if",!0)],64)),y.studentStatus.isShowYear?(G(),ee(l,{key:2,label:"入学年份：",name:"year"},{default:Z((()=>[X(o,{style:{width:"100%"},value:f.year,"onUpdate:value":t[5]||(t[5]=e=>f.year=e),"value-format":"YYYY",picker:"year",placeholder:"请选择",disabled:!0,"disabled-date":g},null,8,["value"])])),_:1})):le("v-if",!0)])),_:1},8,["model"])])),_:1},8,["visible","title","confirm-loading"])}}}),[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/StudentStatusForm.vue"]]);var Tt=e(ve({__name:"uniStudentStatusForm",props:{statusForm:{type:Object,default:()=>{}},Visible:{type:Boolean,default:!1},rolllists:{type:Object,default:()=>{}},initRollKey:{type:Object,default:()=>{}}},emits:["update:Visible"],setup(e,{emit:a}){const l=e,s=K("routeQuerys")(),i=Y((()=>{const e=c.studentStatus.type,t=l.rolllists[e].levels;return t?"grade"===l.rolllists[t+1].key:"grade"===l.rolllists[e+1].key})),r=$(),u=t(),c=A({isShowYear:!1,total:[],studentStatusName:[],modalConfirmLoading:!1,studentStatusVisible:!1,studentStatus:{year:"",key:"",label:"",children:[],title:"",name:"",isEdit:!1,isAdd:!1,isJunior:!1,ttype:0,id:"",pid:"",type:0},form:{year:null,yearName:"",name:"",alias:"",level:0,leader:"",num:null,style:0,show:0,type:0,id:"",pid:""}});for(let t=1;t<=50;t++)c.total.push({label:t,value:t});const m=e=>{var t;c.form.level=parseInt(e)+1,c.form.name=(null==(t=c.studentStatusName[e])?void 0:t.label)||""},h=()=>{c.form.year=null,a("update:Visible",!1)},v=n(),y=o(),f=()=>{r.value.validate().then((()=>{const e=JSON.parse(JSON.stringify(c.form));let t=j;e.id||(e.id="",t=D),c.modalConfirmLoading=!0,t(e).then((t=>{const{code:a}=t;c.modalConfirmLoading=!1,p[a?"error":"success"](t.message),a||(c.studentStatusVisible=!1,u.dispatch("base/getSchoolRollTree")),e.id&&y.push({query:{...v.query,...s,title:c.form.name}})})).catch((()=>{c.modalConfirmLoading=!1})).finally((()=>{h()}))})).catch((()=>{c.modalConfirmLoading=!1}))},g=e=>{const t=d().add(5,"year"),a=d().subtract(15,"year");return e>t||e<a};return Q((()=>l.Visible),(e=>{c.studentStatusVisible=e;const{statusForm:t,rolllists:a,initRollKey:s}=l;if(e){const{name:e,rollValue:n,type:o,id:i,pid:r}=t;let d=o,u=!1;if(c.isShowYear=!1,c.studentStatus.isEdit=!1,c.form.type=o,"isAdd"===t.activationType){let e="";if(a[o].levels){e=a[a[o].levels+1].label}else o+1&&(d=o+1),e=a[d].label;c.studentStatus.title=`添加${e}`,c.studentStatus.name=e,c.form.id="",c.form.pid=i,c.form.name=null,"professional"===n&&(u=!0,c.isShowYear="grade"===a[o+1].key)}else{const{label:t}=s[n];c.studentStatus.isEdit=!0,c.studentStatus.title=`编辑${t}`,c.studentStatus.name=t,c.form.id=i,c.form.pid=r,c.form.name=e,"grade"===n&&(u=!0,c.isShowYear=!0)}u&&(c.form.id?(()=>{const{rollValue:e,type:t,id:a}=l.statusForm;L({id:a,type:t}).then((a=>{const{data:l}=a;c.form.type=l.type||t,"professional"===e||"grade"===e?c.form.year=l.yearName:c.form.pid=l.id}))})():(()=>{const{pid:e,id:t,type:a}=l.statusForm;U({pid:4===a?e:t}).then((e=>{const{data:t}=e;c.studentStatusName=t.gradeList.map(((e,t)=>({label:e,value:`${t}`})))}))})())}})),(e,t)=>{const a=H("a-input"),l=H("a-form-item"),s=H("a-select"),n=H("a-date-picker"),o=H("a-form"),d=H("a-modal");return G(),ee(d,{visible:c.studentStatusVisible,"onUpdate:visible":t[4]||(t[4]=e=>c.studentStatusVisible=e),title:c.studentStatus.title,maskClosable:!1,"confirm-loading":c.modalConfirmLoading,onCancel:h,onOk:f},{default:Z((()=>[X(o,{class:"study-form",model:c.form,ref_key:"studentStatusFormRef",ref:r,layout:"vertical"},{default:Z((()=>[c.studentStatus.isEdit?(G(),W(se,{key:0},[le(" 编辑 "),X(l,{label:`${c.studentStatus.name}名称：`,name:"name",rules:{required:!0,message:"请选择!",trigger:"change"}},{default:Z((()=>[X(a,{"show-count":"",maxlength:20,value:c.form.name,"onUpdate:value":t[0]||(t[0]=e=>c.form.name=e),placeholder:"请输入"},null,8,["value"])])),_:1},8,["label"])],64)):(G(),W(se,{key:1},[le(" 添加 "),X(l,{label:`${c.studentStatus.name}名称：`,name:"name",rules:{required:!0,message:`请选择${c.studentStatus.name}`,trigger:"change"}},{default:Z((()=>[i.value?(G(),ee(s,{key:0,value:c.form.name,"onUpdate:value":t[1]||(t[1]=e=>c.form.name=e),style:{width:"100%"},placeholder:"请选择",options:c.studentStatusName,onChange:m},null,8,["value","options"])):(G(),ee(a,{key:1,"show-count":"",maxlength:20,value:c.form.name,"onUpdate:value":t[2]||(t[2]=e=>c.form.name=e),placeholder:"请输入"},null,8,["value"]))])),_:1},8,["label","rules"])],64)),le(" 大学版 添加年份 "),c.isShowYear?(G(),ee(l,{key:2,label:"入学年份：",name:"year",rules:{required:!0,message:"请选择入学年份",trigger:"change"}},{default:Z((()=>[X(n,{style:{width:"100%"},value:c.form.year,"onUpdate:value":t[3]||(t[3]=e=>c.form.year=e),"value-format":"YYYY",picker:"year",placeholder:"请选择",disabled:!!c.form.id,"disabled-date":g},null,8,["value","disabled"])])),_:1})):le("v-if",!0)])),_:1},8,["model"])])),_:1},8,["visible","title","confirm-loading"])}}}),[["__scopeId","data-v-6eba8c07"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/uniStudentStatusForm.vue"]]);const It=e=>((null==e?void 0:e.value)||e||[]).map((e=>({title:e.label,dataIndex:e.key,key:"id",width:150,fixed:"name"===e.key?"left":"",ellipsis:!0,disabled:e.show,showSorterTooltip:!0,...e}))),Lt=l.get("columnsCheckedList")||[];var Nt=e(ve({setup(){const e=$(!1),a=t(),s=Y((()=>{const e=a.state.base.commentJsonKeys.INIT_STUDENT_TABLE_LIST,t=[];return null==e||e.forEach((e=>{"eltern"!==e.typeKey&&"parents"!==e.key&&t.push(e)})),t})),n=A({plainOptions:It(s),checkedList:[],checkAll:!1,columnsChecked:[]});return Q((()=>n.plainOptions),(e=>{e&&e.length&&e.forEach((e=>{(Lt.some((t=>e.isShow||t.dataIndex===e.dataIndex))||e.disabled&&!Lt.length)&&n.checkedList.push(e),e.disabled&&n.columnsChecked.push(e)}))}),{immediate:!0}),Q((()=>e.value),(e=>{e&&n.checkedList.length===Lt.length&&(n.checkAll=!0)})),{...ge(n),transferVisible:e,commentJsonKey:s,handleOk:()=>{l.set("columnsCheckedList",n.checkedList),e.value=!1,a.state.selectSource.isTabel=!a.state.selectSource.isTabel},handerChange:e=>{n.checkAll=e.length===n.plainOptions.length},onCheckAllChange:e=>{Object.assign(n,{checkedList:e.target.checked?n.plainOptions:n.columnsChecked})}}}}),[["render",function(e,t,a,l,s,n){const o=H("a-checkbox"),i=H("a-col"),r=H("a-row"),d=H("a-checkbox-group"),u=H("a-modal");return G(),ee(u,{visible:e.transferVisible,"onUpdate:visible":t[2]||(t[2]=t=>e.transferVisible=t),title:"选择列表中要展示的信息",onOk:e.handleOk},{default:Z((()=>[le(' :indeterminate="state.indeterminate" '),X(o,{checked:e.checkAll,"onUpdate:checked":t[0]||(t[0]=t=>e.checkAll=t),onChange:e.onCheckAllChange},{default:Z((()=>[re(ae(e.checkAll?"全不选":"全选"),1)])),_:1},8,["checked","onChange"]),X(d,{value:e.checkedList,"onUpdate:value":t[1]||(t[1]=t=>e.checkedList=t),style:{width:"100%"},onChange:e.handerChange},{default:Z((()=>[X(r,null,{default:Z((()=>[(G(!0),W(se,null,ne(e.plainOptions,(e=>(G(),W(se,null,[e.isShow?le("v-if",!0):(G(),ee(i,{style:{margin:"12px 0"},span:8,key:e.dataIndex},{default:Z((()=>[X(o,{disabled:e.disabled,value:e},{default:Z((()=>[re(ae(e.title),1)])),_:2},1032,["disabled","value"])])),_:2},1024))],64)))),256))])),_:1})])),_:1},8,["value","onChange"])])),_:1},8,["visible","onOk"])}],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/TabelInformation.vue"]]);const Ut=ve({name:"MultiFunctionSearch",props:{multiFunction:{type:[Array,String]}},components:{},setup(){const e=t(),a=A({name:"",isActive:"",pagination:{pageNo:1,pageSize:10}});return{...ge(a),handerMultiFunction:(t,l)=>{const s={...a.pagination,id:e.state.user.currentSchool.id,studentId:t,type:0};e.dispatch("schoolRollManagement/getStudentListInfo",s)}}}}),jt=(e=>(me("data-v-7e87a8e3"),e=e(),he(),e))((()=>te("h3",null,"学生",-1))),Dt={class:"multi-function-content"},Vt=["onClick"],Et={class:"superior"},Ot={key:1,class:"empty"};var Rt=e(Ut,[["render",function(e,t,a,l,s,n){const o=H("caret-right-outlined");return G(),W(se,null,[le(" 人員 "),e.multiFunction&&e.multiFunction.length?(G(),W(se,{key:0},[jt,te("div",Dt,[(G(!0),W(se,null,ne(e.multiFunction,(t=>(G(),W("div",{class:ie(["multi-function-item",{active:e.isActive==t.id}]),key:t.id,onClick:a=>e.handerMultiFunction(t.id,!0)},[t.pName?(G(),W(se,{key:0},[te("span",Et,ae(t.pName),1),X(o,{style:{fontSize:"12px"}})],64)):le("v-if",!0),te("span",null,ae(t.name),1)],10,Vt)))),128))])],64)):(G(),W("p",Ot,"暂无相关人员")),le(' <a-empty image="/image/empty.png" :image-style="{ height: \'80px\' }"></a-empty> ')],2112)}],["__scopeId","data-v-7e87a8e3"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/components/MultiFunctionSearch.vue"]]);const Pt=e=>(me("data-v-1489d342"),e=e(),he(),e),qt={class:"demp_search",style:{"margin-bottom":"16px"}},Mt=Pt((()=>te("i",{class:"iconfont icon-xingzhuangjiehe13"},null,-1))),zt={class:"student-contant"},$t={class:"people-num"},Kt={class:"people-num"},At={class:"table_hander-set"},Yt={key:0,class:"set-teacher"},Qt={key:1},Jt={class:"table_info"},Bt=Pt((()=>te("div",{class:"table_title"},null,-1))),Ht={class:"table_hander"},Gt={key:1,class:"editable-row-operations"},Wt=["onClick"],Xt=["onClick"],Zt=["innerHTML"];var ea=e(ve({__name:"index",setup(e){const d=t(),u=n(),c=o(),h=$(""),v=$(),y=$(),g=$(),b=$(),k=$(!1),_=$(""),S=$([]),w=$([]),C=$(!0),F=$([]),x=$(""),T=e=>{if("INIT_STUDENT_TABLE_LIST"===e){const t=pe(d.state.base.commentJsonKeys[e])||[],a=[];return t.forEach((e=>{e.show&&a.push(e)})),Y((()=>a))}return Y((()=>pe(d.state.base.commentJsonKeys[e])))},{roll_status_filters:I,roll_status_yes_id:L,relations:N}=d.state.selectSource.dictionary,U=l.get("columnsCheckedList")||It(T("INIT_STUDENT_TABLE_LIST").value),j="http://192.168.3.158:9528",D=A({deptID:"",modalVisible:!1,isShowTeacher:!1,handerTitle:"",studentParams:{},setupVisible:!1,spinLoad:!1,personnelNum:{teacherNumber:0,studentsNumber:0,leaders:[],teachers:[]},importExportParams:{btnType:"",isUploading:!1,spinning:!1,visible:!1,title:"导入",accept:"",importId:"",importType:0,downloadText:"",uploadUrl:"",progressUrl:s.progressUrl,errorUrl:s.importErrorLog,importParam:{},downloadUrl:"",themeTitle:"",importBtn:[{value:"0",text:"下载文件"}],exportBtn:[{value:"",text:"上传文件"}],importExportType:"importList"},rollObj:{},statusForm:{activationType:""},studentStatusVisible:!1,quickOperation:T("INIT_OPERATION_LIST").value,componentName:null,menuItem:[{keys:"import",value:"导入学生",name:"student"},{keys:"export",value:"导出学生",name:"student"},{keys:"import",value:"导入任课老师",name:"teacher",show:2==T("schoolType").value},{keys:"export",value:"导出任课老师",name:"teacher",show:2==T("schoolType").value}],roll_status_filters:I||{},importType:!1,relations:N||[],studentDetailsId:"",isDraggable:!0,visible:!1,selectMultiple:!1,personnelTabs:[{tab:"学生组",key:2,checked:!0}],selectTreeData:[],checkedList:[],selectMode:"depa",status:"",transferVisible:!1,studentDetail:{},selectSourceObj:{studentStatusTree:[]},quickOperationState:"",isCheck:!1,pagination:{pageNo:1,pageSize:10,total:0},treeData:[],selectedrowkeys:[],columns:U,studentlistParams:{id:0,type:"0",status:"",statusList:L},routeQuerys:{deptId:"",title:"",type:"",rollValue:""}});be("routeQuerys",(()=>D.routeQuerys)),be("actionParams",(()=>D.importExportParams));const K=Y((()=>{const e=d.state.base.commentJsonKeys.INIT_ROLL_LIST;if(!e)return"";const t=JSON.parse(JSON.stringify(e)),a={};return t&&t.length&&t.forEach(((e,t)=>{a[e.key]=e})),a})),me=Y((()=>e=>{var t,a;const l=d.state.base.commentJsonKeys.INIT_ROLL_LIST.find((t=>t.key===e))||{},s=(null==(t=u.meta)?void 0:t.btnList)||[];return null==(a=l.menuPath)?void 0:a.map((e=>{const t=s.find((t=>t.value===e));return t&&/^set/.test(t.value)?null:t?{...t,isDelete:/^remove/.test(t.value)}:null})).filter((e=>e))})),he=Y((()=>{const e=d.state.base.commentJsonKeys.INIT_ROLL_LIST;if(!e)return"";const t=JSON.parse(JSON.stringify(e)),a={};return t&&t.length&&t.forEach(((e,l)=>{if(t.length-1>l){t[l+1].level!==l+1&&(e.levels=l+1)}a[e.level]=e,D.rollObj[e.level]=e})),a[Ce.type]?a[Ce.type]:null})),ve=Y((()=>d.state.user.currentSchool.isInit)),fe=$([]),ge=A({label:"name",value:"id",children:"area"}),Ce=A({title:"",head:"",type:D.routeQuerys.type||0});U.length&&"operation"===U[U.length-1].dataIndex&&U.splice(U.length-1,1),U.length&&U.forEach((e=>{if("status"===e.dataIndex){const t=[{text:"全部",value:""},...D.roll_status_filters];e.filters=t,e.filterDropdown=e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",Ie(e))}})),U.push({title:"操作",dataIndex:"operation",key:"id",disabled:!0,isShow:!0,align:"left",filterIcon:"icon-xingzhuangjiehe110",width:104,fixed:"right",pathColor:!0,onFilter:()=>v.value.transferVisible=!0});const Te=e=>{if(!e)return k.value=!1,D.pagination={pageNo:1,pageSize:10,total:0},D.studentlistParams.id=D.routeQuerys.deptId,void We();k.value=!0,V({name:e}).then((e=>{const{data:t}=e;F.value=t}))},De=()=>{D.deptID=D.routeQuerys.deptId,D.modalVisible=!0};function Ve({title:e,head:t,type:a}){Ce.title=e||Ce.title,Ce.head=t||Ce.head,Ce.type=a}const Ee=(e,t)=>{const{type:a,level:l,name:s,rollValue:n}=t;D.pagination={pageNo:1,pageSize:10,total:0},x.value=e,w.value=[e],D.studentlistParams.id=e,D.studentlistParams.type=l||a,D.routeQuerys.deptId=e,D.routeQuerys.title=s,D.routeQuerys.type=a,D.routeQuerys.rollValue=n,Ve(t)},Oe=Y((()=>{const e=d.state.base.schoolRollTree;if(e.length){let{id:t,type:a,showName:l,leader:s,rollValue:n}=e[0];D.routeQuerys.deptId?(t=D.routeQuerys.deptId,a=D.routeQuerys.type,l=D.routeQuerys.title,n=D.routeQuerys.rollValue):(D.routeQuerys.deptId=t,D.routeQuerys.title=l,D.routeQuerys.type=a,D.routeQuerys.rollValue=n),D.handerTitle=l,D.studentlistParams.id=t,D.studentlistParams.type=a,w.value=[t],Ve({title:l,head:s,type:a})}return e})),Re=e=>{const t=e.node.pid,a=e.node.key,l=e.dragNode.key,s=e.dragNode.pid,n=e.node.pos.split("-"),o=e.dropPosition-Number(n[n.length-1]),i=(e,t,a)=>{e.forEach(((l,s)=>l.id===t?a(l,s,e):l.children?i(l.children,t,a):void 0))},r=Oe.value;let u={},c={ids:[],type:""};if(e.dropToGap&&t===s){i(r,l,((e,t,a)=>{a.splice(t,1),u=e}));let t=[],s=0;i(r,a,((e,a,l)=>{t=l,s=a})),-1===o?t.splice(s,0,u):t.splice(s+1,0,u);let n=[];n=e.dragNode.parent?e.dragNode.parent.node.children:r;c={ids:n.map((e=>e.id)),type:e.dragNode.type}}else{const t=[];if(a===s){e.dragNode.parent.children.forEach((a=>{e.dragNodesKeys.includes(a.key)||t.push(a.key)})),c={ids:[...e.dragNodesKeys,...t],type:e.dragNode.type}}}c.ids.length&&E(c).then((e=>{d.dispatch("base/getSchoolRollTree")}))},Pe=$(),qe=async()=>{const{studentlistParams:e,pagination:t}=D;t.pageSize||(D.pagination.pageSize=10),t.pageNo||(D.pagination.pageNo=1);const a={...t,...e};await R(a).then((e=>{D.personnelNum={...e.data,studentsNumber:0}}))},Me=async e=>{_.value="添加学生",C.value=e,D.componentName=Ae,e&&(D.isCheck=!1),D.studentDetailsId&&(await qe(),await We(),D.studentDetailsId="")},ze=e=>{!e&&(e=D.studentDetailsId),P({id:e}).then((e=>{const{data:t}=e;D.studentDetail=t}))},$e=async e=>{D.quickOperationState=e.key,D.checkedList=[];let t=[];const a=T("INIT_ROLL_LIST").value;switch(e.key){case"changeClasses":D.visible=!0,t=[0,1,2,3],a.forEach(((e,a)=>"classes"!==e.key&&t.push(e.level))),D.personnelTabs=[{tab:"转班",key:2,checked:!0,disabled:t}],d.dispatch("selectSource/setStudentStatusTree").then((e=>{D.selectTreeData=e}));break;case"study":y.value.studyVisible=!0,y.value.getStudentStudyCheck();break;case"graduate":D.visible=!0,a.forEach(((e,a)=>"grade"!==e.key&&t.push(a))),D.selectTreeData=[];const e={sceneCode:"INIT_ROLL_SCENE_GRADUATION"};d.dispatch("selectSource/setStudentStatusTreev1",e).then((e=>{D.selectTreeData=e.list})),D.personnelTabs=[{tab:"请选择要毕业的年级",key:2,checked:!0,disabled:t}];break;case"retirement":g.value.retirementVisible=!0;break;case"transfer":b.value.transferVisible=!0}},Ke=e=>{if(!e.length)return;const{id:t}=e[0];if("changeClasses"!==D.quickOperationState){if("graduate"===D.quickOperationState){const t=e.map((e=>({rollId:e.id,type:e.type})));q(t).then((e=>{p.success(e.message),d.dispatch("base/getSchoolRollTree"),We()}))}}else Je(t)},Ye=e=>{},Qe=e=>{D.selectedrowkeys=e;const{current:t,pageSize:a,total:l,status:s}=e;D.pagination={pageNo:t,pageSize:a,total:l},D.studentlistParams.status=s&&s.length?s[0]:"",We()},Je=e=>{const t={classesId:e,studentIds:D.selectedrowkeys};M(t).then((async e=>{p.success(e.message),await qe(),await We()}))},Be=()=>{Object.assign(D.importExportParams,{btnType:"rollColumn",importType:1,title:"导入",downloadText:"学籍导入模版",visible:!0,init:!1,themeTitle:"",downloadUrl:`${j}${s.generalExportUrl}`,uploadUrl:`${j}/cloud/common/import`,importBtn:[{value:"0",text:"下载文件"}],importParam:{},importExportType:"importList"})},He=e=>{let t="studentColumn",a="导入",l="学籍导入模板",n=`${j}/cloud/common/import`,o=[{value:"0",text:"下载文件"}],i="importList",r=4,d="学生",u=`${j}${s.generalExportUrl}`;"import"===e.key?"teacher"===e.item.name&&(t="subjectTeacherColumn",n=`${j}/cloud/common/import`,o=[{value:"0",text:"下载文件"}],r=6,d="教职工",l="任课老师导入模板"):(a="导出",l="学籍人员管理信息",i="exportList",u=`${j}${s.generalExceltUrl}`,"teacher"===e.item.name&&(r=6,d="教职工",t="subjectTeacherColumn",l="任课老师信息"));const{deptId:c,type:p}=D.routeQuerys,m={id:c,type:p,name:h.value,status:D.studentlistParams.status};Object.assign(D.importExportParams,{title:a,btnType:t,visible:!0,init:!1,importType:r,downloadText:l,uploadUrl:n,themeTitle:d,downloadUrl:u,importBtn:o,importParam:m,importExportType:i})},Ge=()=>{const e={studentIds:D.selectedrowkeys};m.confirm({title:"删除提示",icon:X(we),content:"删除后不可恢复， 是否继续？",okType:"danger",okText:"确定",cancelText:"取消",onOk(){z(e).then((e=>{p.success(e.message),Ze.value.list.length===D.selectedrowkeys.length&&1!==D.pagination.pageNo&&(D.pagination.pageNo=D.pagination.pageNo-1),D.selectedrowkeys=[],We()}))}})},We=()=>{const{studentlistParams:e,pagination:t}=D;t.pageSize||(D.pagination.pageSize=10),t.pageNo||(D.pagination.pageNo=1);const a={...t,...e};D.spinLoad=!0,d.dispatch("schoolRollManagement/getStudentListInfo",a).then((e=>{const{pageNo:t,pageSize:a,total:l}=e.data.studentPageListVO;D.pagination.pageNo=+t,D.pagination.pageSize=+a,D.pagination.total=+l,D.spinLoad=!1,D.personnelNum.studentsNumber=l}))},Xe=Y((()=>d.state.schoolRollManagement.studentObj)),Ze=Y((()=>{const e=d.state.schoolRollManagement.studentObj,{dictionary:t}=d.state.selectSource,{teachers:a,leaders:l,total:s,list:n}=e;return D.isShowTeacher=!1,(a.length||l.length)&&(D.isShowTeacher=!0),D.pagination.total=s,null==n||n.forEach((e=>{for(const a in e)if(null==e[a]||""===e[a]||void 0===e[a])e[a]="--";else{if("parents"===a)if(e[a].length&&"string"!=typeof e[a]){const t=[];e[a].forEach((e=>{var a;const l=null==(a=D.relations)?void 0:a.findIndex((t=>t.value===e.relations));t.push(`${D.relations[l].label}：${e.name} ${e.phone}`)})),e[a]=t.toString(),e.parentsTip=e[a].replace(/,/g,"<br/>")}else e[a]="--";"bloodType"===a&&(e[a]=`${t[`blood_type${e[a]}`]}`),"status"===a&&(e[a]=`${t[`roll_status${e[a]}`]}`),"accommodation"===a&&(e[a]=`${t[`accommodation${e[a]}`]}`),"nation"===a&&(e[a]=`${t[`nation${e[a]}`]}`),"politicalStatus"===a&&(e[a]=`${t[`political_status${e[a]}`]}`),"healthStatus"===a&&(e[a]=`${t[`health_status${e[a]}`]}`),"country"===a&&(e[a]=`${t[`country${e[a]}`]}`),"idType"===a&&(e[a]=`${t[`id_type${e[a]}`]}`),"householdType"===a&&(e[a]=`${t[`household_type${e[a]}`]}`),"gender"===a&&je.forEach((t=>{t.value===e[a]&&(e[a]=t.label)})),"isChild"!==a&&"isFlow"!==a||Ue.forEach((t=>{t.value===e[a]&&(e[a]=t.label)})),"education"===a&&Ue.forEach((t=>{t.value===e[a]&&(e[a]=t.label)})),"academicSystem"===a&&Ue.forEach((t=>{t.value===e[a]&&(e[a]=t.label)})),"secondDegree"===a&&Ue.forEach((t=>{t.value===e[a]&&(e[a]=t.label)}))}})),e})),et=e=>{let t="";const{leaders:a,teachers:l}=D.personnelNum;if("teacher"===e){if(l.length){const e=[];l.forEach((t=>{const a=t.leaderNames.join("，");e.push(`${t.subjectName}（${a}）`)})),t=e.join("，")}}else{const e=a.map((e=>e.name||e.leaderName));e.length&&(t=e.join("，"))}return t},tt=()=>{D.pagination={pageNo:1,pageSize:10,total:0},d.dispatch("base/getSchoolRollTree").then((e=>{const{data:t}=e;t.length&&(c.push({query:{...u.query,deptId:t[0].id,type:t[0].type}}),w.value=[t[0].id])}))};return Q((()=>u.query.deptId),(async(e,t)=>{e&&(await qe(),await We())})),Q((()=>D.setupVisible),(e=>{e||B((()=>{qe()}))})),Q((()=>d.state.selectSource.isTabel),(e=>{const t=l.get("columnsCheckedList")||It(T("INIT_STUDENT_TABLE_LIST").value);t.length&&t.forEach((e=>{if("status"===e.dataIndex){const t=[{text:"全部",value:""},...D.roll_status_filters];e.filters=t,e.filterDropdown=e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",Ie(e))}})),t.push({title:"操作",dataIndex:"operation",key:"id",disabled:!0,isShow:!0,align:"left",filterIcon:"icon-xingzhuangjiehe110",maxWidth:100,width:104,fixed:"right",pathColor:!0,onFilter:()=>v.value.transferVisible=!0}),D.columns=t})),Q((()=>D.importExportParams.visible),(async(e,t)=>{if(t){const{importType:e}=D.importExportParams;1===e?d.dispatch("base/getSchoolRollTree"):(await qe(),await We())}})),J((async()=>{await qe(),await We(),(async()=>{const e=await f();fe.value=e.data||[]})()})),(e,t)=>{const l=H("a-input-search"),s=H("more-outlined"),n=H("a-menu-item"),o=H("a-menu"),u=H("a-dropdown"),c=H("a-button"),f=H("a-col"),I=H("team-outlined"),L=H("plus-outlined"),N=H("question-circle-outlined"),U=H("a-tooltip"),j=H("a-cascader"),V=H("a-row"),E=a,R=ke("auth");return G(),W("div",null,[ve.value?(G(),ee(V,{key:0,type:"flex",style:{height:"100%"}},{default:Z((()=>[X(f,{class:"demp_tree"},{default:Z((()=>[te("div",qt,[X(l,{allowClear:"",value:h.value,"onUpdate:value":t[0]||(t[0]=e=>h.value=e),valueModifiers:{trim:!0},onSearch:Te,placeholder:"搜索学生"},null,8,["value"])]),k.value?(G(),ee(Rt,{key:1,multiFunction:F.value},null,8,["multiFunction"])):(G(),W(se,{key:0},[le(' v-if="studentStatusTrees.length" '),X(i,{class:ie(["tree-content",{activeMax:2!==T("schoolType").value}]),ref_key:"dempTree",ref:Pe,treeData:Oe.value,defaultExpand:S.value,selectedKeys:w.value,fieldNames:oe(Ne),isDraggable:!0,onEmitDraggable:Re,onEmitSelect:Ee},{handleItem:Z((({handleItem:e})=>[X(u,{trigger:["click"]},{overlay:Z((()=>[X(o,null,{default:Z((()=>[(G(!0),W(se,null,ne(me.value(e.rollValue),((t,a)=>(G(),W("div",{key:a},[X(n,{onClick:a=>((e,t)=>{const{title:a}=e,{id:l,type:s,pid:n}=t;if(e.isDelete)m.confirm({title:a,icon:X(we),content:"删除不可恢复， 确定删除？",okType:"danger",okText:"确定",cancelText:"取消",onOk(){O({id:l,type:s}).then((e=>{D.pagination.pageNo=1,D.pagination.pageSize=10,p.success(e.message),x.value=n,d.dispatch("base/getSchoolRollTree")}))}});else{const a=Pe.value.titleObj[t.id];t.name=a,D.statusForm=t,D.statusForm.activationType=/^add/.test(e.value)?"isAdd":"",D.studentStatusVisible=!0}})(t,e)},{default:Z((()=>[te("span",{style:ye("color:"+(t.isDelete?"red":""))},ae(null==t?void 0:t.label),5)])),_:2},1032,["onClick"])])))),128))])),_:2},1024)])),default:Z((()=>{var a;return[(null==(a=me.value(e.rollValue))?void 0:a.length)?(G(),W("a",{key:0,class:"ant-dropdown-link handle_icon",onClick:t[1]||(t[1]=ce((()=>{}),["prevent","stop"]))},[X(s)])):le("v-if",!0)]})),_:2},1024)])),_:1},8,["class","treeData","defaultExpand","selectedKeys","fieldNames"]),le("  "),de((G(),ee(c,{type:"primary",class:"tree-btn",onClick:Be},{icon:Z((()=>[Mt])),default:Z((()=>[re(" 批量导入 ")])),_:1})),[[R,"rollImport"]])],64))])),_:1}),X(f,{style:{flex:"1",overflow:"hidden"}},{default:Z((()=>[C.value?(G(),W(se,{key:0},[te("div",zt,[te("h1",null,ae(Ce.title),1),X(c,{class:"button-link",type:"link"},{icon:Z((()=>[X(I,{class:"icon-yellow"})])),default:Z((()=>[te("span",$t,ae(D.personnelNum.studentsNumber)+"位学生 ",1)])),_:1}),X(c,{class:"button-link",type:"link"},{icon:Z((()=>[X(I,{class:"icon-yellow"})])),default:Z((()=>[te("span",Kt,ae(D.personnelNum.teacherNumber)+" 位老师",1)])),_:1})]),X(r,{class:"worker-table table_cascader",columns:D.columns,dataSource:Ze.value.list,totals:D.pagination,isScroll:!0,spinLoad:D.spinLoad,onOnSelectedRowKeys:Qe,onOnSelectedArry:t[3]||(t[3]=e=>D.selectedrowkeys=e)},{handleItem:Z((()=>[de(te("div",At,[he.value&&he.value.masterLabel.length?(G(!0),W(se,{key:0},ne(he.value.masterLabel,((e,t)=>(G(),W("div",{key:e.roleKey,style:ye({marginTop:t?"20px":"0"})},[re(ae(e.label)+"： ",1),D.isShowTeacher||Xe.value?(G(),W("span",Yt,ae(et(e.roleKey)),1)):(G(),W("span",Qt,"--")),de((G(),ee(c,{class:"button-link",type:"link",onClick:t=>(e=>{const{leaders:t,teachers:a}=D.personnelNum;D.setupVisible=!0,D.studentParams={...e,leaders:t,teachers:a}})(e)},{default:Z((()=>[re(" 设置 ")])),_:2},1032,["onClick"])),[[R,"setPrincipal"]])],4)))),128)):le("v-if",!0)],512),[[ue,!k.value]]),te("div",Jt,[Bt,te("div",Ht,[de((G(),ee(c,{type:"primary",class:"marl10",onClick:t[2]||(t[2]=e=>Me(!1))},{icon:Z((()=>[X(L)])),default:Z((()=>[re(" 添加学生 ")])),_:1})),[[R,"addStudent"]]),"classes"===D.routeQuerys.rollValue?de((G(),ee(c,{key:0,class:"marl10",onClick:De},{default:Z((()=>[X(U,{placement:"top",title:"设置邀请成员的审核流，请在【云平台-应用中心-审批管理】应用中，设置“XX申请单”审批流程的审批人员"},{default:Z((()=>[re(" 邀请成员 "),X(N,{style:{"margin-left":"6px",color:"#00000073"}})])),_:1})])),_:1})),[[R,"studentInvite"]]):le("v-if",!0),X(u,{class:"marl10"},{overlay:Z((()=>[X(o,{onClick:$e},{default:Z((()=>[(G(!0),W(se,null,ne(D.quickOperation,(e=>(G(),ee(n,{disabled:"study"!==e.key&&"graduate"!==e.key&&!D.selectedrowkeys.length,key:e.key},{default:Z((()=>[re(ae(e.name),1)])),_:2},1032,["disabled"])))),128))])),_:1})])),default:Z((()=>[de((G(),ee(c,null,{default:Z((()=>[re(" 快捷操作 ")])),_:1})),[[R,"shortcutOperation"]])])),_:1}),X(u,{class:"marl10"},{overlay:Z((()=>[X(o,{onClick:He},{default:Z((()=>[(G(!0),W(se,null,ne(D.menuItem,(e=>(G(),W(se,null,[e.show?le("v-if",!0):(G(),ee(n,{key:e.keys,name:e.name},{default:Z((()=>[re(ae(e.value),1)])),_:2},1032,["name"]))],64)))),256))])),_:1})])),default:Z((()=>[de((G(),ee(c,null,{default:Z((()=>[re(" 导入导出 ")])),_:1})),[[R,"importAndExport"]])])),_:1}),de((G(),ee(c,{danger:"",class:"marl10",disabled:!D.selectedrowkeys.length,onClick:Ge},{default:Z((()=>[re("删除")])),_:1},8,["disabled"])),[[R,"removeStudent"]])])])])),bodyCell:Z((({column:e,text:t,record:a})=>[le(" 籍贯 "),"nativePlaces"===e.dataIndex?(G(),ee(j,{key:0,class:"form-select",disabled:!0,fieldNames:ge,value:a.nativePlaces,"onUpdate:value":e=>a.nativePlaces=e,options:fe.value,placeholder:""},null,8,["fieldNames","value","onUpdate:value","options"])):le("v-if",!0),le(" 操作 "),"operation"===e.dataIndex?(G(),W("div",Gt,[de((G(),W("a",{onClick:e=>{return t=a.id,_.value="编辑学生",D.studentDetailsId=t,D.isCheck=!1,C.value=!1,D.componentName=Ae,void ze(t);var t}},[re("编辑")],8,Wt)),[[R,"editStudent"]]),le(' <a-divider type="vertical" /> '),de((G(),W("a",{onClick:e=>{return t=a.id,D.studentDetail={},_.value="查看学生",D.studentDetailsId=t,D.isCheck=!0,C.value=!1,D.componentName=Fe,void ze(t);var t}},[re("查看")],8,Xt)),[[R,"viewStudentInfo"]])])):le("v-if",!0),"parents"===e.dataIndex?(G(),ee(U,{key:2,placement:"topLeft"},_e({default:Z((()=>[re(" "+ae(t),1)])),_:2},[(null==t?void 0:t.length)>15?{name:"title",fn:Z((()=>[te("span",{innerHTML:a.parentsTip},null,8,Zt)])),key:"0"}:void 0]),1024)):(G(),ee(U,{key:3,placement:"topLeft"},_e({default:Z((()=>[re(" "+ae(t),1)])),_:2},[(null==t?void 0:t.length)>15?{name:"title",fn:Z((()=>[re(ae(t),1)])),key:"0"}:void 0]),1024))])),_:1},8,["columns","dataSource","totals","spinLoad"])],64)):(G(),ee(Se(D.componentName),{key:1,ref:"studentFormRef",studentTitle:_.value,isCheck:D.isCheck,studentDetailPrarms:D.studentDetail,threeLevelLinkage:fe.value,onSmitStudentForm:Me,onEmitStudentDetails:ze},null,40,["studentTitle","isCheck","studentDetailPrarms","threeLevelLinkage"]))])),_:1})])),_:1})):(G(),ee(it,{key:1,onEmitRefresh:tt})),le(" 升学 "),X(bt,{ref_key:"studyRef",ref:y},null,512),le(" 退休学 "),X(_t,{ref_key:"retirementRef",ref:g,selectedrowkeys:D.selectedrowkeys},null,8,["selectedrowkeys"]),le(" 转学 "),X(wt,{ref_key:"transferRef",ref:b,selectedrowkeys:D.selectedrowkeys},null,8,["selectedrowkeys"]),le(" 设置负责人 "),le(' ref="setupPersonChargeRef" '),X(Ft,{studentParams:D.studentParams,setupVisible:D.setupVisible,"onUpdate:setupVisible":t[4]||(t[4]=e=>D.setupVisible=e)},null,8,["studentParams","setupVisible"]),le("大学  学籍tree 修改 删除 "),2==T("schoolType").value?(G(),ee(Tt,{key:2,Visible:D.studentStatusVisible,"onUpdate:Visible":t[5]||(t[5]=e=>D.studentStatusVisible=e),rolllists:D.rollObj,initRollKey:K.value,statusForm:D.statusForm},null,8,["Visible","rolllists","initRollKey","statusForm"])):(G(),W(se,{key:3},[le(" 学籍tree 修改 删除 "),X(xt,{Visible:D.studentStatusVisible,"onUpdate:Visible":t[6]||(t[6]=e=>D.studentStatusVisible=e),rolllists:D.rollObj,initRollKey:K.value,statusForm:D.statusForm},null,8,["Visible","rolllists","initRollKey","statusForm"])],2112)),X(Nt,{ref_key:"tabelInformationRef",ref:v},null,512),le(" 导入导出 "),X(xe),le("  "),X(E,{visible:D.visible,"onUpdate:visible":t[7]||(t[7]=e=>D.visible=e),multiple:D.selectMultiple,tabs:D.personnelTabs,treeData:D.selectTreeData,mode:D.selectMode,checked:D.checkedList,"onUpdate:checked":t[8]||(t[8]=e=>D.checkedList=e),onHandleOk:Ke,onEmitSelectLeft:Ye},null,8,["visible","multiple","tabs","treeData","mode","checked"]),le(" 邀请成员 弹框 "),X(oe(Le),{modalVisible:D.modalVisible,"onUpdate:modalVisible":t[9]||(t[9]=e=>D.modalVisible=e),deptId:D.deptID,getUrl:"classesId"},null,8,["modalVisible","deptId"])])}}}),[["__scopeId","data-v-1489d342"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/schoolRoll/index.vue"]]);export{ea as default};
