import"./vue.a2f518ee.js";import{c as e,d as t}from"./historicalUser.5cdfb7d4.js";import{s}from"./schoolRoll.370ea454.js";import{g as a}from"./workers.a8ab8099.js";import{_ as l,u as o}from"./index.7061e8ea.js";import{m as r}from"./ant-design-vue.db4d48e3.js";import{Q as i,q as n,y as d,w as c,b8 as u,o as p,a2 as m,a3 as y,c as f,b as v,a as k,F as P,a8 as b,a9 as h,u as _,O as I,a7 as x}from"./@vue.919ff404.js";const g={class:"item_title"},L={class:"item_title_form"},j={class:"tips"},N={key:1,class:"item_it"},q={class:"it_title"};var w=l({__name:"complexLearnPost",props:{visibleLearnPost:{type:Boolean,default:!1},learnPostParams:{type:Object,default:()=>{}}},emits:["update:visibleLearnPost","updateInit"],setup(l,{emit:w}){const O=l,U=o(),T=i(),C=(e,t)=>t?Promise.resolve():Promise.reject("请选择"),S=n({visible:!1,title:"复职",classType:"",classId:"",cearnPost:{teacherId:"",deptIds:[],studentId:"",classesId:null,status:null},foundationPostOption:[],foundationLearnOption:[],type:"foundationPost",fieldNames:{children:"children",label:"name",value:"id"},foundationLearn:[{title:"基础信息",operation:!1,children:[{text:"姓名：",key:"name"},{text:"学籍状态：",key:"status"},{text:"班级：",key:"className"}]},{title:"复学操作",operation:!0,tips:"1、复学操作仅可更改“学籍状态”与“班级”；2、学生其他信息在复学操作之后，可在学籍管理模块进行更新",children:[{text:"学籍状态：",key:"statuss",required:!0},{text:"班级：",key:"classesId",required:!0}]}],foundationPost:[{title:"基础信息",operation:!1,children:[{text:"姓名：",key:"name"},{text:"学籍状态：",key:"status"},{text:"部门：",key:"deptName"}]},{title:"复职操作",operation:!0,tips:"     1、复职操作仅可更改“当前状态”与“部门信息”；2、员工其他信息在复职操作之后，可在教职工管理模块进行更新",children:[{text:"当前状态：",key:"statuss",required:!0},{text:"部门：",key:"deptIds",required:!0}]}],rules:{statuss:[{required:!0,validator:C,trigger:["change","blur"]}],deptIds:[{required:!0,validator:C,trigger:["change","blur"]}],classesId:[{required:!0,validator:C,trigger:["change","blur"]}]}}),{emp_status_yes:R,roll_status_yes:J}=U.state.selectSource.dictionary,B=d((()=>U.state.base.departmentTree)),D=d((()=>U.state.base.schoolRollTree)),F=(e,t)=>{const{rollValue:s}=t;"foundationLearn"===S.type&&("classes"===s?(S.cearnPost.classesId=e,S.classId=e,S.classType=s):S.classType?S.cearnPost.classesId=S.classId:S.cearnPost.classesId=null)};c((()=>O.visibleLearnPost),(e=>{if(S.visible=e,e){const{id:e,type:t,title:l}=O.learnPostParams;S.type=t,S.title=l,"foundationLearn"===t?(e=>{s({id:e}).then((({data:e})=>{const{classesNormal:t,classesId:s,id:a}=e;S.cearnPost.studentId=a,t&&(S.cearnPost.classesId=s,S.classId=s,S.classType="classes")}))})(e):(e=>{a({id:e}).then((({data:e})=>{const{deptNormal:t,depts:s,id:a}=e;S.cearnPost.teacherId=a,t&&(S.cearnPost.deptIds=s)}))})(e)}}));const Q=()=>{w("update:visibleLearnPost",!1)},V=()=>{T.value.validate().then((()=>{(()=>{let s=e;"foundationLearn"===S.type&&(s=t);const a=JSON.parse(JSON.stringify(S.cearnPost));a.statuss&&(a.status=a.statuss),s(a).then((e=>{r.success(e.message),w("updateInit")}))})(),Q()}))};return(e,t)=>{const s=u("a-select"),a=u("team-outlined"),o=u("a-tree-select"),r=u("a-form-item"),i=u("exclamation-circle-filled"),n=u("a-form"),d=u("a-modal");return p(),m(d,{class:"complex_learn_post",visible:S.visible,"onUpdate:visible":t[0]||(t[0]=e=>S.visible=e),destroyOnClose:!0,maskClosable:!1,title:S.title,onCancel:Q,onOk:V},{default:y((()=>[f(n,{layout:"vertical",ref_key:"cearnPostRef",ref:T,rules:S.rules,model:S.cearnPost},{default:y((()=>[v("ul",null,[(p(!0),k(P,null,b(S[S.type],((e,t)=>(p(),k("li",{class:"learn_post_item",key:t},[v("div",g,h(e.title),1),e.operation?(p(),k(P,{key:0},[v("div",L,[(p(!0),k(P,null,b(e.children,((e,t)=>(p(),m(r,{key:t,name:e.key,label:e.text},{default:y((()=>[t?(p(),m(o,{key:1,value:S.cearnPost[e.key],"onUpdate:value":t=>S.cearnPost[e.key]=t,"show-search":"",style:{width:"100%"},placeholder:"请选择","allow-clear":"",onSelect:F,"tree-checkable":"foundationLearn"!==S.type,"tree-default-expand-all":"",fieldNames:S.fieldNames,"tree-data":"foundationLearn"===S.type?D.value:B.value},{title:y((e=>[f(a,{class:"icon-yellow"}),I(" "+h(e.name),1)])),_:2},1032,["value","onUpdate:value","tree-checkable","fieldNames","tree-data"])):(p(),m(s,{key:0,value:S.cearnPost[e.key],"onUpdate:value":t=>S.cearnPost[e.key]=t,placeholder:"请选择",options:"foundationLearn"===S.type?_(J):_(R)},null,8,["value","onUpdate:value","options"]))])),_:2},1032,["name","label"])))),128))]),v("p",j,[f(i,{style:{color:"#faad14"}}),I(" "+h(e.tips),1)])],64)):(p(),k("div",N,[e.children.length?(p(!0),k(P,{key:0},b(e.children,((e,t)=>(p(),k("div",{class:"item_it_list",key:t},[v("span",q,h(e.text),1),v("span",null,h(l.learnPostParams[e.key]),1)])))),128)):x("v-if",!0)]))])))),128))])])),_:1},8,["rules","model"])])),_:1},8,["visible","title"])}}},[["__scopeId","data-v-6bb2cb04"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/framework/historicalUser/components/complexLearnPost.vue"]]);export{w as C};
