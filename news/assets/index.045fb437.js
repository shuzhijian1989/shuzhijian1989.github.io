import"./vue.a2f518ee.js";import{u as e,a as t}from"./vue-router.907b547c.js";import{a as o,m as s}from"./ant-design-vue.db4d48e3.js";import{cl as a,_ as l,cm as i,u as c,cn as n,L as r,co as d,cp as u,cq as m,cr as g,aV as p}from"./index.7061e8ea.js";import{e as h,r as f,q as v,f as y,g as b,b8 as k,o as _,a as w,a7 as x,c as S,a9 as j,b as T,O as I,a3 as N,a2 as U,aw as L,aV as F,u as C,a5 as B,F as E,R,H as A,L as q,a8 as K,a4 as P,n as z,b5 as D,b4 as O,Q as J,N as M,a6 as Q}from"./@vue.919ff404.js";import"./qs.e55e9b28.js";import"./@babel.6d5f88cb.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";const V={class:"code-from"},H={key:0,class:"expired"},G={class:"refresh"};var W=l(h({__name:"codeFrom",emits:["submit"],setup(e,{emit:t}){const o=f(null),s=v({width:184,height:184,mask:!1,codeStatus:["未扫码","已扫码","已过期","已授权","取消授权"],title:"",codeURL:"",expiresIn:"",random:""}),l=()=>{s.mask=!1,c()},c=()=>{a().then((({data:e})=>{const{qrcode:a,random:l,expiresIn:c}=e;s.codeURL=a,s.expiresIn=c,s.random=l,o.value=setInterval((()=>{s.expiresIn?i(s.random).then((({data:e})=>{const{qrcode:a,expiresIn:l,status:i,ticket:c}=e;if(s.expiresIn=l,s.title=s.codeStatus[i],1===i)return s.width=125,s.height=186,void(s.codeURL="/image/QRcodeauthorization.png");if(3===i){const e=JSON.parse(c);return clearInterval(o.value),void t("submit",{checkedPwd:!1,accountFrom:e})}s.mask=2===i,s.width=184,s.height=184,s.codeURL=a})):clearInterval(o.value)}),2e3)}))};return y((()=>{c()})),b((()=>{clearInterval(o.value)})),(e,t)=>{const o=k("a-image"),a=k("sync-outlined"),i=k("a-button");return _(),w("div",V,[x(' <img class="code" :src="codeURL" /> '),S(o,{preview:!1,width:s.width,height:s.height,src:s.codeURL},null,8,["width","height","src"]),s.mask?(_(),w("div",H,j(s.title),1)):x("v-if",!0),T("div",G,[I(" 请使用APP扫描二维码登录 "),S(i,{class:"button-link",type:"link",onClick:l},{icon:N((()=>[S(a,{style:{"margin-right":"7px"}})])),default:N((()=>[I("刷新 ")])),_:1})])])}}}),[["__scopeId","data-v-db3df680"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/components/codeFrom.vue"]]);var X=l({__name:"accountFrom",props:{loginText:String,loading:Boolean,isNeutral:{type:Boolean,default:!1}},emits:["submit"],setup(e,{emit:t}){const s=o.useForm,a=v({username:"",password:"",grant_type:"password",client_id:"yide-cloud",client_secret:"yide1234567"}),l=v({username:[{required:!0,message:"请输入手机号或用户名!",trigger:"blur"}],password:[{required:!0,message:"请输入密码!",trigger:"blur"}]}),i=v({checkedUserName:!1,activeKey:"1"}),{resetFields:c,validate:n,validateInfos:r}=s(a,l),d=()=>{n().then((()=>{i.checkedUserName?window.localStorage.setItem("USERNAME",a.username):window.localStorage.removeItem("USERNAME"),t("submit",{checkedPwd:i.checkedPwd,accountFrom:R(a)})})).catch((()=>{}))};function u(e){13===e.keyCode&&d()}return y((()=>{const e=window.localStorage.getItem("USERNAME");e&&(a.username=e,i.checkedUserName=!0)})),(t,o)=>{const s=k("a-tab-pane"),l=k("a-tabs"),c=k("lock-outlined"),n=k("a-input"),m=k("a-form-item"),g=k("user-outlined"),p=k("a-input-password"),h=k("a-checkbox"),f=k("a-button"),v=k("a-form");return _(),w(E,null,[S(l,{activeKey:i.activeKey,"onUpdate:activeKey":o[0]||(o[0]=e=>i.activeKey=e)},{default:N((()=>[S(s,{key:"1",tab:"账号登录"}),e.isNeutral?(_(),U(s,{key:"2",tab:"扫码登录"})):x("v-if",!0)])),_:1},8,["activeKey"]),1==i.activeKey?(_(),U(v,{key:0},{default:N((()=>[S(m,L(F(C(r).username)),{default:N((()=>[T("div",{style:B(e.isNeutral?"border-bottom: 1px solid #ccc;display: flex;    align-items: center;":"")},[e.isNeutral?(_(),U(c,{key:0,style:{color:"#00b781"}})):x("v-if",!0),S(n,{size:"large",bordered:!e.isNeutral,value:a.username,"onUpdate:value":o[1]||(o[1]=e=>a.username=e),placeholder:"请输入你的手机号或用户名"},null,8,["bordered","value"])],4)])),_:1},16),S(m,L(F(C(r).password)),{default:N((()=>[T("div",{style:B(e.isNeutral?"border-bottom: 1px solid #ccc;display: flex;    align-items: center;":"")},[e.isNeutral?(_(),U(g,{key:0,style:{color:"#00b781"}})):x("v-if",!0),S(p,{size:"large",bordered:!e.isNeutral,value:a.password,"onUpdate:value":o[2]||(o[2]=e=>a.password=e),placeholder:"请输入密码",onKeydown:u},null,8,["bordered","value"])],4)])),_:1},16),S(m,{class:"password-operate"},{default:N((()=>[S(h,{checked:i.checkedUserName,"onUpdate:checked":o[3]||(o[3]=e=>i.checkedUserName=e)},{default:N((()=>[I(" 记住账号 ")])),_:1},8,["checked"]),x(' <router-link class="button-link" to="/updatePassw">忘记密码</router-link> ')])),_:1}),S(m,null,{default:N((()=>[S(f,{size:"large",style:{width:"100%",margin:"0"},type:"primary",onClick:d,loading:e.loading},{default:N((()=>[I(j(e.loginText),1)])),_:1},8,["loading"])])),_:1})])),_:1})):x("v-if",!0),2==i.activeKey?(_(),U(W,{key:1,onSubmit:d})):x("v-if",!0)],64)}}},[["__scopeId","data-v-17f3ab04"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/components/accountFrom.vue"]]);const Y={class:"custom-slick-arrow",style:{left:"-25px","z-index":"1"}},Z={class:"custom-slick-arrow",style:{right:"-25px"}},$=["onClick"],ee={class:"school-name"};var te=l({__name:"selectSchool",props:{data:Array},emits:["back","checkoutSchool"],setup(e,{emit:t}){const o=e,{data:s}=o,a=f(!1),l=f(!0),i=f(1),c=f([]),n=f(!1);y((()=>{c.value=[...s],c.value.push({schoolLogo:"",schoolName:"",hide:!0}),c.value.unshift({schoolLogo:"",schoolName:"",hide:!0})}));const r=()=>{n.value=!0,t("checkoutSchool",c.value[i.value],(()=>{n.value=!1}))},d=()=>{t("back",!1)},u=e=>{if(1!==o.data.length){if(m.value.goTo(e-1),i.value=e+1,!e)return a.value=!1,void(l.value=!0);e==c.value.length-3&&(a.value=!0,l.value=!1)}},m=f(null);return(e,t)=>{const o=k("left-circle-outlined"),s=k("right-circle-outlined"),i=k("a-image"),g=k("a-carousel"),p=k("a-button");return _(),w(E,null,[S(g,{class:"selectSchool",arrows:"",dots:!1,"slides-to-show":3,ref_key:"selectSchoolRef",ref:m,"after-change":u,dontAnimate:!0},{prevArrow:N((()=>[A(T("div",Y,[S(o,{class:"circle-outlined"})],512),[[q,a.value]])])),nextArrow:N((()=>[A(T("div",Z,[S(s,{class:"circle-outlined"})],512),[[q,l.value]])])),default:N((()=>[(_(!0),w(E,null,K(c.value,((e,t)=>(_(),w("div",{key:e.schoolLogo,onClick:e=>u(t),class:"itemSchool"},[e.hide?x("v-if",!0):(_(),U(i,{key:0,class:"img",width:68,height:68,src:e.schoolLogo,fallback:"/image/uploadImg.png",preview:!1},null,8,["src"])),T("p",ee,j(e.schoolName),1)],8,$)))),128))])),_:1},512),S(p,{size:"large",style:{width:"100%",margin:"20px auto"},type:"primary",loading:n.value,onClick:r},{default:N((()=>[I("登录 ")])),_:1},8,["loading"]),S(p,{class:"button-link",type:"link",style:{padding:"0"},onClick:d},{default:N((()=>[I("返回")])),_:1})],64)}}},[["__scopeId","data-v-151837ce"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/components/selectSchool.vue"]]);const oe={class:"login-bg-content"},se=["src"],ae={class:"login-from"},le={class:"login-title-content"},ie=["src"],ce={type:"text"};var ne=l({__name:"cloudLogin",setup(o){const a=e(),l=t(),i=c(),p=v({logo:"/image/logo.png",loginBgFigure:"/image/loginBgFigure.png",title:"一加壹教育云平台",desc:"网络化、数字化、智能化、个性化、终身化的教育体系，构建人本、开放、平等、可持续的教育新生态。",loginText:"登 录",loadingBtn:!1,loginType:!0,isSelectSchool:!1,schoolList:[],version:"2.2.4"}),h=()=>{p.loginType=!p.loginType};y((()=>{C()}));const f=()=>({success(){p.loginText="登录",p.loadingBtn=!1},error(){p.loginText="登录失败",p.loadingBtn=!1,i.commit("user/removerUserLoginInfo"),setTimeout((()=>{p.loginText="登录"}),2e3)},loading(){p.loginText="登录中...",p.loadingBtn=!0}}),b=(e=!0)=>{p.isSelectSchool=e,p.title=e?"选择学校":"一加壹教育云平台",f().success()},L=(e,t)=>{u({schoolId:e.id}).then((o=>{if(0===o.code){if(void 0!==e.isEnabled&&!e.isEnabled)return f().error(),s.error("该学校被禁用");if(e.children.length){const{isEnabled:t}=e.children[0];if(!t)return f().error(),s.error("该教职工账号已停用")}i.commit("user/setCurrentSchool",e),r.set("schoolId",e.id),f().loading();try{a.replace({path:"/"})}catch(c){}if("Error: 1002002014"===l.params.error){const e=window.sessionStorage.getItem("accountFrom");F({accountFrom:JSON.parse(e)})}else window.sessionStorage.removeItem("accountFrom");t&&t()}else s.error(o.message)})).catch((()=>{t&&t()}))};async function F({accountFrom:e}){window.sessionStorage.setItem("accountFrom",JSON.stringify(e)),f().loading(),m(e).then((t=>{const{accessToken:o,refreshToken:s}=t.data;i.commit("user/setToken",{accessToken:o,refreshToken:s}),g().then((t=>{const o=t.data.school;p.schoolList=o,i.commit("user/setUser",t.data),"qrcode"===e.grant_type&&1===o.length?L(o[0]):b()})).catch((()=>{f().error()})).finally(f().success())})).catch((()=>{z(f().error())})).finally((()=>{z(f().success())}))}const C=()=>{const{token:e,AccountNumber:t}=n();if(e){r.clear(),d.clear();F({accountFrom:{token:e,accountNumber:t,grant_type:"open_login",client_id:"yide-cloud",client_secret:"yide1234567"}})}};return(e,t)=>{const o=k("a-col"),s=k("a-layout-content"),a=k("a-button"),l=k("a-layout-footer"),i=k("a-layout"),c=k("a-row");return _(),U(c,{type:"flex",style:{height:"100%","min-width":"900px"}},{default:N((()=>[S(o,{flex:"431px",class:"login-bg"},{default:N((()=>[T("div",oe,[T("h1",null,j(p.desc),1),T("img",{src:p.loginBgFigure},null,8,se)])])),_:1}),S(o,{style:{flex:"1"},flex:"auto"},{default:N((()=>[S(i,{style:{height:"100%"}},{default:N((()=>[S(s,{style:{height:"100%"}},{default:N((()=>[x(" 登录 "),T("div",ae,[T("div",le,[p.isSelectSchool?x("v-if",!0):(_(),w("img",{key:0,src:p.logo},null,8,ie)),T("h1",null,j(p.title),1)]),p.isSelectSchool?(_(),w(E,{key:1},[x(" 登录后选学校 "),S(te,{onBack:t[0]||(t[0]=e=>b(!1)),data:p.schoolList,onCheckoutSchool:L},null,8,["data"])],2112)):(_(),w(E,{key:0},[T("div",{class:P(["icons",""+(p.loginType?"scancodelogin":"userpwdlogin")]),onClick:h},null,2),x(" 账号登录 "),p.loginType?(_(),U(X,{key:0,onSubmit:F,loginText:p.loginText,loading:p.loadingBtn},null,8,["loginText","loading"])):(_(),w(E,{key:1},[x(" 扫码登录 "),S(W,{onSubmit:F})],2112))],64))])])),_:1}),S(l,{style:{"text-align":"center"}},{default:N((()=>[I(" 版权所有© 深圳市一德文化科技有限公司 "),S(a,{href:"https://beian.miit.gov.cn/#/Integrated/index",target:"_blank",type:"text"},{default:N((()=>[I(" 粤ICP备17028019号-4")])),_:1}),T("span",ce,"v"+j(p.version),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1ac1a4fd"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/components/cloudLogin.vue"]]);const re={class:"login-from"},de=(e=>(D("data-v-e541fd2a"),e=e(),O(),e))((()=>T("div",{class:"from_background"},null,-1))),ue={class:"from_box"},me=["src"],ge={class:"filing_desc"},pe={href:"https://beian.miit.gov.cn/#/Integrated/index",target:"_blank",type:"text"};var he=l({__name:"neutralLogin",props:{data:{type:Array,default:()=>[]}},setup(o){const a=o,l=e(),i=t(),p=c(),h=v({logo:"/neutralImg/logo.png",title:"教育云平台",desc:"网络化、数字化、智能化、个性化、终身化的教育体系，构建人本、开放、平等、可持续的教育新生态。",loginText:"登 录",loadingBtn:!1,loginType:!0,isSelectSchool:!1,schoolList:[],version:"2.2.4"});y((()=>{F();const{websiteLogo:e,websiteName:t}=a.data;h.logo=e,h.title=t}));const f=()=>({success(){h.loginText="登录",h.loadingBtn=!1},error(){h.loginText="登录失败",h.loadingBtn=!1,p.commit("user/removerUserLoginInfo"),setTimeout((()=>{h.loginText="登录"}),2e3)},loading(){h.loginText="登录中...",h.loadingBtn=!0}}),b=(e=!0)=>{h.isSelectSchool=e,h.title=e?"选择学校":"教育云平台",f().success()},I=(e,t)=>{u({schoolId:e.id}).then((o=>{if(0===o.code){if(void 0!==e.isEnabled&&!e.isEnabled)return f().error(),s.error("该学校被禁用");if(e.children.length){const{isEnabled:t}=e.children[0];if(!t)return f().error(),s.error("该教职工账号已停用")}p.commit("user/setCurrentSchool",e),r.set("schoolId",e.id),f().loading();try{l.replace({path:"/"})}catch(a){}if("Error: 1002002014"===i.params.error){const e=window.sessionStorage.getItem("accountFrom");L({accountFrom:JSON.parse(e)})}else window.sessionStorage.removeItem("accountFrom");t&&t()}else s.error(o.message)})).catch((()=>{t&&t()}))};async function L({accountFrom:e}){window.sessionStorage.setItem("accountFrom",JSON.stringify(e)),f().loading(),m(e).then((t=>{const{accessToken:o,refreshToken:s}=t.data;p.commit("user/setToken",{accessToken:o,refreshToken:s}),g().then((t=>{const o=t.data.school||[];h.schoolList=o,p.commit("user/setUser",t.data),"qrcode"===e.grant_type&&1===o.length?I(o[0]):b(!0)})).catch((()=>{f().error()})).finally(f().success())})).catch((()=>{z(f().error())})).finally((()=>{z(f().success())}))}const F=()=>{const{token:e,AccountNumber:t}=n();if(e){r.clear(),d.clear();L({accountFrom:{token:e,accountNumber:t,grant_type:"open_login",client_id:"yide-cloud",client_secret:"yide1234567"}})}};return(e,t)=>{const s=k("a-layout-content"),a=k("a-layout"),l=k("a-col"),i=k("a-row");return _(),U(i,{type:"flex",style:{height:"100%","min-width":"900px"}},{default:N((()=>[S(l,{flex:"auto"},{default:N((()=>[S(a,{style:{height:"100%"}},{default:N((()=>[S(s,{class:"login_box"},{default:N((()=>[x(" 登录 "),T("div",re,[de,T("div",ue,[T("div",{class:"login-title-content",style:B(h.isSelectSchool?"":" justify-content: flex-start;")},[h.isSelectSchool?x("v-if",!0):(_(),w("img",{key:0,src:h.logo},null,8,me)),T("h1",null,j(h.title),1)],4),h.isSelectSchool?(_(),w(E,{key:1},[x(" 登录后选学校 "),S(te,{onBack:t[0]||(t[0]=e=>b(!1)),data:h.schoolList,onCheckoutSchool:I},null,8,["data"])],2112)):(_(),w(E,{key:0},[x(" 账号登录 "),h.loginType?(_(),U(X,{key:0,onSubmit:L,loginText:h.loginText,loading:h.loadingBtn,isNeutral:!0},null,8,["loginText","loading"])):(_(),w(E,{key:1},[x(" 扫码登录 "),S(W,{onSubmit:L})],2112))],64))])]),T("div",ge,[T("a",pe,j(o.data.filingDesc||"粤ICP备17028019号-4"),1)])])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-e541fd2a"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/components/neutralLogin.vue"]]);const fe={style:{height:"100%","min-width":"900px"}};var ve=l({__name:"index",setup(e){const{setItem:o}=p(),s=t(),a=J(ne),l=f([]),{hostname:i}=window.location;return M((()=>{fetch("http://192.168.3.158:9528/cloud/manage/website/config/getInfo",{method:"post",body:JSON.stringify({uri:i}),headers:{"Content-Type":"application/json"}}).then((async e=>{const t=await e.json();if(null==t?void 0:t.data){e.value=t.data;const{isCloud:l,websiteName:i,websiteLogo:c}=t.data;window.document.title=l?""+("一加壹教育云平台 -"+s.meta.title):""+(i+"-"+s.meta.title),o("documentTitle",i||"一加壹教育云平台"),o("documentLogo",c||"/image/logo.png"),a.value=l?ne:he}else a.value=ne})).catch((e=>{a.value=ne}))})),(e,t)=>(_(),w("div",fe,[(_(),U(Q(a.value),{data:l.value},null,8,["data"]))]))}},[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/login/index.vue"]]);export{ve as default};
