import{_ as e}from"./index.272083a4.js";import{_ as t,X as a}from"./index.7061e8ea.js";import"./vue.a2f518ee.js";import{u as o,a as s}from"./vue-router.907b547c.js";import{g as l}from"./FilterDropdown.5a779a00.js";import{M as i,m as r}from"./ant-design-vue.db4d48e3.js";import{o as d,s as n,f as p}from"./patrol.d6c87ea2.js";import{Q as c,y as u,q as m,f as y,b8 as f,o as v,a as j,b as x,c as g,a3 as k,a2 as b,F as h,a8 as I,O as _,a9 as w,a7 as T,u as q,a6 as S,a5 as N}from"./@vue.919ff404.js";import{S as F,E as C}from"./@ant-design.2e172c39.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./@babel.6d5f88cb.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./dayjs.49e29cb2.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const z={class:"plan_info_class"},D={class:"plan_list"},K={class:"head_operation"},L={class:"queryform_class"},P={key:1},U={key:2},M={key:3,class:"table_btn"};var O=t({__name:"index",setup(t){const O=c(),R=o(),$=s(),B=[{text:"全部",value:null},{text:"待巡查",color:"#faad14",value:0},{text:"已完成",color:"#00B781",value:1},{text:"已失效",color:"#d9d9d9",value:2},{text:"未到巡查时间",color:"#000000D9",value:3},{text:"已逾期",color:"#f5222d",value:4}],E=u((()=>$.query)),Q=m({taskType:[],spinLoad:!1,taskData:[],pagination:{pageNo:1,pageSize:10,total:0},queryForm:{patrolTypeId:null,queryName:"",siteName:"",status:""},planInfoColumn:[{title:"序号",dataIndex:"index",key:"index",width:70},{title:"巡查场地",dataIndex:"siteName",key:"siteName",ellipsis:!0,showSorterTooltip:!0,width:250},{title:"执行人员",dataIndex:"taskUserName",key:"taskUserName",ellipsis:!0,showSorterTooltip:!0},{title:"任务时间",dataIndex:"startTime",key:"startTime",ellipsis:!0,showSorterTooltip:!0,width:250},{title:"所属计划",dataIndex:"dayProjectName",key:"dayProjectName",width:250},{title:"指派时间",dataIndex:"createTime",key:"createTime",ellipsis:!0,showSorterTooltip:!0,width:250},{title:"状态",dataIndex:"status",key:"status",customFilterIcon:"caret-right-outlined",filters:B,ellipsis:!0,showSorterTooltip:!0,pathColor:!1,filterMultiple:!1,customFilterDropdown:!0,filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",l(e))},{title:"操作",dataIndex:"operation",key:"operation",fixed:"right",width:200}]}),V=()=>{const{patrolProjectId:e}=$.query,t={patrolProjectId:e,...Q.queryForm,...Q.pagination};E.value.codeId&&(t.patrolTypeId=E.value.codeId),Q.spinLoad=!0,d(t).then((({data:e})=>{const{pageNo:t,pageSize:a,total:o,list:s=[]}=e;Q.taskData=s||[],Q.pagination={pageNo:t,pageSize:a,total:o}})).finally((()=>Q.spinLoad=!1))},X=e=>{const{pageSize:t,current:a,status:o}=e;Q.queryForm.status=null===o?o:o[0],Q.pagination.pageNo=a,Q.pagination.pageSize=t,V()},A=()=>{Q.pagination.pageNo=1,Q.pagination.pageSize=20,V()},G=()=>{O.value.resetFields(),Q.pagination.pageNo=1,Q.pagination.pageSize=20,V()},H=u((()=>e=>B.filter((t=>t.value===e))[0])),J=u((()=>e=>`${e.startTime} 至 ${e.endTime}`));return y((()=>{V(),p().then((({data:e})=>{Q.taskType=e}))})),(t,o)=>{const s=f("a-input"),l=f("a-form-item"),d=f("a-select-option"),p=f("a-select"),c=f("a-button"),u=f("redo-outlined"),m=f("a-form"),y=a,$=f("a-badge"),B=e;return v(),j("div",z,[x("div",D,[x("div",K,[g(m,{layout:"horizontal",model:Q.queryForm,ref_key:"queryVoteRef",ref:O},{default:k((()=>[x("div",L,[g(l,{label:"关键字：",name:"queryName"},{default:k((()=>[g(s,{style:{width:"240px"},value:Q.queryForm.queryName,"onUpdate:value":o[0]||(o[0]=e=>Q.queryForm.queryName=e),placeholder:"请输入计划名称关键词"},null,8,["value"])])),_:1}),E.value.codeId?T("v-if",!0):(v(),b(l,{key:0,label:"分类：",name:"patrolTypeId"},{default:k((()=>[g(p,{style:{width:"240px"},value:Q.queryForm.patrolTypeId,"onUpdate:value":o[1]||(o[1]=e=>Q.queryForm.patrolTypeId=e),placeholder:"请选择"},{default:k((()=>[(v(!0),j(h,null,I(Q.taskType,(e=>(v(),b(d,{value:e.value,key:e.id},{default:k((()=>[_(w(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})),g(l,null,{default:k((()=>[g(c,{type:"primary","html-type":"submit",onClick:A},{icon:k((()=>[g(q(F),{style:{"margin-right":"6px"}})])),default:k((()=>[_(" 查询 ")])),_:1}),g(c,{style:{"margin-left":"10px"},onClick:G},{icon:k((()=>[g(u,{style:{"margin-right":"6px"}})])),default:k((()=>[_(" 重置 ")])),_:1})])),_:1})])])),_:1},8,["model"])]),T(" 表格 "),g(B,{class:"worker-table table_cascader",columns:Q.planInfoColumn,dataSource:Q.taskData,totals:Q.pagination,isScroll:!0,rowSelection:!1,spinLoad:Q.spinLoad,rowKeyId:"id",onOnSelectedRowKeys:X},{customFilterIcon:k((({column:e})=>[(v(),b(S(e.customFilterIcon),{style:{color:"#262626"}}))])),bodyCell:k((({column:e,record:t,text:a,index:o})=>{var s;return["index"===e.dataIndex?(v(),j(h,{key:0},[_(w(o+1),1)],64)):"startTime"===e.dataIndex?(v(),j("span",P,[g(y,{title:J.value(t)},null,8,["title"])])):"status"===e.dataIndex?(v(),j("span",U,[g($,{color:null==(s=H.value(t.status))?void 0:s.color},{text:k((()=>{var e,a;return[x("span",{style:N({color:null==(e=H.value(t.status))?void 0:e.color})},w((null==(a=H.value(t.status))?void 0:a.text)||"--"),5)]})),_:2},1032,["color"])])):"operation"===e.dataIndex?(v(),j("div",M,[g(c,{type:"link",onClick:e=>{return a=t.id,void R.push({path:"/appModel/patrol/patrolTask/taskInfo",query:{patrolProjectId:a}});var a}},{default:k((()=>[_(" 查看详情记录 ")])),_:2},1032,["onClick"]),g(c,{type:"link",style:N({color:1==t.status||2==t.status?"#d9d9d9":""}),disabled:1==t.status||2==t.status,onClick:e=>{return a=t.id,void i.confirm({title:"提示",icon:g(C),content:"是否作废此任务？",okText:"确定",cancelText:"取消",onOk(){const e=new FormData;e.append("taskId",a),n(e).then((e=>{r.info(e.message),V()}))}});var a}},{default:k((()=>[_(" 任务作废 ")])),_:2},1032,["style","disabled","onClick"])])):(v(),b(y,{key:4,title:a},null,8,["title"]))]})),_:1},8,["columns","dataSource","totals","spinLoad"])])])}}},[["__scopeId","data-v-0f98ed2a"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/patrol/patrolTask/index.vue"]]);export{O as default};
