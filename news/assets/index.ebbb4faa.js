import"./vue.a2f518ee.js";import{a as e,u as a}from"./vue-router.907b547c.js";import{_ as t}from"./index.272083a4.js";import{S as s}from"./SearchForm.90e601d6.js";import{f as i,k as o,l as n,n as d}from"./siteBooking.8c7dbe73.js";import{d as r}from"./dayjs.49e29cb2.js";import{S as l}from"./index.7c2c5596.js";import{_ as p}from"./index.7061e8ea.js";import{v as c}from"./uuid.73c2ed78.js";import{r as m,q as u,y as v,f,v as y,b8 as b,o as g,a as k,b as I,c as j,a3 as x,a9 as w,a7 as h,F as T,aL as Y,b5 as D,b4 as N,a8 as _,a5 as F,a2 as M,a4 as S,n as L}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";import"./@fullcalendar.ad7c7755.js";import"./tslib.792e82ab.js";import"./preact.c7815627.js";import"./rrule.c06e606d.js";import"./tippy.js.395eb5fc.js";import"./@popperjs.19b6ba11.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const B=e=>(D("data-v-db759edc"),e=e(),N(),e),C={class:"dao"},z=B((()=>I("span",{style:{"margin-left":"10px"}},"详情",-1))),O={class:"warps"},q={class:"tit_name"},R={class:"item"},A=B((()=>I("span",null,"场地位置 ：",-1))),V=B((()=>I("span",null,"场地类型 ：",-1))),E=B((()=>I("span",null,"容纳人数 ：",-1))),U=B((()=>I("span",null,"设备 ：",-1))),W=Y('<div class="tit_name" data-v-db759edc>场地占用情况</div><div class="table-header" data-v-db759edc><div data-v-db759edc><span class="box1 span" data-v-db759edc></span>课程</div><div data-v-db759edc><span class="box2 span" data-v-db759edc></span>已预约</div><div data-v-db759edc><span class="box3 span" data-v-db759edc></span>审核中</div><div data-v-db759edc><span class="box4 span" data-v-db759edc></span>可预约</div><div data-v-db759edc><span class="box5 span" data-v-db759edc></span>不可预约</div></div>',2),$={class:"tubiao"};var K=p({__name:"idleDetails",props:{siteId:{type:String,default:""},siteBookingTypeId:{type:String,default:""}},emits:["showView"],setup(a,{emit:t}){const s=a,n=m(),d=e(),p=u({siteFormInfo:{},weekNum:0,occupy:[],actnum:1}),Y=v((()=>s.siteId)),D=v((()=>s.siteBookingTypeId)),N=e=>{p.weekNum++;const a=r().startOf("week").add(p.weekNum,"week").format("YYYY-MM-DD"),t=r().endOf("week").add(p.weekNum,"week").format("YYYY-MM-DD");M(a,t)},_=e=>{p.weekNum--;const a=r().startOf("week").add(p.weekNum,"week").format("YYYY-MM-DD"),t=r().endOf("week").add(p.weekNum,"week").format("YYYY-MM-DD");M(a,t)},F=(e,a,t=null)=>e.map(((e,t)=>({id:c(),color:a,start:`${e.startTime.replace(/\s+/g,"T")}:00`,end:`${e.endTime.replace(/\s+/g,"T")}:00`}))),M=(e=r(d.query.siteTime).startOf("week").format("YYYY-MM-DD"),a=r(d.query.siteTime).endOf("week").format("YYYY-MM-DD"))=>{const t={startTime:e,endTime:a,siteId:Y.value,siteBookingTypeId:D.value};i(t).then((e=>{const{inApprovalDateList:a,noBookingDateList:t,timetableDateList:s,yesBookingDateList:i}=e.data,o=F(s,"#00B781"),d=F(i,"#F5222D"),r=F(a,"#FAAD14"),l=F(t,"#cccccc");1===p.actnum&&0===p.occupy.length?n.value.calendarOptions.events=o.concat(d,r,l):p.occupy=o.concat(d,r,l)}))};return f((()=>{M(),o({id:Y.value}).then((e=>{p.siteFormInfo=e.data}))})),y((()=>{p.actnum=1,p.occupy=[]})),(e,a)=>{const s=b("a-layout-header");return g(),k(T,null,[I("div",C,[j(s,{class:"reset-layout-header",style:{position:"relative","z-index":"999"}},{default:x((()=>[I("i",{class:"iconfont icon-xingzhuangjiehe19",onClick:a[0]||(a[0]=e=>{t("showView")})}),z])),_:1}),I("div",O,[I("div",q,w(p.siteFormInfo.name),1),I("div",R,[A,I("i",null,w(null!=p.siteFormInfo.floor?p.siteFormInfo.floor+"-":"")+" "+w(p.siteFormInfo.roomNum||"-"),1),V,I("i",null,w(p.siteFormInfo.siteTypeName||"-"),1),E,I("i",null,w(p.siteFormInfo.peppleNum||"-"),1),U,I("i",null,w(p.siteFormInfo.deviceIds||"-"),1)]),W,I("div",$,[j(l,{onNextWeeks:N,onPrevWeeks:_,ref_key:"schedRef",ref:n,initialEvents:p.occupy},null,8,["initialEvents"])])])]),h(" </div>\r\n    </div> ")],2112)}}},[["__scopeId","data-v-db759edc"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/siteBooking/siteIdleList/idleDetails.vue"]]);const P={class:"warps"},Q={key:0,class:"site_booking"},G={class:"box"},H=["onClick"],J={class:"text"},X={class:"name"},Z={class:"num"},ee={class:"search_form"},ae={class:"table"},te={key:0},se=["onClick"];var ie=p({__name:"index",setup(i){const o=a(),l=e(),p=m(),c=u({siteId:"",showFlag:!1,appointType:[],type:0,pagination:{pageNo:1,pageSize:10,total:0},toDoTable:[],statusList:[{statusName:"全部",status:null},{statusName:"可预约",status:0},{statusName:"已约满",status:1},{statusName:"封禁",status:2}],statusIndex:0,optionshe:[]}),v=[{title:"场地名称",dataIndex:"siteName"},{title:"所在建筑",dataIndex:"buildingName"},{title:"楼层",dataIndex:"floor"},{title:"房间号",dataIndex:"roomNum"},{title:"场地类型",dataIndex:"siteTypeName"},{title:"容纳人数",dataIndex:"peppleNum"},{title:"设备",dataIndex:"deviceName"},{title:"状态",dataIndex:"status"},{title:"操作",dataIndex:"operation"}],y=()=>{c.showFlag=!1,c.siteId=null,L((()=>{p.value.sear.time2=r(new Date).format("YYYY-MM-DD")}))},Y=()=>{B()},D=()=>{c.pagination.pageNo=1,B()},N=e=>{const{current:a,pageSize:t}=e;c.pagination.pageNo=a,c.pagination.pageSize=t,B()},B=(e=null)=>{const a=p.value.sear,t={siteBookingTypeId:c.siteBookingTypeId,...c.pagination,startTime:a.time2,siteName:a.siteName,siteTypeIds:a.siteTypeId&&a.siteTypeId.split(" "),buildingId:a.buildingId,status:e};c.spinLoad=!0,d(t).then((e=>{const{list:a,total:t,pageNo:s,pageSize:i}=e.data;c.toDoTable=a,c.pagination.pageNo=s,c.pagination.pageSize=i,c.pagination.total=t,c.spinLoad=!1})).finally((()=>{c.spinLoad=!1}))};return f((async()=>{p.value.sear.time2=r(new Date).format("YYYY-MM-DD"),(void n().then((async e=>{c.appointType=e.data,c.siteBookingTypeId=e.data[0].id,c.appointType[0].isChange=!0,await B()}))).then((()=>{B()}))})),(e,a)=>{const i=b("a-badge");return g(),k("div",P,[c.showFlag?(g(),M(K,{key:1,siteBookingTypeId:c.siteBookingTypeId,siteId:c.siteId,onShowView:y,class:S(c.showFlag?"top0":"")},null,8,["siteBookingTypeId","siteId","class"])):(g(),k("div",Q,[I("div",G,[(g(!0),k(T,null,_(c.appointType,((e,a)=>(g(),k("div",{class:"item",key:a,onClick:a=>{return t=e,c.appointType=c.appointType.map((e=>({...e,isChange:e.id===t.id}))),c.siteBookingTypeId=t.id,void B();var t},style:F(e.isChange?"transform: scale(1.09);":"")},[I("div",J,[I("div",X,w(e.name),1),I("div",Z,"当前可预约： "+w(e.num)+"场",1)])],12,H)))),128))]),I("div",ee,[j(s,{ref_key:"searRef",ref:p,time1:!1,time2:!0,name:!1,sheb:!0,optionshe:c.optionshe,onQueryList:Y,onResetList:D},null,8,["optionshe"])]),I("div",ae,[j(t,{columns:v,dataSource:c.toDoTable,slots:["operation"],rowSelection:!1,totals:c.pagination,spinLoad:c.spinLoad,onOnSelectedRowKeys:N},{headerCell:x((({column:e})=>[h(' <template v-if="column.dataIndex === \'status\'">\r\n                <a-dropdown>\r\n                        <a style="color:#000" @click.prevent>\r\n                            状态\r\n                            <caret-down-outlined style="color: var(--primary-color)" />\r\n                        </a>\r\n                        <template #overlay>\r\n                                <a-menu>\r\n                                    <a-menu-item v-for="(item, index) in state.statusList" :key="index" @click="chooseStatus(item, index)">\r\n                                        <span :class="state.statusIndex===index?\'acti\':\'\'">{{item.statusName}}</span>\r\n                                    </a-menu-item>\r\n                                </a-menu>\r\n                        </template>\r\n                    </a-dropdown>\r\n               </template> ')])),bodyCell:x((({column:e,record:a})=>["deviceName"===e.dataIndex?(g(),k(T,{key:0},[a.deviceName?h("v-if",!0):(g(),k("span",te,"-"))],64)):h("v-if",!0),"status"===e.dataIndex?(g(),k(T,{key:1},[0===a.status?(g(),M(i,{key:0,status:"success",text:"可预约"})):h("v-if",!0),1===a.status?(g(),M(i,{key:1,status:"error",text:"已约满"})):h("v-if",!0),2===a.status?(g(),M(i,{key:2,status:"default",text:"封禁"})):h("v-if",!0)],64)):h("v-if",!0),"operation"===e.dataIndex?(g(),k("a",{key:2,onClick:e=>{return t=a,c.siteId=t.id,o.replace({query:{siteTime:p.value.sear.time2,siteId:t.id,...l.query,type:"true"}}),void(c.showFlag=!0);var t},style:{color:"var(--primary-color)","margin-right":"10px"}},"详情",8,se)):h("v-if",!0)])),_:1},8,["dataSource","totals","spinLoad"])])]))])}}},[["__scopeId","data-v-021616d4"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/siteBooking/siteIdleList/index.vue"]]);export{ie as default};
