import"./vue.a2f518ee.js";import{_ as e}from"./index.272083a4.js";import{a,u as n,b as t,d as s,c as i}from"./teacherAtt.783d3175.js";import{_ as l}from"./index.7061e8ea.js";import{e as o,o as r,a as c,O as d,b as u,a9 as g,q as p,r as m,f as v,b8 as k,c as y,a3 as f,a7 as w,a5 as h,F as S,a8 as D,a2 as b,b5 as j,b4 as _,aK as C}from"./@vue.919ff404.js";import{m as I,M as T}from"./ant-design-vue.db4d48e3.js";import{a as x,u as L}from"./vue-router.907b547c.js";import{d as O}from"./dayjs.49e29cb2.js";import{f as Y}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const M=o({name:"delText"});var N=l(Object.assign(M,{props:{tmName:String},setup(e){const a=e;return(e,n)=>(r(),c("span",null,[d(" 确定删除 "),u("span",null,"“"+g(a.tmName)+"”",1),d(" 考勤排班？ ")]))}}),[["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/teacherAttendance/attendanceWorking/components/text.vue"]]);const H=e=>(j("data-v-42a71c4d"),e=e(),_(),e),U={class:"warp"},R={class:"header"},A={class:"box"},W=H((()=>u("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),E={class:"main"},P={class:"setupItem"},q={key:0,style:{color:"#000"}},z={class:"attdayset"},$={class:"timeRest"},J={class:"attRestDay"},F=H((()=>u("span",null,"休息开始时间：",-1))),B={class:"attRestDay"},K=H((()=>u("span",null,"休息结束时间：",-1))),V={class:"rangeBox"},G={class:"signInEnd"},Q={class:"workBox"},X=H((()=>u("span",null,"法定节假日自动排休",-1))),Z=H((()=>u("div",null,"特殊日期排班设置：",-1))),ee={class:"haveTime"},ae={class:"haveTime"},ne={class:"addWorkingFoot"},te=o({name:"addOrEditAttWorking"});var se=l(Object.assign(te,{props:{workingId:String},emits:["showListPage"],setup(e,{emit:s}){const i=e;x();const l=L(),o={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},j=p({working:{id:"",schedulingName:"",workingDay:[],festivalAutoRest:!1,necessarySignDate:[],unnecessarySignDate:[],signTimeList:[{signCount:1,signIn:"",needSignIn:!0,signOut:"",needSignOut:!1}],restStart:"",restEnd:"",signInEnd:0,signOutStart:0},showWorkSet:!1,workingDay:[],festivalAutoRest:!1,necessarySignDates:[],unnecessarySignDates:[],necessarySignDate:null,unnecessarySignDate:null}),_=(e,a)=>{"1"===a?j.necessarySignDates.splice(e,1):j.unnecessarySignDates.splice(e,1)},C=e=>{const a=O(new Date(e)).format("YYYY-MM-DD");return j.necessarySignDates.indexOf(a)>-1||(j.unnecessarySignDates.indexOf(a)>-1||!!e&&(e&&e<O().subtract(1,"days")))},M=(e,a)=>{j.necessarySignDate=null,j.unnecessarySignDate=null,"1"===a?j.necessarySignDates.push(e):j.unnecessarySignDates.push(e)},N=()=>{j.working.workingDay=j.workingDay.sort(),j.working.festivalAutoRest=j.festivalAutoRest,j.working.necessarySignDate=j.necessarySignDates,j.working.unnecessarySignDate=j.unnecessarySignDates,j.showWorkSet=!1},H=m(),te=(e,a)=>j.working.workingDay.length?Promise.resolve():Promise.reject(new Error("请选择工作日设置")),se=(e,a)=>{let n=!1,t=!1;return j.working.signTimeList.forEach(((e,a)=>{e.signIn?e.signOut||(t=!0):n=!0})),n||t?Promise.reject(new Error("请设置考勤时间")):Promise.resolve()},ie=(e,a)=>"number"!=typeof j.working.signInEnd||"number"!=typeof j.working.signOutStart?Promise.reject(new Error("请设置打卡时间范围")):Promise.resolve(),le=()=>{j.workingDay=[],j.festivalAutoRest=!1,j.necessarySignDates=[],j.unnecessarySignDates=[]},oe=()=>{j.showWorkSet=!0,j.workingDay=j.working.workingDay,j.festivalAutoRest=j.working.festivalAutoRest,j.necessarySignDates=JSON.parse(JSON.stringify(j.working.necessarySignDate)),j.unnecessarySignDates=JSON.parse(JSON.stringify(j.working.unnecessarySignDate))},re=()=>{l.replace({query:{}}),s("showListPage",!0)},ce=()=>{3===j.working.signTimeList.length?I.warning("最多仅可添加3组打卡"):j.working.signTimeList.push({signCount:j.working.signTimeList.length+1,signIn:"",needSignIn:!1,signOut:"",needSignOut:!1})},de=async()=>{await H.value.validate(),T.confirm({title:"考勤生效设置",icon:y(Y),content:"明日生效：保存设置成功后,则相应人员次日00:00后按新考勤进行考勤处理",onOk:async()=>{const e=i.workingId;e?await n(j.working):await t(j.working),I.success((e?"修改":"添加")+"成功"),re()},onCancel(){}})};return v((()=>{i.workingId&&a({id:i.workingId}).then((e=>{Object.assign(j.working,e.data),j.workingDay=e.data.workingDay,j.festivalAutoRest=e.data.festivalAutoRest,j.necessarySignDates=e.data.necessarySignDate,j.unnecessarySignDates=e.data.unnecessarySignDate})).catch((e=>{}))})),(e,a)=>{const n=k("a-button"),t=k("a-input"),s=k("a-form-item"),l=k("a-time-picker"),p=k("a-checkbox"),m=k("a-input-number"),v=k("a-form"),I=k("a-checkbox-group"),T=k("a-switch"),x=k("a-date-picker"),L=k("a-tag"),O=k("a-modal");return r(),c("div",U,[u("div",R,[u("div",A,[y(n,{type:"text",class:"tabs_back",onClick:re},{default:f((()=>[W,w(' <arrow-left-outlined class="tabs_back__icon" /> ')])),_:1}),u("span",null,g(i.workingId?"编辑考勤排班":"新增考勤排班"),1)])]),u("div",E,[y(v,{ref_key:"formRef",ref:H,model:j.working,name:"basic",autocomplete:"off"},{default:f((()=>[y(s,{label:"考勤排班名称：",name:"schedulingName",rules:[{required:j.working.schedulingName,message:"请填写考勤排班名称",required:!0}]},{default:f((()=>[y(t,{class:"attWorkIpt",maxlength:20,value:j.working.schedulingName,"onUpdate:value":a[0]||(a[0]=e=>j.working.schedulingName=e)},null,8,["value"])])),_:1},8,["rules"]),y(s,{label:"工作日设置：",name:"workDaySet",rules:[{validator:te,required:!0}]},{default:f((()=>[u("div",{class:"setupColor",onClick:oe},"设置")])),_:1},8,["rules"]),u("div",P,[u("div",null,[d(" 工作日设置："),u("span",{style:h(j.working.workingDay.length>0?"color: #000":"")},g(j.working.workingDay.length>0?j.working.workingDay.map((e=>o[e])).join("、"):"未设置"),5),j.working.festivalAutoRest?(r(),c("span",q,g(j.working.festivalAutoRest?"（法定节假日自动排休）":"未设置"),1)):w("v-if",!0)]),u("div",null,[d(" 必须打卡的日期："),u("span",{style:h(j.working.necessarySignDate.length>0?"color: #000":"")},g(j.working.necessarySignDate.length>0?j.working.necessarySignDate.join("；"):"未设置"),5)]),w(" <div>\r\n                        必须打卡的日期：<span\r\n                            :style=\"\r\n                                 state.necessarySignDates1.length > 0\r\n                                    ? 'color: #000'\r\n                                    : ''\r\n                            \"\r\n                            >{{\r\n                                 state.necessarySignDates1.length > 0\r\n                                    ?  state.necessarySignDates1.join('；')\r\n                                    : '未设置'\r\n                            }}</span>\r\n                    </div> "),u("div",null,[d(" 不用打卡的日期："),u("span",{style:h(j.working.unnecessarySignDate.length>0?"color: #000":"")},g(j.working.unnecessarySignDate.length>0?j.working.unnecessarySignDate.join("；"):"未设置"),5)])]),y(s,{label:"考勤时间设置：",name:"workDaySet",rules:[{validator:se,required:!0}]},{default:f((()=>[u("div",{class:"setupColor",onClick:ce},"添加")])),_:1},8,["rules"]),(r(!0),c(S,null,D(j.working.signTimeList,((e,n)=>(r(),c("div",{class:"timeLIst",key:n},[u("div",z,[u("span",null,"第"+g(n+1)+"次签到时间：",1),y(l,{value:j.working.signTimeList[n].signIn,"onUpdate:value":e=>j.working.signTimeList[n].signIn=e,format:"HH:mm","value-format":"HH:mm"},null,8,["value","onUpdate:value"]),y(p,{disabled:0===n,checked:j.working.signTimeList[n].needSignIn,"onUpdate:checked":e=>j.working.signTimeList[n].needSignIn=e},{default:f((()=>[d("打卡")])),_:2},1032,["disabled","checked","onUpdate:checked"]),u("span",null,"第"+g(n+1)+"次签退时间：",1),y(l,{value:j.working.signTimeList[n].signOut,"onUpdate:value":e=>j.working.signTimeList[n].signOut=e,format:"HH:mm","value-format":"HH:mm"},null,8,["value","onUpdate:value"]),y(p,{checked:j.working.signTimeList[n].needSignOut,"onUpdate:checked":e=>j.working.signTimeList[n].needSignOut=e},{default:f((()=>[d("打卡")])),_:2},1032,["checked","onUpdate:checked"]),j.working.signTimeList.length>1?(r(),c("span",{key:0,class:"setupColor",type:"link",onClick:a[1]||(a[1]=e=>{j.working.signTimeList.pop()})},"删除")):w("v-if",!0)])])))),128)),1==j.working.signTimeList.length?(r(),b(s,{key:0},{default:f((()=>[u("div",$,[u("div",J,[F,y(l,{value:j.working.restStart,"onUpdate:value":a[2]||(a[2]=e=>j.working.restStart=e),format:"HH:mm","value-format":"HH:mm"},null,8,["value"])]),u("div",B,[K,y(l,{value:j.working.restEnd,"onUpdate:value":a[3]||(a[3]=e=>j.working.restEnd=e),format:"HH:mm","value-format":"HH:mm"},null,8,["value"])])])])),_:1})):w("v-if",!0),y(s,{label:"打卡时间范围设置：",name:"rangeSet",class:"rangeSet",rules:[{validator:ie,required:!0}]},null,8,["rules"]),u("div",V,[u("div",G,[d(" 签到最晚可晚到 "),y(m,{id:"inputNumber",value:j.working.signInEnd,"onUpdate:value":a[4]||(a[4]=e=>j.working.signInEnd=e),min:0,max:60,defaultValue:0},null,8,["value"]),d("分钟内 ")]),u("div",null,[d(" 签退最早可提前 "),y(m,{id:"inputNumber",value:j.working.signOutStart,"onUpdate:value":a[5]||(a[5]=e=>j.working.signOutStart=e),min:0,max:60,defaultValue:0},null,8,["value"]),d("分钟内 ")])])])),_:1},8,["model"]),y(O,{visible:j.showWorkSet,"onUpdate:visible":a[12]||(a[12]=e=>j.showWorkSet=e),title:"工作日设置",onOk:N,onCancel:le,destroyOnClose:""},{default:f((()=>[y(v,{layout:"vertical"},{default:f((()=>[y(s,{label:"工作日设置："},{default:f((()=>[u("div",Q,[y(I,{value:j.workingDay,"onUpdate:value":a[6]||(a[6]=e=>j.workingDay=e)},{default:f((()=>[y(p,{value:"1"},{default:f((()=>[d("周一")])),_:1}),y(p,{value:"2"},{default:f((()=>[d("周二")])),_:1}),y(p,{value:"3"},{default:f((()=>[d("周三")])),_:1}),y(p,{value:"4"},{default:f((()=>[d("周四")])),_:1}),y(p,{value:"5"},{default:f((()=>[d("周五")])),_:1}),y(p,{value:"6"},{default:f((()=>[d("周六")])),_:1}),y(p,{value:"7"},{default:f((()=>[d("周日")])),_:1})])),_:1},8,["value"])])])),_:1}),y(s,null,{default:f((()=>[X,y(T,{checked:j.festivalAutoRest,"onUpdate:checked":a[7]||(a[7]=e=>j.festivalAutoRest=e),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])])),_:1}),Z,y(s,{label:"必须打卡的日期："},{default:f((()=>[y(x,{class:"datePicker","disabled-date":C,value:j.necessarySignDate,"onUpdate:value":a[8]||(a[8]=e=>j.necessarySignDate=e),onChange:a[9]||(a[9]=e=>M(e,"1")),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["value"]),w(' <a-range-picker  :disabled-date="disabledDate"  @change="(val) => changeMustDay(val)"   @calendarChange="onCalendarChange"  valueFormat="YYYY-MM-DD"  format="YYYY-MM-DD"  class="datePicker" v-model:value="state.testdate" /> '),u("div",ee,[(r(!0),c(S,null,D(j.necessarySignDates,((e,a)=>(r(),b(L,{closable:"",key:e,onClose:e=>_(a,"1")},{default:f((()=>[d(g(e),1)])),_:2},1032,["onClose"])))),128))])])),_:1}),y(s,{label:"不用打卡的日期："},{default:f((()=>[y(x,{class:"datePicker","disabled-date":C,onChange:a[10]||(a[10]=e=>M(e,"2")),value:j.unnecessarySignDate,"onUpdate:value":a[11]||(a[11]=e=>j.unnecessarySignDate=e),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["value"]),u("div",ae,[(r(!0),c(S,null,D(j.unnecessarySignDates,((e,a)=>(r(),b(L,{closable:"",onClose:e=>_(a),key:e},{default:f((()=>[d(g(e),1)])),_:2},1032,["onClose"])))),128))])])),_:1})])),_:1})])),_:1},8,["visible"])]),u("div",ne,[y(n,{type:"primary","html-type":"submit",onClick:de},{default:f((()=>[d("保存设置")])),_:1})])])}}}),[["__scopeId","data-v-42a71c4d"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/teacherAttendance/attendanceWorking/components/addOrEditAttWorking.vue"]]);const ie={key:0},le={class:"tableContent"},oe={class:"searchHead"},re={class:"tableWord"},ce=["innerHTML"],de=["innerHTML"],ue=["innerHTML"],ge={class:"nowarp tableWord"},pe={class:"nowarp tableWord"},me={key:3},ve=["onClick"],ke=["onClick"],ye=o({name:"attendanceGroup"});var fe=l(Object.assign(ye,{setup(a){const n=x(),t=L(),l=m(!1),o=[{title:"考勤排班名称",dataIndex:"attWorkName"},{title:"考勤时间",dataIndex:"attTime"},{title:"特殊日期排班设置",dataIndex:"specialTime"},{title:"操作",dataIndex:"set",width:"110px"}],h=m([]),S=p({workingId:"",showList:!0,pagination:{pageNo:1,pageSize:10,total:0,name:""}}),D=e=>{S.showList=e,H(S.pagination)},j=()=>{H(S.pagination)},_=()=>{H(S.pagination)},O=()=>{S.pagination.name="",S.pagination.pageNo=1,S.pagination.pageSize=10,H(S.pagination)},M=e=>{t.replace({query:{...n.query,type:"edit"}}),S.workingId=e.id,S.showList=!1},H=async e=>{try{l.value=!0;const a=await i(e);h.value=a.data.list,S.pagination.total=a.data.total;const{list:n,total:t}=a.data;n.forEach((e=>{e.schedulingDate&&e.schedulingTime&&e.schedulingTimeRange&&e.necessarySignDate&&e.unnecessarySignDate?(e.attTime=`<p>考勤日期：${e.schedulingDate}</p><p>考勤时间：${e.schedulingTime}</p><p>打卡时间范围限制：${e.schedulingTimeRange}</p>`,e.specialTime=`<p>必须打卡的日期：${e.necessarySignDate.join("；")}</p><p>不用打卡的日期：${e.unnecessarySignDate.join("；")}</p>`):(e.attTime="<p>考勤日期：未设置</p><p>考勤时间：：未设置</p><p>打卡时间范围限制：未设置</p>",e.specialTime="<p>必须打卡的日期：未设置</p><p>不用打卡的日期：未设置</p>")}))}catch(a){}finally{l.value=!1}},U=e=>{const{current:a,pageSize:n,pageNo:t,total:s}=e;S.pagination.pageNo=a,S.pagination.pageSize=n,H(S.pagination)};return v((()=>{H(S.pagination)})),(a,n)=>{const t=k("a-input-search"),i=k("a-form-item"),p=k("SearchOutlined"),m=k("a-button"),v=k("redo-outlined"),x=k("a-form"),L=k("plus-outlined"),R=k("a-tooltip"),A=k("a-divider"),W=k("a-spin");return S.showList?(r(),c("div",ie,[u("div",le,[y(W,{spinning:l.value},{default:f((()=>[y(e,{totals:S.pagination,columns:o,dataSource:h.value,slots:["operation"],rowSelection:!1,onOnSelectedRowKeys:U},{handleItem:f((()=>[u("div",oe,[y(x,{layout:"inline"},{default:f((()=>[y(i,null,{default:f((()=>[y(t,{style:{width:"336px"},value:S.pagination.name,"onUpdate:value":n[0]||(n[0]=e=>S.pagination.name=e),placeholder:"请输入考勤排班名称",allowClear:"",onSearch:j},null,8,["value"])])),_:1}),y(i,null,{default:f((()=>[y(m,{type:"primary",style:{"margin-right":"10px"},onClick:_},{icon:f((()=>[y(p,{style:{"margin-right":"10px"}})])),default:f((()=>[d(" 查询 ")])),_:1}),y(m,{onClick:O},{icon:f((()=>[y(v,{style:{"margin-right":"10px"}})])),default:f((()=>[d(" 重置 ")])),_:1})])),_:1})])),_:1}),y(m,{type:"primary",onClick:n[1]||(n[1]=e=>M({id:""}))},{icon:f((()=>[y(L)])),default:f((()=>[d(" 新增考勤排班 ")])),_:1})])])),bodyCell:f((({column:e,record:a,text:n})=>["attWorkName"===e.dataIndex?(r(),b(R,{key:0},{title:f((()=>[d(g(a.schedulingName),1)])),default:f((()=>[u("div",re,g(a.schedulingName),1)])),_:2},1024)):w("v-if",!0),"attTime"===e.dataIndex?(r(),b(R,{key:1,placement:"topLeft",overlayClassName:"min"},C({default:f((()=>[u("div",{class:"tableWord",innerHTML:n},null,8,de)])),_:2},[(null==n?void 0:n.length)>15?{name:"title",fn:f((()=>[u("div",{innerHTML:n},null,8,ce)])),key:"0"}:void 0]),1024)):w("v-if",!0),"specialTime"===e.dataIndex?(r(),b(R,{key:2,placement:"topLeft",overlayClassName:"min"},C({default:f((()=>[u("div",ge," 必须打卡的日期："+g(0==a.necessarySignDate.length?"未设置":a.necessarySignDate.join("；")),1),u("div",pe," 不用打卡的日期："+g(0==a.unnecessarySignDate.length?"未设置":a.unnecessarySignDate.join("；")),1)])),_:2},[(null==n?void 0:n.length)>15?{name:"title",fn:f((()=>[u("div",{innerHTML:n},null,8,ue)])),key:"0"}:void 0]),1024)):w("v-if",!0),"set"===e.dataIndex?(r(),c("span",me,[u("a",{style:{color:"#00b781"},onClick:e=>M(a)},"编辑",8,ve),y(A,{type:"vertical"}),u("a",{style:{color:"#f5222d"},onClick:e=>{return n=a,void T.confirm({title:"删除提示",icon:y(Y),content:y(N,{tmName:n.schedulingName}),onOk:async()=>{await s([n.id]),I.success("删除成功！"),H(S.pagination)},onCancel(){}});var n}},"删除",8,ke)])):w("v-if",!0)])),_:1},8,["totals","dataSource"])])),_:1},8,["spinning"])])])):(r(),b(se,{key:1,workingId:S.workingId,onShowListPage:D},null,8,["workingId"]))}}}),[["__scopeId","data-v-4b66c23a"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/teacherAttendance/attendanceWorking/index.vue"]]);export{fe as default};
