import"./vue.a2f518ee.js";import{u as e}from"./vue-router.907b547c.js";import{g as a}from"./format.0daa2d8d.js";import{_ as o,p as n}from"./index.7061e8ea.js";import{u as t,a as l,b as i,h as s,d as r,g as d}from"./honorWall.52714fe8.js";import{m as u}from"./ant-design-vue.db4d48e3.js";import{e as c,r as p,q as h,f as m,b8 as v,o as b,a as g,c as f,a3 as y,b as C,a7 as k,O as w,u as j,a9 as _,a2 as T,a4 as L,b5 as x,b4 as U}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./html2canvas.c4a43e03.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./dayjs.49e29cb2.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";const S=e=>(x("data-v-187f07ea"),e=e(),U(),e),O=S((()=>C("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),P={class:"searchHead"},z=["onClick"],I=S((()=>C("a",{key:"list-loadmore-more",style:{color:"#f5222d"}},"删除",-1))),N={class:"titleTetx"},q={class:"titleTetx"},B={class:"titleTetx"},H={key:0,class:"titleTetx"},Y={style:{overflow:"hidden"}},F=S((()=>C("span",{style:{color:"#ff4d4f"}}," * ",-1))),W=S((()=>C("span",null,"查看人员：",-1))),D=S((()=>C("span",null,"选择展示设备：",-1))),M=S((()=>C("div",{class:"TemInfo"},"模板信息：",-1))),G=S((()=>C("span",null,"选择模板：",-1))),R={key:0,class:"count_text2"},E={key:1,class:"count_text"},J={key:1},$={class:"con"},A={key:0,class:"imgbox"},Q=S((()=>C("p",null," 仅支持上传jpeg/jpg/png格式图片，图片不能超过10M,最多可选1张 ",-1))),K={key:1,class:"customImg"},V=["src"],X={class:"footer"},Z=c({name:"honorWall"});var ee=o(Object.assign(Z,{setup(o){const c=e(),x=()=>{c.back(-1)},U=p(),S=(e,a)=>""===ne.winner?Promise.reject(new Error("请选择获奖人员")):Promise.resolve(),Z=p(!1),ee=p([{value:"1",label:"班级荣誉"},{value:"2",label:"学生荣誉"},{value:"3",label:"教师荣誉"},{value:"4",label:"学校荣誉"}]),ae=p([{value:"",label:"全部"},{value:"1",label:"班级荣誉"},{value:"2",label:"学生荣誉"},{value:"3",label:"教师荣誉"},{value:"4",label:"学校荣誉"}]),oe=p([{value:"1",label:"校级"},{value:"2",label:"省级"},{value:"3",label:"国家级"},{value:"4",label:"其他"}]),ne=h({loading:!1,imageList:[],fileList:[],isedit:!1,queryName:"",visible:!1,title:"颁发荣誉",winner:"",visible1:!1,visible2:!1,visible3:!1,checkedList1:[],checkedList2:[],checkedList3:[],honorContent:{name:"",honorType:"",level:"",describe:"",personnel:0,isShowBrand:!1,templateType:"1",imgPaths:"",honorWinnerIds:[]},honorpage:{pageNo:1,pageSize:10,name:"",yearName:"",honorType:""},selectTabs:[],listData:[]}),te=p(),le={onChange:(e,a)=>{ne.honorpage.pageNo=e,ne.honorpage.pageSize=a,ve()},showQuickJumper:!0,showSizeChanger:!0,total:0,pageSizeOptions:["10","20","30","40"],showTotal:(e,a)=>`共 ${e} 条`},ie=()=>{Z.value=!1,ne.visible=!0,ne.isedit=!1},se=()=>{switch(ne.honorContent.honorType){case"1":ne.visible1=!0;break;case"2":ne.visible2=!0;break;case"3":ne.visible3=!0}},re=e=>{ne.honorContent.honorWinnerIds=e.map((e=>e.id)),ne.winner=e.map((e=>e.name)).join("、")},de=e=>{ne.honorContent.honorWinnerIds=e.map((e=>e.id)),ne.winner=e.map((e=>e.name)).join("、")},ue=e=>{ne.honorContent.honorWinnerIds=e.map((e=>e.id)),ne.winner=e.map((e=>e.name)).join("、")},ce=e=>{te.value=e,ne.honorpage.yearName=te.value},pe=e=>new Promise(((a,o)=>{const n=new FormData;n.append("file",e),d(n).then((e=>{var o;const{data:n}=e;a(null==(o=n[0])?void 0:o.url)}))})),he=async()=>{if(await U.value.validate(),ne.loading=!0,"99"===ne.honorContent.templateType){const e=await pe(ne.fileList[ne.fileList.length-1].originFileObj);ne.honorContent.imgPaths=e}else{const e=document.getElementById("imageHonor"),o=await a(e,"honor.png"),n=await pe(o);ne.honorContent.imgPaths=n}if(ne.isedit)try{await t(ne.honorContent),ne.loading=!1,me()}catch(e){ne.loading=!1}else try{await l(ne.honorContent),ne.loading=!1,me()}catch(e){ne.loading=!1}ve(),U.value.resetFields()},me=()=>{ne.visible=!1,U.value.resetFields(),ne.winner=null,ne.honorContent.isShowBrand=!1,ne.honorContent.templateType="1",ne.imageList=[],ne.checkedList1=[],ne.checkedList2=[],ne.checkedList3=[]},ve=async()=>{const{data:e}=await i(ne.honorpage);ne.listData=e.list,le.total=e.total},be=()=>{ne.honorpage.pageNo=1,ve()},ge=()=>{ne.honorpage.pageNo=1,ne.honorpage.pageSize=10,ne.honorpage.honorType="",ne.honorpage.name=null,ne.honorpage.yearName=null,ve()},fe=()=>{ne.winner=""},ye=e=>new Promise(((a,o)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>a(n.result),n.onerror=e=>o(e)})),Ce=async e=>{const a=[];for(const o of e.fileList)a.push({name:o.name,file:o.originFileObj,url:await ye(o.originFileObj),uid:o.uid});ne.imageList=a,ne.fileList=e.fileList},ke=e=>{const a=["image/jpeg","image/jpg","image/png"].indexOf(e.type)>-1,o=e.size/1024/1024<10;return a?(o||u.error("上传头像图片大小不能超过 10MB!"),!1):(u.error("上传头像图片只能是 JPG 或 PNG 格式!"),!1)},we=()=>{ne.imageList=[],ne.fileList=[]};return m((()=>{ve()})),(e,a)=>{const o=v("a-layout-header"),t=v("down-outlined"),l=v("a-date-picker"),i=v("a-form-item"),d=v("a-select"),c=v("a-input-search"),p=v("SearchOutlined"),h=v("a-button"),m=v("redo-outlined"),pe=v("a-form"),ye=v("a-layout-content"),je=v("a-popconfirm"),_e=v("a-image"),Te=v("a-list-item-meta"),Le=v("a-list-item"),xe=v("a-list"),Ue=v("a-input"),Se=v("a-radio"),Oe=v("a-radio-group"),Pe=v("a-checkbox"),ze=v("a-radio-button"),Ie=v("a-upload"),Ne=v("a-drawer");return b(),g("div",null,[f(ye,{class:"reset-layout-content layout-header-radius"},{default:y((()=>[f(o,{class:"reset-layout-header"},{default:y((()=>[C("span",{onClick:x},[O,k(' <arrow-left-outlined class="left-outlined" /> '),w(" 返回 ")])])),_:1}),C("div",P,[C("div",null,[f(pe,{layout:"inline"},{default:y((()=>[f(i,{label:"时间：",name:"depts"},{default:y((()=>[f(l,{onChange:ce,value:te.value,"onUpdate:value":a[0]||(a[0]=e=>te.value=e),"value-format":"YYYY",format:"YYYY年",picker:"year"},{suffixIcon:y((()=>[f(t)])),_:1},8,["value"])])),_:1}),f(i,{label:"荣誉类型：",name:"depts"},{default:y((()=>[f(d,{ref:"select",value:j(ne).honorpage.honorType,"onUpdate:value":a[1]||(a[1]=e=>j(ne).honorpage.honorType=e),style:{width:"120px"},options:ae.value,allowClear:""},null,8,["value","options"])])),_:1}),f(i,null,{default:y((()=>[f(c,{placeholder:"请输入荣誉名称搜索",value:j(ne).honorpage.name,"onUpdate:value":a[2]||(a[2]=e=>j(ne).honorpage.name=e),valueModifiers:{trim:!0},style:{width:"336px","padding-bottom":"16px"},onSearch:be},null,8,["value"])])),_:1}),f(i,null,{default:y((()=>[f(h,{type:"primary",style:{"margin-right":"10px"},onClick:be},{icon:y((()=>[f(p,{style:{"margin-right":"10px"}})])),default:y((()=>[w(" 查询 ")])),_:1}),f(h,{onClick:ge},{icon:y((()=>[f(m,{style:{"margin-right":"10px"}})])),default:y((()=>[w(" 重置 ")])),_:1})])),_:1})])),_:1})]),f(h,{type:"primary",onClick:ie},{default:y((()=>[w("颁发荣誉")])),_:1})])])),_:1}),C("div",null,[f(xe,{"item-layout":"horizontal",size:"large",pagination:le,"data-source":j(ne).listData},{renderItem:y((({item:e})=>[f(Le,{key:"item.title"},{actions:y((()=>[C("a",{key:"list-loadmore-edit",style:{color:"#00b781"},onClick:a=>(async e=>{var a;Z.value=!0,ne.isedit=!0,ne.visible=!0,ne.honorContent.id=e;const{data:o}=await s({id:e});switch(ne.honorContent.name=o.name,ne.honorContent.honorType=o.honorType.toString(),ne.honorContent.isShowBrand=o.isShowBrand,ne.honorContent.level=null==(a=o.level)?void 0:a.toString(),ne.honorContent.describe=o.describe,ne.honorContent.personnel=o.personnel,ne.honorContent.templateType=o.templateType.toString(),ne.honorContent.honorType){case"1":ne.checkedList1=o.winnerList;break;case"2":ne.checkedList2=o.winnerList;break;case"3":ne.checkedList3=o.winnerList}if(ne.winner=o.winnerList.map((e=>e.name)).join("、"),"99"===ne.honorContent.templateType){const e=[];e.push({url:o.imgPaths}),ne.imageList=e}})(e.id)},"编辑",8,z),f(je,{title:"您确定要删除该条荣誉吗?","ok-text":"是","cancel-text":"否",onConfirm:a=>(async e=>{await r({id:e}),ve(),u.success("删除成功")})(e.id)},{default:y((()=>[I])),_:2},1032,["onConfirm"])])),default:y((()=>[f(Te,null,{description:y((()=>[C("div",null,_(e.createTime),1)])),title:y((()=>{var a,o;return[C("div",N,[w(" 荣誉名称: "),C("span",null,_(e.name),1)]),C("div",q,[w(" 荣誉类型: "),C("span",null,_(null==(a=ee.value[e.honorType-1])?void 0:a.label),1)]),C("div",B,[w(" 荣誉级别: "),C("span",null,_((null==(o=oe.value[e.level-1])?void 0:o.label)||"暂无"),1)]),4!==e.honorType?(b(),g("div",H,[w(" 获奖"+_(2===e.honorType?"学生":3===e.honorType?"教师":"班级")+": ",1),C("span",null,_(e.winnerNames),1)])):k("v-if",!0)]})),avatar:y((()=>[C("div",Y,[f(_e,{width:320,height:185,alt:"logo",src:`${e.imgPaths}`},null,8,["src"])])])),_:2},1024)])),_:2},1024)])),_:1},8,["data-source"])]),C("div",null,[k(" 添加编辑荣誉的抽屉 "),f(Ne,{class:"drawerHonor",destroyOnClose:"",visible:j(ne).visible,"onUpdate:visible":a[11]||(a[11]=e=>j(ne).visible=e),maskClosable:!1,onClose:me,title:j(ne).title},{footer:y((()=>[C("div",X,[C("div",null,[f(h,{style:{"margin-right":"8px"},onClick:me},{default:y((()=>[w("取消")])),_:1}),f(h,{type:"primary",onClick:he,loading:j(ne).loading},{default:y((()=>[w("确认")])),_:1},8,["loading"])])])])),default:y((()=>{var e;return[f(pe,{class:"addHonor",layout:"vertical",ref_key:"formRef",ref:U,model:j(ne).honorContent,name:"honor"},{default:y((()=>[f(i,{label:"荣誉名称",name:"name",rules:[{required:j(ne).honorContent.name,message:"请填写荣誉名称",required:!0}]},{default:y((()=>[f(Ue,{autoComplete:"off",value:j(ne).honorContent.name,"onUpdate:value":a[3]||(a[3]=e=>j(ne).honorContent.name=e),valueModifiers:{trim:!0},"show-count":"",maxlength:10},null,8,["value"])])),_:1},8,["rules"]),f(i,{label:"荣誉类型",name:"honorType",rules:[{required:!0,message:"请选择荣誉类型",trigger:"change"}]},{default:y((()=>[f(d,{value:j(ne).honorContent.honorType,"onUpdate:value":a[4]||(a[4]=e=>j(ne).honorContent.honorType=e),onChange:fe,options:ee.value,disabled:j(ne).isShow},null,8,["value","options","disabled"])])),_:1}),f(i,{label:"荣誉级别",name:"level"},{default:y((()=>[f(d,{value:j(ne).honorContent.level,"onUpdate:value":a[5]||(a[5]=e=>j(ne).honorContent.level=e),options:oe.value,disabled:j(ne).isShow},null,8,["value","options","disabled"])])),_:1}),"4"!==j(ne).honorContent.honorType?(b(),T(i,{key:0,label:"2"===j(ne).honorContent.honorType?"获奖学生":"3"===j(ne).honorContent.honorType?"获奖教师":"获奖班级",name:"winner",rules:[{validator:S,required:!0,trigger:"blur"}]},{default:y((()=>[f(Ue,{value:j(ne).winner,"onUpdate:value":a[6]||(a[6]=e=>j(ne).winner=e),onClick:se,allowClear:"",placeholder:"请选择",readonly:"readonly"},null,8,["value"])])),_:1},8,["label","rules"])):k("v-if",!0),f(i,{label:"荣誉描述",name:"describe"},{default:y((()=>[f(Ue,{autoComplete:"off",value:j(ne).honorContent.describe,"onUpdate:value":a[7]||(a[7]=e=>j(ne).honorContent.describe=e),"show-count":"",maxlength:30},null,8,["value"])])),_:1}),f(i,{name:"personnel",rules:[{required:!0,message:"请选择查看人员",trigger:"change"}]},{default:y((()=>[F,W,f(Oe,{value:j(ne).honorContent.personnel,"onUpdate:value":a[8]||(a[8]=e=>j(ne).honorContent.personnel=e),name:"radioGroup",disabled:Z.value},{default:y((()=>[f(Se,{value:0},{default:y((()=>[w("全部（教职工和家长）")])),_:1}),f(Se,{value:1},{default:y((()=>[w("教职工")])),_:1}),f(Se,{value:2},{default:y((()=>[w("家长")])),_:1})])),_:1},8,["value","disabled"])])),_:1}),f(i,{name:"device"},{default:y((()=>[D,f(Pe,{disabled:Z.value,checked:j(ne).honorContent.isShowBrand,"onUpdate:checked":a[9]||(a[9]=e=>j(ne).honorContent.isShowBrand=e)},{default:y((()=>[w("班牌")])),_:1},8,["disabled","checked"])])),_:1})])),_:1},8,["model"]),M,C("div",null,[G,f(Oe,{value:j(ne).honorContent.templateType,"onUpdate:value":a[10]||(a[10]=e=>j(ne).honorContent.templateType=e),"button-style":"solid"},{default:y((()=>[f(ze,{value:"1"},{default:y((()=>[w("模板一")])),_:1}),f(ze,{value:"2"},{default:y((()=>[w("模板二")])),_:1}),f(ze,{value:"3"},{default:y((()=>[w("模板三")])),_:1}),f(ze,{value:"99"},{default:y((()=>[w("自定义")])),_:1})])),_:1},8,["value"])]),C("div",null,["99"!==j(ne).honorContent.templateType?(b(),g("div",{key:0,id:"imageHonor",class:L(["add_count_down","1"===j(ne).honorContent.templateType?"bg1":"2"===j(ne).honorContent.templateType?"bg2":"3"===j(ne).honorContent.templateType?"bg3":""])},[C("div",null,["3"===j(ne).honorContent.templateType?(b(),g("div",R,_(j(ne).honorContent.name),1)):(b(),g("div",E,_(j(ne).honorContent.name),1))])],2)):(b(),g("div",J,[C("div",$,[j(ne).imageList.length?(b(),g("div",K,[C("img",{src:null==(e=j(ne).imageList[j(ne).imageList.length-1])?void 0:e.url,alt:"img"},null,8,V),C("div",{class:"del",onClick:we},"×")])):(b(),g("div",A,[f(Ie,{"file-list":j(ne).fileList,showUploadList:!1,accept:"image/png,image/jpg,image/jpeg",action:"/","before-upload":ke,onChange:Ce},{default:y((()=>[f(h,{class:"btn"},{default:y((()=>[w(" 选择图片 ")])),_:1})])),_:1},8,["file-list"]),Q]))])]))])]})),_:1},8,["visible","title"])]),C("div",null,[k(" 获奖班级组件 "),f(j(n),{mode:"personnel",tabs:[{tab:"教职工",key:1,checked:!0}],visible:j(ne).visible3,"onUpdate:visible":a[12]||(a[12]=e=>j(ne).visible3=e),checked:j(ne).checkedList3,"onUpdate:checked":a[13]||(a[13]=e=>j(ne).checkedList3=e),onHandleOk:ue},null,8,["visible","checked"]),f(j(n),{mode:"personnel",tabs:[{tab:"学生组",key:2,checked:!0}],visible:j(ne).visible2,"onUpdate:visible":a[14]||(a[14]=e=>j(ne).visible2=e),checked:j(ne).checkedList2,"onUpdate:checked":a[15]||(a[15]=e=>j(ne).checkedList2=e),onHandleOk:de},null,8,["visible","checked"]),f(j(n),{mode:"depa",tabs:[{tab:"班级",key:2,checked:!0,disabled:[0,1,2,3]}],visible:j(ne).visible1,"onUpdate:visible":a[16]||(a[16]=e=>j(ne).visible1=e),checked:j(ne).checkedList1,"onUpdate:checked":a[17]||(a[17]=e=>j(ne).checkedList1=e),onHandleOk:re},null,8,["visible","checked"])])])}}}),[["__scopeId","data-v-187f07ea"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/honorWall/index.vue"]]);export{ee as default};
