import"./vue.a2f518ee.js";import{_ as e}from"./index.272083a4.js";import{S as s}from"./SearchForm.90e601d6.js";import{d as t,s as a}from"./siteDetail.3ffd69d1.js";import{b as i,c as o,o as n,g as m,p as l}from"./siteBooking.8c7dbe73.js";import{m as p,M as r}from"./ant-design-vue.db4d48e3.js";import{_ as d}from"./index.7061e8ea.js";import{r as u,q as c,f,b8 as g,o as y,a as b,b as v,c as k,a3 as j,a2 as h,F as I,a8 as x,a4 as N,a9 as T,M as S,O as _,a7 as w,u as C}from"./@vue.919ff404.js";import{E as L}from"./@ant-design.2e172c39.js";import"./@babel.6d5f88cb.js";import"./vue-router.907b547c.js";import"./dayjs.49e29cb2.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const B={class:"warps"},R={class:"site_booking"},O={class:"search_form"},V={class:"table"},D={key:0},z={key:1},E=["onClick"],J=["onClick"],M={class:"max"};var U=d({__name:"index",setup(d){const U=u(),q=c({spinLoad:!1,isVisible:!1,onStatus:!1,isOpen:!1,open:!0,close:!1,title:"",name:"",status:"",themeitem:{signIn:!1,bookingTime:"",sponsorName:"",signList:[],describe:"",siteInfo:{},she:"会议机，投影仪"},audits:{sponsorName:"",sponsorTime:"",approvalTimeStr:"",shenpis:[],refuseReason:""},reviewTable:[],statusList:[{statusName:"全部",status:null},{statusName:"已拒绝",status:0},{statusName:"审批中",status:1},{statusName:"已通过",status:2},{statusName:"已过期",status:4}],pagination:{pageNo:1,pageSize:10,total:0},appointType:[],appointTypes:[],statusIndex:0,typeIndex:0,typeId:"",ju:"",maxNum:300,textNum:0}),F=()=>{q.isVisible=!1},G=e=>{e?(q.isOpen=!0,q.open=!1,q.close=!0):(q.isOpen=!1,q.open=!0,q.close=!1)},K=()=>{o({status:3,id:q.myBookDetailId}).then((e=>{0===e.code&&(Z(),q.isVisible=!1,p.success(e.message))}))},P=()=>{q.visibleJ=!0},Q=()=>{q.ju="",q.textNum=0},A=()=>{q.ju.trim()?o({status:0,refuseReason:q.ju,id:q.myBookDetailId}).then((e=>{0===e.code&&(Z(),q.visibleJ=!1,q.isVisible=!1,p.success(e.message))})):p.warning("请输入拒绝原因")},H=()=>{n({id:q.myBookDetailId}).then((e=>{e.data?o({status:2,id:q.myBookDetailId}).then((e=>{0===e.code&&(Z(),q.isVisible=!1,p.success(e.message))})):r.confirm({title:"审核提示",icon:k(L),content:"该时间场地不开放，确认继续审核通过吗？",okType:"danger",okText:"确定",cancelText:"取消",onOk(){o({status:2,id:q.myBookDetailId}).then((e=>{0===e.code&&(Z(),p.success(e.message))}))}})}))},W=e=>{const{current:s,pageSize:t}=e;q.pagination.pageNo=s,q.pagination.pageSize=t,Z()},X=()=>{Z()},Y=()=>{q.pagination.pageNo=1,Z()},Z=(e="",s=null)=>{const t={},a=U.value.sear;t.pageNo=q.pagination.pageNo,t.pageSize=q.pagination.pageSize,t.name=a.name,t.startTime=a.time[0],t.endTime=a.time[1],t.siteName=a.siteName,t.siteTypeId=a.siteTypeId,t.buildingId=a.buildingId,t.sponsorName=a.sponsorName,t.siteBookingTypeId=e,t.status=s,q.spinLoad=!0,l(t).then((e=>{const{list:s,total:t,pageNo:a,pageSize:i}=e.data;q.reviewTable=s,q.pagination.pageNo=a,q.pagination.pageSize=i,q.pagination.total=t,q.spinLoad=!1})).finally((()=>{q.spinLoad=!1}))};return f((()=>{m().then((e=>{q.appointType=e.data,q.appointTypes=[{name:"全部",id:""}].concat(q.appointType)})),Z()})),(o,n)=>{const m=g("caret-down-outlined"),l=g("a-menu-item"),p=g("a-menu"),r=g("a-dropdown"),d=g("a-badge"),u=g("a-textarea"),c=g("a-modal");return y(),b("div",B,[v("div",R,[v("div",O,[k(s,{ref_key:"searRef",ref:U,onQueryList:X,onResetList:Y,showBooker:!0},null,512)]),v("div",V,[k(e,{columns:C(t),dataSource:q.reviewTable,slots:["operation"],rowSelection:!1,totals:q.pagination,spinLoad:q.spinLoad,onOnSelectedRowKeys:W},{headerCell:j((({column:e})=>["siteBookingTypeName"===e.dataIndex?(y(),h(r,{key:0},{overlay:j((()=>[k(p,null,{default:j((()=>[(y(!0),b(I,null,x(q.appointTypes,((e,s)=>(y(),h(l,{key:s,onClick:t=>((e,s)=>{q.typeIndex=s,q.typeId=e.id,q.pagination.pageNo=1,q.statusIndex=0,Z(e.id,null)})(e,s)},{default:j((()=>[v("span",{class:N(q.typeIndex===s?"actt":"")},T(e.name),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:j((()=>[v("a",{style:{color:"#000"},onClick:n[0]||(n[0]=S((()=>{}),["prevent"]))},[_(" 预约类型 "),k(m,{style:{color:"var(--primary-color)"}})])])),_:1})):w("v-if",!0),"status"===e.dataIndex?(y(),h(r,{key:1},{overlay:j((()=>[k(p,null,{default:j((()=>[(y(!0),b(I,null,x(q.statusList,((e,s)=>(y(),h(l,{key:s,onClick:t=>((e,s)=>{q.statusIndex=s,q.pagination.pageNo=1,q.typeIndex=0,Z("",e.status)})(e,s)},{default:j((()=>[v("span",{class:N(q.statusIndex===s?"acti":"")},T(e.statusName),3)])),_:2},1032,["onClick"])))),128))])),_:1})])),default:j((()=>[v("a",{style:{color:"#000"},onClick:n[1]||(n[1]=S((()=>{}),["prevent"]))},[_(" 审核状态 "),k(m,{style:{color:"var(--primary-color)"}})])])),_:1})):w("v-if",!0)])),bodyCell:j((({column:e,record:s})=>["signIn"===e.dataIndex?(y(),b(I,{key:0},[s.signIn?(y(),b("span",D,"需签到")):(y(),b("span",z,"无需签到"))],64)):w("v-if",!0),"status"===e.dataIndex?(y(),b(I,{key:1},[w(" // 0.拒绝、1.审批中、2.已通过、3.已取消、4.已过期 "),0===s.status?(y(),h(d,{key:0,status:"error",text:"已拒绝"})):w("v-if",!0),1===s.status?(y(),h(d,{key:1,status:"warning",text:"审批中"})):w("v-if",!0),2===s.status?(y(),h(d,{key:2,status:"success",text:"已通过"})):w("v-if",!0),3===s.status?(y(),h(d,{key:3,status:"default",text:"已取消"})):w("v-if",!0),4===s.status?(y(),h(d,{key:4,status:"default",style:{color:"#ccc"},text:"已过期"})):w("v-if",!0)],64)):w("v-if",!0),"operation"===e.dataIndex?(y(),b(I,{key:2},[1===s.status?(y(),b("a",{key:0,onClick:e=>(e=>{q.myBookDetailId=e.id,q.onStatus=!1,i({id:e.id}).then((e=>{const{data:s}=e;q.name=s.name,q.themeitem.signIn=s.signIn,q.themeitem.bookingTime=s.bookingTime,q.themeitem.sponsorName=s.sponsorName,q.themeitem.signList=s.signList,q.themeitem.describe=s.describe,q.themeitem.siteInfo=s.siteInfo,q.audits.shenpis=s.siteInfo.list,q.audits.sponsorName=s.sponsorName,q.audits.refuseReason=s.refuseReason,q.audits.sponsorTime=s.sponsorTime,q.audits.approvalTimeStr=s.approvalTimeStr,q.status=s.status})),q.title="审核详情",q.isVisible=!0})(s),style:{color:"var(--primary-color)"}},"审核",8,E)):(y(),b("a",{key:1,onClick:e=>(e=>{q.isVisible=!0,q.title="详情",q.onStatus=!1,q.myBookDetailId=e.id,i({id:e.id}).then((e=>{const{data:s}=e;q.name=s.name,q.themeitem.signIn=s.signIn,q.themeitem.bookingTime=s.bookingTime,q.themeitem.sponsorName=s.sponsorName,q.themeitem.signList=s.signList,q.themeitem.describe=s.describe,q.themeitem.siteInfo=s.siteInfo,q.audits.shenpis=s.siteInfo.list,q.audits.sponsorName=s.sponsorName,q.audits.refuseReason=s.refuseReason,q.audits.sponsorTime=s.sponsorTime,q.audits.approvalTimeStr=s.approvalTimeStr,q.status=s.status}))})(s),style:{color:"var(--primary-color)"}},"查看",8,J))],64)):w("v-if",!0)])),_:1},8,["columns","dataSource","totals","spinLoad"])])]),w(' 预约详情 @emitReEdit="emitReEdit" '),k(a,{onEmithandleCancel:F,onOpened:G,onEmitCancelBook:K,onEmitRefuse:P,onEmitPass:H,title:q.title,onStatus:q.onStatus,review:!1,open:q.open,close:q.close,isOpen:q.isOpen,audits:q.audits,isVisible:q.isVisible,themeitem:q.themeitem,status:Number(q.status),name:q.name},null,8,["title","onStatus","open","close","isOpen","audits","isVisible","themeitem","status","name"]),w(" 拒绝原因弹框 "),k(c,{visible:q.visibleJ,"onUpdate:visible":n[4]||(n[4]=e=>q.visibleJ=e),title:"拒绝原因",onOk:A,onCancel:Q},{default:j((()=>[k(u,{maxlength:q.maxNum,value:q.ju,"onUpdate:value":n[2]||(n[2]=e=>q.ju=e),onInput:n[3]||(n[3]=e=>o.GetTextNumber()),placeholder:"请输入拒绝原因",style:{height:"120px","overflow-y":"scroll"}},null,8,["maxlength","value"]),v("div",M,T(q.textNum)+"/"+T(q.maxNum),1)])),_:1},8,["visible"])])}}},[["__scopeId","data-v-3ef2dca0"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/siteBooking/appointmentReview/index.vue"]]);export{U as default};
