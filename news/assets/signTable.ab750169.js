import"./vue.a2f518ee.js";import{_ as e}from"./index.272083a4.js";import{l as a,m as t,n as s,o as i,p as o}from"./exam.ac418e80.js";import{g as n}from"./FilterDropdown.5a779a00.js";import{u as l,a as p}from"./vue-router.907b547c.js";import{_ as r}from"./index.7061e8ea.js";import{r as d,q as c,y as u,f as m,b8 as g,o as b,a as y,b as f,c as v,a3 as j,a9 as x,u as I,O as w,a2 as h,a7 as T,b5 as _,b4 as C}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./ant-design-vue.db4d48e3.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./dayjs.49e29cb2.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const N={class:"create_warp"},S={class:"header"},D=(e=>(_("data-v-1b8b7a23"),e=e(),C(),e))((()=>f("i",{class:"iconfont icon-xingzhuangjiehe19"},null,-1))),O={class:"body"},K={class:"search"},q={class:"byDay"},F={key:1};var k=r({__name:"signTable",setup(r){const _=l(),C=p();let k=[];const z=d([{title:"姓名",dataIndex:"personName"},{title:"考场",dataIndex:"siteName",filters:[{text:"全部",value:""}],filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",n(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"},{title:"班级名称",dataIndex:"classesName"},{title:"考试科目",dataIndex:"subjectName"},{title:"实际签到时间",dataIndex:"signInTimeText"},{title:"签到状态",dataIndex:"signInType",filters:[{text:"全部",value:""},{text:"已签到",value:"1"},{text:"未签到",value:"2"}],filterDropdown:e=>(e.selectedKeys.length?e.selectedKeys=e.selectedKeys[0]:e.selectedKeys="",n(e)),customFilterDropdown:!0,customFilterIcon:"caret-right-outlined"}]),B=c({signDataSource:[],groupListOptions:[],subOptions:[],spinning:!1,pagination:{pageNo:1,pageSize:10,total:0,examinationId:C.query.id,siteId:"",signInType:""}}),L=async e=>{B.pagination.pageNo=1,B.subOptions=[],B.pagination.subjectId="",e&&await(async()=>{const e={examinationId:C.query.id,groupId:B.pagination.groupId},{data:a}=await o(e);B.subOptions=a})(),await U(),await M()},U=async()=>{const{data:e}=await t(B.pagination);B.signDataSource=e.list,B.pagination.total=e.total},P=async()=>{B.pagination.pageNo=1,U()},A=()=>{_.go(-1)},R=e=>{const{current:a,pageSize:t,pageNo:s,siteName:i,signInType:o}=e;B.pagination.pageNo=a,B.pagination.pageSize=t,B.pagination.siteId=i?i[0]:"",B.pagination.signInType=o?o[0]:"",U(B.pagination)},M=async()=>{z.value[1].filters=[];const e={examinationId:C.query.id,groupId:B.pagination.groupId},{data:a}=await s(e);k=a.map((e=>({text:e.name,value:e.id}))),k.length?(z.value[1].filters.unshift({text:"全部",value:""}),z.value[1].filters.push(...k)):z.value[1].filters=[{text:"全部",value:""}]},E=async()=>{const e={examinationId:C.query.id,signInType:B.pagination.signInType,subjectId:B.pagination.subjectId,groupId:B.pagination.groupId,siteId:B.pagination.siteId};await i(e).then((e=>{const a=window.URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),t=document.createElement("a");t.style.display="none",t.href=a,t.setAttribute("download","签到表.xlsx"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},$=u((()=>{const[e,a]=[{text:"已签到",color:"#00B781"},{text:"未签到",color:"#BFBFBF"}];return t=>1===t?e:a}));return m((()=>{(async()=>{const{data:e}=await a({id:C.query.id});B.groupListOptions=e})(),U(),M()})),(a,t)=>{const s=g("a-button"),i=g("a-select"),o=g("a-form-item"),n=g("a-form"),l=g("a-badge"),p=g("a-spin");return b(),y("div",N,[f("div",S,[v(s,{type:"text",class:"tabs_back",onClick:A},{default:j((()=>[D])),_:1}),f("span",null,x(`${I(C).query.name}签到表`),1)]),f("div",O,[f("div",K,[v(n,{layout:"inline"},{default:j((()=>[v(o,{label:"年级:"},{default:j((()=>[v(i,{getPopupContainer:e=>e.parentNode,style:{width:"360px"},allowClear:"",onChange:L,value:B.pagination.groupId,"onUpdate:value":t[0]||(t[0]=e=>B.pagination.groupId=e),placeholder:"请选择",options:B.groupListOptions,showArrow:!0,"field-names":{label:"objectName",value:"id"}},null,8,["getPopupContainer","value","options"])])),_:1}),v(o,{label:"考试科目"},{default:j((()=>[v(i,{getPopupContainer:e=>e.parentNode,placeholder:"请选择",allowClear:!0,value:B.pagination.subjectId,"onUpdate:value":t[1]||(t[1]=e=>B.pagination.subjectId=e),style:{width:"360px"},options:B.subOptions,showArrow:!0,onChange:P,"field-names":{label:"subjectName",value:"id"}},null,8,["getPopupContainer","value","options"])])),_:1})])),_:1}),v(s,{onClick:E},{default:j((()=>[w("导出")])),_:1})]),f("div",q,[v(p,{spinning:B.spinning},{default:j((()=>[v(e,{totals:B.pagination,columns:z.value,dataSource:B.signDataSource,slots:["operation"],rowSelection:!1,onOnSelectedRowKeys:R},{bodyCell:j((({column:e,record:a,index:t,text:s})=>["signInType"===e.dataIndex?(b(),h(l,{key:0,color:$.value(a.signInType).color,status:"success",text:$.value(a.signInType).text},null,8,["color","text"])):T("v-if",!0),"signInTimeText"===e.dataIndex?(b(),y("div",F,x(a.signInTimeText||"-"),1)):T("v-if",!0)])),_:1},8,["totals","columns","dataSource"])])),_:1},8,["spinning"])])])])}}},[["__scopeId","data-v-1b8b7a23"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/examManage/signTable.vue"]]);export{k as default};
