import"./vue.a2f518ee.js";import{u as e,a as t}from"./vue-router.907b547c.js";import{v as a,a as s,b as i,c as o,g as l,d as n,e as r,f as u,u as d}from"./vote.19679533.js";import{m as c}from"./ant-design-vue.db4d48e3.js";import{_ as p}from"./index.7061e8ea.js";import{r as m,q as y,f as v,b8 as f,I as b,o as g,a as w,a7 as h,c as j,a3 as _,F as k,a8 as C,u as x,H as q,a2 as F,O as T,a9 as I,b as D,a6 as S,a5 as U}from"./@vue.919ff404.js";import"./@babel.6d5f88cb.js";import"./FilterDropdown.5a779a00.js";import"./dayjs.49e29cb2.js";import"./resize-observer-polyfill.f664b406.js";import"./vue-types.022beab3.js";import"./@ant-design.2e172c39.js";import"./@ctrl.c020ccd3.js";import"./dom-align.0991ecc5.js";import"./lodash-es.36dcd19c.js";import"./async-validator.267d9719.js";import"./scroll-into-view-if-needed.61c672a4.js";import"./compute-scroll-into-view.17358474.js";/* empty css                    */import"./secure-ls.8c8acb46.js";import"./nprogress.c2257662.js";import"./axios.7aed06b8.js";import"./qs.e55e9b28.js";import"./side-channel.ea627785.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.e2cfb4a5.js";import"./vuex.f308ecec.js";import"./vuex-persistedstate.fa252374.js";import"./vue-grid-layout.a3ef67ec.js";const Y={class:"vote"},V={class:"head_operation"},K={class:"queryform_class"},L={class:"operation_button"},R={key:3,class:"table_btn"},z={class:"preview_box"},M=["src"];var O=p({__name:"index",setup(p){const O=e(),N=(t(),m([])),$=m(),A=y({previewVisible:!1,previewUrl:"",selectedRowKeys:[],pagination:{hideOnSinglePage:!0,total:0,current:1,showQuickJumper:!0,showLessItems:!0,showSizeChanger:!0,pageSizeOptions:["10","20","30","40"],showTotal:(e,t)=>`共 ${e} 条`},tableLoading:!1,voteType:"iCreated",queryForm:{type:null,queryTime:[],startTime:"",endTime:"",keywords:""},tableData:[],status:""});function H(e){if(1===e.status||3===e.status){const a=1===e.status?3:1;t={voteId:e.id,status:a},d(t).then((e=>{c.success(e.message)})).finally((()=>{B()}))}else c.warning("当前不可修改状态");var t}function J(e,t,a){if("edit"===e&&(1===a||2===a)){const e=1===a?"正在进行中":"已结束";return c.warning(""+("当前投票"+e+"，不可编辑")),!1}O.push({name:"operationVote",state:{type:e,voteId:t}})}function P(e){A.queryForm.startTime=e?e[0]:"",A.queryForm.endTime=e?e[1]:""}function Q(){const e={voteIds:A.selectedRowKeys};n(e).then((e=>{c.success(e.message)})).finally((()=>{B()}))}function B(){A.tableLoading=!0;const e={showAll:"allVote"===A.voteType,pageNo:A.pagination.current,pageSize:10,...A.queryForm,status:A.status};u(e).then((e=>{const{list:t,total:a,pageNo:s}=e.data;A.tableData=t||[],A.pagination.total=a,A.pagination.current=s})).finally((()=>{A.tableLoading=!1}))}async function E(){A.pagination.current=1,A.queryForm.startTime="",A.queryForm.endTime="",await $.value.resetFields(),await B()}function G(){A.pagination.current=1,B()}const W={onChange:(e,t)=>{A.selectedRowKeys=e}};async function X(e,t){const{current:a}=e,{status:s}=t;A.status=s&&s.length>0?s[0]:"",A.pagination.current=a||1,await B()}return v((async()=>{await void r(["vote_type"]).then((e=>{const{list:t}=null==e?void 0:e.data[0];N.value=t})),await B()})),(e,t)=>{const n=f("a-radio-button"),r=f("a-radio-group"),u=f("a-select-option"),d=f("a-select"),p=f("a-form-item"),m=f("down-outlined"),y=f("a-range-picker"),v=f("a-input"),B=f("SearchOutlined"),Z=f("a-button"),ee=f("redo-outlined"),te=f("a-form"),ae=f("plus-outlined"),se=f("a-badge"),ie=f("a-table"),oe=f("a-spin"),le=f("a-modal"),ne=b("auth");return g(),w("div",Y,[h(" 投票类型 "),j(r,{onChange:G,value:A.voteType,"onUpdate:value":t[0]||(t[0]=e=>A.voteType=e),"button-style":"solid"},{default:_((()=>[(g(!0),w(k,null,C(x(a),((e,t)=>q((g(),F(n,{value:e.type,key:e.type+t},{default:_((()=>[T(I(e.name),1)])),_:2},1032,["value"])),[[ne,`${e.type}`]]))),128))])),_:1},8,["value"]),h(" 条件查询  "),D("div",V,[j(te,{layout:"horizontal",model:A.queryForm,ref_key:"queryVoteRef",ref:$},{default:_((()=>[D("div",K,[j(p,{label:"类型",name:"type"},{default:_((()=>[j(d,{style:{width:"240px"},value:A.queryForm.type,"onUpdate:value":t[1]||(t[1]=e=>A.queryForm.type=e),placeholder:"请选择"},{default:_((()=>[(g(!0),w(k,null,C(N.value,((e,t)=>(g(),F(u,{value:e.value,key:e.value+"type"+t},{default:_((()=>[T(I(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),j(p,{label:"时间：",name:"queryTime"},{default:_((()=>[j(y,{style:{width:"240px"},value:A.queryForm.queryTime,"onUpdate:value":t[2]||(t[2]=e=>A.queryForm.queryTime=e),valueFormat:"YYYY-MM-DD",format:"YYYY-MM-DD",onChange:P},{suffixIcon:_((()=>[j(m)])),_:1},8,["value"])])),_:1}),j(p,{name:"keywords"},{default:_((()=>[j(v,{style:{width:"240px"},value:A.queryForm.keywords,"onUpdate:value":t[3]||(t[3]=e=>A.queryForm.keywords=e),placeholder:"请输入创建人/标题"},null,8,["value"])])),_:1}),j(p,null,{default:_((()=>[j(Z,{type:"primary","html-type":"submit",onClick:G},{icon:_((()=>[j(B,{style:{"margin-right":"6px"}})])),default:_((()=>[T(" 查询 ")])),_:1}),j(Z,{style:{"margin-left":"10px"},onClick:E},{icon:_((()=>[j(ee,{style:{"margin-right":"6px"}})])),default:_((()=>[T(" 重置 ")])),_:1})])),_:1})])])),_:1},8,["model"]),h(" 操作按钮 "),D("div",L,[j(Z,{type:"primary","html-type":"submit",style:{"margin-right":"12px"},onClick:t[4]||(t[4]=e=>J("create",""))},{icon:_((()=>[j(ae)])),default:_((()=>[T(" 新增投票 ")])),_:1}),j(Z,{"html-type":"submit",danger:"",ghost:"",onClick:Q,disabled:!(!A.selectedRowKeys||0!==A.selectedRowKeys.length)},{default:_((()=>[T(" 删除 ")])),_:1},8,["disabled"])])]),h(" 表格 "),j(ie,{pagination:A.pagination,columns:x(o),"data-source":A.tableData,loading:A.tableLoading,scroll:{x:1500},onChange:X,rowKey:"id","row-selection":W},{customFilterIcon:_((({column:e})=>[(g(),F(S(e.customFilterIcon),{style:{color:"#262626"}}))])),bodyCell:_((({column:e,record:t})=>{var a;return["activityTime"===e.dataIndex?(g(),w(k,{key:0},[T(I(t.startTime.slice(0,10)+" - "+t.endTime.slice(0,10)),1)],64)):h("v-if",!0),"status"===e.dataIndex?(g(),F(se,{key:1,color:x(s)[t.status],text:x(i)[t.status]||"-"},null,8,["color","text"])):h("v-if",!0),"type"===e.dataIndex?(g(),w(k,{key:2},[T(I((null==(a=N.value[t.type-1])?void 0:a.label)||"-"),1)],64)):h("v-if",!0),"operation"===e.dataIndex?(g(),w("div",R,[j(Z,{style:U(1===t.status||2===t.status?"color:  rgba(0,0,0,0.25)":""),type:"link",onClick:e=>J("edit",t.id,t.status)},{default:_((()=>[T(" 编辑 ")])),_:2},1032,["style","onClick"]),j(Z,{type:"link",onClick:e=>J("look",t.id)},{default:_((()=>[T(" 查看 ")])),_:2},1032,["onClick"]),j(Z,{type:"link",onClick:e=>{return a=t.id,void(0!==t.status?O.push({name:"statistics",state:{id:a}}):c.warning("当前投票活动未开始，暂无投票统计"));var a},style:U(0===t.status?"color:  rgba(0,0,0,0.25)":"")},{default:_((()=>[T(" 统计 ")])),_:2},1032,["onClick","style"]),j(Z,{type:"link",onClick:e=>{return a=t.id,A.previewSpinning=!0,A.previewVisible=!0,void l({id:a}).then((e=>{A.previewUrl=e.data||""})).finally((()=>{A.previewSpinning=!1}));var a}},{default:_((()=>[T(" 预览 ")])),_:2},1032,["onClick"]),j(Z,{type:"link",onClick:e=>H(t)},{default:_((()=>[T(I(1===t.status?"暂停":3===t.status?"开始":"-"),1)])),_:2},1032,["onClick"])])):h("v-if",!0)]})),_:1},8,["pagination","columns","data-source","loading"]),h(" 预览 "),j(le,{wrapClassName:"previewClass",maskClosable:!1,centered:"",visible:A.previewVisible,"onUpdate:visible":t[5]||(t[5]=e=>A.previewVisible=e),title:"扫码预览活动",width:"408px",footer:!1},{default:_((()=>[j(oe,{spinning:A.previewSpinning},{default:_((()=>[D("div",z,[D("img",{src:A.previewUrl,alt:""},null,8,M)])])),_:1},8,["spinning"])])),_:1},8,["visible"])])}}},[["__scopeId","data-v-72bd9203"],["__file","C:/Users/66406/Desktop/ydproject/cloudSystem3.0/cloud-system-2.0/src/views/appModel/vote/voteList/index.vue"]]);export{O as default};
